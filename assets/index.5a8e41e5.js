var Ve=Object.defineProperty;var ze=(Y,p,H)=>p in Y?Ve(Y,p,{enumerable:!0,configurable:!0,writable:!0,value:H}):Y[p]=H;var wt=(Y,p,H)=>(ze(Y,typeof p!="symbol"?p+"":p,H),H),te=(Y,p,H)=>{if(!p.has(Y))throw TypeError("Cannot "+H)};var E=(Y,p,H)=>(te(Y,p,"read from private field"),H?H.call(Y):p.get(Y)),Z=(Y,p,H)=>{if(p.has(Y))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(Y):p.set(Y,H)},ut=(Y,p,H,_)=>(te(Y,p,"write to private field"),_?_.call(Y,H):p.set(Y,H),H),ee=(Y,p,H,_)=>({set _(v){ut(Y,p,v,H)},get _(){return E(Y,p,_)}}),rt=(Y,p,H)=>(te(Y,p,"access private method"),H);import{g as getDefaultExportFromCjs,u as useRoute,a as useRouter,i as inject,E as ElMenuItem,b as ElMenu,o as openBlock,c as createBlock,w as withCtx,d as createElementBlock,r as renderList,e as createVNode,F as Fragment,f as createBaseVNode,t as toDisplayString,h as unref,j as ElMessageBox,k as ElMessage,l as ref,m as renderSlot,p as provide,n as defineComponent,q as ElConfigProvider,s as computed,v as watch,R as RouterView,x as resolveDynamicComponent,T as Transition,y as resolveComponent,z as createRouter,A as createWebHistory,B as getAugmentedNamespace,C as createApp}from"./vue.ab3a18a5.js";function _mergeNamespaces(Y,p){for(var H=0;H<p.length;H++){const _=p[H];if(typeof _!="string"&&!Array.isArray(_)){for(const v in _)if(v!=="default"&&!(v in Y)){const k=Object.getOwnPropertyDescriptor(_,v);k&&Object.defineProperty(Y,v,k.get?k:{enumerable:!0,get:()=>_[v]})}}}return Object.freeze(Object.defineProperty(Y,Symbol.toStringTag,{value:"Module"}))}(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))_(v);new MutationObserver(v=>{for(const k of v)if(k.type==="childList")for(const q of k.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&_(q)}).observe(document,{childList:!0,subtree:!0});function H(v){const k={};return v.integrity&&(k.integrity=v.integrity),v.referrerpolicy&&(k.referrerPolicy=v.referrerpolicy),v.crossorigin==="use-credentials"?k.credentials="include":v.crossorigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function _(v){if(v.ep)return;v.ep=!0;const k=H(v);fetch(v.href,k)}})();const base="",configProvider="";var zhTw={};(function(Y){Object.defineProperty(Y,"__esModule",{value:!0});var p={name:"zh-tw",el:{colorpicker:{confirm:"\u78BA\u8A8D",clear:"\u6E05\u7A7A",defaultLabel:"\u8272\u5F69\u9078\u64C7\u5668",description:"\u76EE\u524D\u8272\u5F69\u70BA {color}\u3002\u6309\u4E00\u4E0B Enter \u4EE5\u9078\u64C7\u65B0\u8272\u5F69\u3002"},datepicker:{now:"\u73FE\u5728",today:"\u4ECA\u5929",cancel:"\u53D6\u6D88",clear:"\u6E05\u7A7A",confirm:"\u78BA\u8A8D",dateTablePrompt:"\u4F7F\u7528\u65B9\u5411\u9375\u8207 Enter \u9375\u4EE5\u9078\u64C7\u65E5\u671F",monthTablePrompt:"\u4F7F\u7528\u65B9\u5411\u9375\u8207 Enter \u9375\u4EE5\u9078\u64C7\u6708\u4EFD",yearTablePrompt:"\u4F7F\u7528\u65B9\u5411\u9375\u8207 Enter \u9375\u4EE5\u9078\u64C7\u5E74\u4EFD",selectedDate:"\u5DF2\u9078\u65E5\u671F",selectDate:"\u9078\u64C7\u65E5\u671F",selectTime:"\u9078\u64C7\u6642\u9593",startDate:"\u958B\u59CB\u65E5\u671F",startTime:"\u958B\u59CB\u6642\u9593",endDate:"\u7D50\u675F\u65E5\u671F",endTime:"\u7D50\u675F\u6642\u9593",prevYear:"\u524D\u4E00\u5E74",nextYear:"\u5F8C\u4E00\u5E74",prevMonth:"\u4E0A\u500B\u6708",nextMonth:"\u4E0B\u500B\u6708",year:"\u5E74",month1:"1 \u6708",month2:"2 \u6708",month3:"3 \u6708",month4:"4 \u6708",month5:"5 \u6708",month6:"6 \u6708",month7:"7 \u6708",month8:"8 \u6708",month9:"9 \u6708",month10:"10 \u6708",month11:"11 \u6708",month12:"12 \u6708",weeks:{sun:"\u65E5",mon:"\u4E00",tue:"\u4E8C",wed:"\u4E09",thu:"\u56DB",fri:"\u4E94",sat:"\u516D"},weeksFull:{sun:"\u661F\u671F\u65E5",mon:"\u661F\u671F\u4E00",tue:"\u661F\u671F\u4E8C",wed:"\u661F\u671F\u4E09",thu:"\u661F\u671F\u56DB",fri:"\u661F\u671F\u4E94",sat:"\u661F\u671F\u516D"},months:{jan:"\u4E00\u6708",feb:"\u4E8C\u6708",mar:"\u4E09\u6708",apr:"\u56DB\u6708",may:"\u4E94\u6708",jun:"\u516D\u6708",jul:"\u4E03\u6708",aug:"\u516B\u6708",sep:"\u4E5D\u6708",oct:"\u5341\u6708",nov:"\u5341\u4E00\u6708",dec:"\u5341\u4E8C\u6708"}},inputNumber:{decrease:"\u6E1B\u5C11\u6578\u503C",increase:"\u589E\u52A0\u6578\u503C"},select:{loading:"\u8F09\u5165\u4E2D",noMatch:"\u7121\u76F8\u7B26\u8CC7\u6599",noData:"\u7121\u8CC7\u6599",placeholder:"\u8ACB\u9078\u64C7"},dropdown:{toggleDropdown:"\u5207\u63DB\u4E0B\u62C9\u9078\u55AE"},cascader:{noMatch:"\u7121\u76F8\u7B26\u8CC7\u6599",loading:"\u8F09\u5165\u4E2D",placeholder:"\u8ACB\u9078\u64C7",noData:"\u7121\u8CC7\u6599"},pagination:{goto:"\u524D\u5F80",pagesize:"\u9805/\u9801",total:"\u5171 {total} \u9805",pageClassifier:"\u9801",deprecationWarning:"\u5075\u6E2C\u5230\u5DF2\u904E\u6642\u7684\u4F7F\u7528\u65B9\u5F0F\uFF0C\u8ACB\u53C3\u95B1 el-pagination \u8AAA\u660E\u6587\u4EF6\u4EE5\u4E86\u89E3\u66F4\u591A\u8CC7\u8A0A"},dialog:{close:"\u95DC\u9589\u6B64\u5C0D\u8A71\u6846"},drawer:{close:"\u95DC\u9589\u6B64\u5C0D\u8A71\u6846"},messagebox:{title:"\u63D0\u793A",confirm:"\u78BA\u5B9A",cancel:"\u53D6\u6D88",error:"\u8F38\u5165\u7684\u8CC7\u6599\u4E0D\u7B26\u898F\u5B9A!",close:"\u95DC\u9589\u6B64\u5C0D\u8A71\u6846"},upload:{deleteTip:"\u6309\u4E00\u4E0B Delete \u9375\u4EE5\u522A\u9664",delete:"\u522A\u9664",preview:"\u67E5\u770B\u5716\u7247",continue:"\u7E7C\u7E8C\u4E0A\u50B3"},slider:{defaultLabel:"\u6ED1\u687F\u4ECB\u65BC {min} \u81F3 {max}",defaultRangeStartLabel:"\u9078\u64C7\u8D77\u59CB\u503C",defaultRangeEndLabel:"\u9078\u64C7\u7D50\u675F\u503C"},table:{emptyText:"\u66AB\u7121\u8CC7\u6599",confirmFilter:"\u7BE9\u9078",resetFilter:"\u91CD\u7F6E",clearFilter:"\u5168\u90E8",sumText:"\u5408\u8A08"},tree:{emptyText:"\u66AB\u7121\u8CC7\u6599"},transfer:{noMatch:"\u7121\u76F8\u7B26\u8CC7\u6599",noData:"\u7121\u8CC7\u6599",titles:["\u5217\u8868 1","\u5217\u8868 2"],filterPlaceholder:"\u8ACB\u8F38\u5165\u641C\u5C0B\u5167\u5BB9",noCheckedFormat:"\u5171 {total} \u9805",hasCheckedFormat:"\u5DF2\u9078 {checked}/{total} \u9805"},image:{error:"\u8F09\u5165\u5931\u6557"},pageHeader:{title:"\u8FD4\u56DE"},popconfirm:{confirmButtonText:"\u78BA\u8A8D",cancelButtonText:"\u53D6\u6D88"}}};Y.default=p})(zhTw);const locale=getDefaultExportFromCjs(zhTw),menu="",tooltip="",popper="",menuItem="",logo="/SIGNooo/assets/logo.b2de35c2.png",github="/SIGNooo/assets/github.d485fd1a.png",Header_vue_vue_type_style_index_0_scoped_58452ddc_lang="",_export_sfc=(Y,p)=>{const H=Y.__vccOpts||Y;for(const[_,v]of p)H[_]=v;return H},_hoisted_1=["src","onClick"],_hoisted_2=["src","onClick"],_hoisted_3=["onClick"],_sfc_main$2={__name:"Header",setup(Y){const p=useRoute(),H=useRouter(),_=inject("openDialog"),v=inject("signs");function k(){p.name==="Main"?_({active:0}):H.push({name:"Main"})}const q=[{logo:!0,text:"SIGNooo",click:()=>H.push({name:"Home"})},{text:"\u7C3D\u7F72\u6587\u4EF6",click:k},{text:"\u5FEB\u901F\u767B\u5165",click:()=>{},disabled:!0},{text:"\u6E05\u9664\u7D00\u9304",click:()=>{ElMessageBox.confirm("\u78BA\u5B9A\u8981\u6E05\u9664\u6240\u6709\u7D00\u9304\uFF1F","",{confirmButtonText:"\u78BA\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{localStorage.clear(),v.value=[],ElMessage({type:"success",message:"\u522A\u9664\u5B8C\u6210"})}).catch(()=>{})}},{img:github,click:()=>window.open("https://github.com/JohnsonMao/SIGNooo")}];return console.log(github),(N,A)=>{const h=ElMenuItem,u=ElMenu;return openBlock(),createBlock(u,{class:"menu",mode:"horizontal"},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(q,d=>createVNode(h,{key:d.text,index:d.text,disabled:d.disabled,class:"menu__item"},{default:withCtx(()=>[d.logo?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("h1",null,toDisplayString(d.text),1),createBaseVNode("img",{src:unref(logo),alt:"SIGNooo logo",onClick:d.click},null,8,_hoisted_1)],64)):d.img?(openBlock(),createElementBlock("img",{key:1,src:unref(github),class:"github",alt:"Github",width:"32",onClick:d.click},null,8,_hoisted_2)):(openBlock(),createElementBlock("div",{key:2,onClick:d.click},toDisplayString(d.text),9,_hoisted_3))]),_:2},1032,["index","disabled"])),64))]),_:1})}}},HeaderVue=_export_sfc(_sfc_main$2,[["__scopeId","data-v-58452ddc"]]),_sfc_main$1={__name:"Layout",setup(Y){const p=ref({show:!0,active:0,img:null,name:""}),H=ref(Object.keys(localStorage).map(v=>{var k;return{name:((k=/^SIGN_(.+)$/.exec(v))==null?void 0:k[1])||"",img:localStorage.getItem(v)}}));provide("signs",H);function _({active:v,img:k,name:q}){p.value.show=!0,p.value.active=v||0,p.value.img=k,p.value.name=q}return provide("dialogStatus",p),provide("openDialog",_),(v,k)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(HeaderVue),renderSlot(v.$slots,"default")],64))}},_transition_scss_vue_type_style_index_0_src_true_lang="",App_vue_vue_type_style_index_1_scoped_76a1a29e_lang="",_sfc_main=defineComponent({components:{ElConfigProvider,Layout:_sfc_main$1},setup(){const Y=useRoute(),p=ref(),H=computed(()=>Y.name);function _(){var v;p.value=(v=Y.meta.layout)!=null?v:"Layout"}return watch(Y,_),{RouterView,locale,layout:p,routeName:H}}});function _sfc_render(Y,p,H,_,v,k){const q=resolveComponent("router-view"),N=ElConfigProvider;return openBlock(),createBlock(N,{locale:Y.locale},{default:withCtx(()=>[createVNode(Transition,{name:"fade",mode:"out-in"},{default:withCtx(()=>[(openBlock(),createElementBlock("div",{key:Y.layout},[(openBlock(),createBlock(resolveDynamicComponent(Y.layout),null,{default:withCtx(()=>[createVNode(q,null,{default:withCtx(({Component:A})=>[createVNode(Transition,{name:"fade",mode:"out-in",appear:""},{default:withCtx(()=>[(openBlock(),createElementBlock("div",{class:"layout",key:Y.routeName},[(openBlock(),createBlock(resolveDynamicComponent(A)))]))]),_:2},1024)]),_:1})]),_:1}))]))]),_:1})]),_:1},8,["locale"])}const App=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-76a1a29e"]]),scriptRel="modulepreload",assetsURL=function(Y){return"/SIGNooo/"+Y},seen={},__vitePreload=function(p,H,_){if(!H||H.length===0)return p();const v=document.getElementsByTagName("link");return Promise.all(H.map(k=>{if(k=assetsURL(k),k in seen)return;seen[k]=!0;const q=k.endsWith(".css"),N=q?'[rel="stylesheet"]':"";if(!!_)for(let u=v.length-1;u>=0;u--){const d=v[u];if(d.href===k&&(!q||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${k}"]${N}`))return;const h=document.createElement("link");if(h.rel=q?"stylesheet":scriptRel,q||(h.as="script",h.crossOrigin=""),h.href=k,document.head.appendChild(h),q)return new Promise((u,d)=>{h.addEventListener("load",u),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${k}`)))})})).then(()=>p())},main=[{path:"/",name:"Home",component:()=>__vitePreload(()=>import("./Home.1abc79f1.js"),["assets/Home.1abc79f1.js","assets/Step.608c859a.js","assets/vue.ab3a18a5.js","assets/Step.2d5b455c.css","assets/Home.b03876de.css"])},{path:"/Main",name:"Main",component:()=>__vitePreload(()=>import("./Main.7e7c70cf.js"),["assets/Main.7e7c70cf.js","assets/Step.608c859a.js","assets/vue.ab3a18a5.js","assets/Step.2d5b455c.css","assets/Main.aa4b218b.css"])}],modules=Object.assign({"./main.js":main}),router=createRouter({history:createWebHistory("/SIGNooo"),routes:[...Object.values(modules).flat().sort((Y,p)=>Y.path>p.path?1:-1),{path:"/:pathMatch(.*)*",name:"NotFound",component:()=>__vitePreload(()=>import("./NotFound.23bd9373.js"),["assets/NotFound.23bd9373.js","assets/vue.ab3a18a5.js"])}]});function commonjsRequire(Y){throw new Error('Could not dynamically require "'+Y+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf_min$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(p,H){module.exports=H()})(globalThis,()=>(()=>{var __webpack_modules__=[,(Y,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.VerbosityLevel=p.Util=p.UnknownErrorException=p.UnexpectedResponseException=p.UNSUPPORTED_FEATURES=p.TextRenderingMode=p.StreamType=p.RenderingIntentFlag=p.PermissionFlag=p.PasswordResponses=p.PasswordException=p.PageActionEventType=p.OPS=p.MissingPDFException=p.LINE_FACTOR=p.LINE_DESCENT_FACTOR=p.InvalidPDFException=p.ImageKind=p.IDENTITY_MATRIX=p.FormatError=p.FontType=p.FeatureTest=p.FONT_IDENTITY_MATRIX=p.DocumentActionEventType=p.CMapCompressionType=p.BaseException=p.AnnotationType=p.AnnotationStateModelType=p.AnnotationReviewState=p.AnnotationReplyType=p.AnnotationMode=p.AnnotationMarkedState=p.AnnotationFlag=p.AnnotationFieldFlag=p.AnnotationEditorType=p.AnnotationEditorPrefix=p.AnnotationEditorParamsType=p.AnnotationBorderStyleType=p.AnnotationActionEventType=p.AbortException=void 0,p.arrayByteLength=h,p.arraysToBytes=function(o){const s=o.length;if(s===1&&o[0]instanceof Uint8Array)return o[0];let n=0;for(let a=0;a<s;a++)n+=h(o[a]);let i=0;const e=new Uint8Array(n);for(let a=0;a<s;a++){let t=o[a];t instanceof Uint8Array||(t=typeof t=="string"?A(t):new Uint8Array(t));const r=t.byteLength;e.set(t,i),i+=r}return e},p.assert=function(o,s){o||k(s)},p.bytesToString=function(o){typeof o=="object"&&o!==null&&o.length!==void 0||k("Invalid argument for bytesToString");const s=o.length,n=8192;if(s<n)return String.fromCharCode.apply(null,o);const i=[];for(let e=0;e<s;e+=n){const a=Math.min(e+n,s),t=o.subarray(e,a);i.push(String.fromCharCode.apply(null,t))}return i.join("")},p.createPromiseCapability=function(){const o=Object.create(null);let s=!1;return Object.defineProperty(o,"settled",{get:()=>s}),o.promise=new Promise(function(n,i){o.resolve=function(e){s=!0,n(e)},o.reject=function(e){s=!0,i(e)}}),o},p.createValidAbsoluteUrl=function(o,s=null,n=null){if(!o)return null;try{if(n&&typeof o=="string"){if(n.addDefaultProtocol&&o.startsWith("www.")){const e=o.match(/\./g);e&&e.length>=2&&(o=`http://${o}`)}if(n.tryConvertEncoding)try{o=L(o)}catch{}}const i=s?new URL(o,s):new URL(o);if(function(a){if(!a)return!1;switch(a.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null},p.escapeString=function(o){return o.replace(/([()\\\n\r])/g,s=>s===`
`?"\\n":s==="\r"?"\\r":`\\${s}`)},p.getModificationDate=function(o=new Date){return[o.getUTCFullYear().toString(),(o.getUTCMonth()+1).toString().padStart(2,"0"),o.getUTCDate().toString().padStart(2,"0"),o.getUTCHours().toString().padStart(2,"0"),o.getUTCMinutes().toString().padStart(2,"0"),o.getUTCSeconds().toString().padStart(2,"0")].join("")},p.getVerbosityLevel=function(){return _},p.info=function(o){_>=H.INFOS&&console.log(`Info: ${o}`)},p.isArrayBuffer=function(o){return typeof o=="object"&&o!==null&&o.byteLength!==void 0},p.isArrayEqual=function(o,s){if(o.length!==s.length)return!1;for(let n=0,i=o.length;n<i;n++)if(o[n]!==s[n])return!1;return!0},p.isAscii=function(o){return/^[\x00-\x7F]*$/.test(o)},p.objectFromMap=function(o){const s=Object.create(null);for(const[n,i]of o)s[n]=i;return s},p.objectSize=function(o){return Object.keys(o).length},p.setVerbosityLevel=function(o){Number.isInteger(o)&&(_=o)},p.shadow=q,p.string32=function(o){return String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o)},p.stringToBytes=A,p.stringToPDFString=function(o){if(o[0]>="\xEF"){let n;if(o[0]==="\xFE"&&o[1]==="\xFF"?n="utf-16be":o[0]==="\xFF"&&o[1]==="\xFE"?n="utf-16le":o[0]==="\xEF"&&o[1]==="\xBB"&&o[2]==="\xBF"&&(n="utf-8"),n)try{const i=new TextDecoder(n,{fatal:!0}),e=A(o);return i.decode(e)}catch(i){v(`stringToPDFString: "${i}".`)}}const s=[];for(let n=0,i=o.length;n<i;n++){const e=C[o.charCodeAt(n)];s.push(e?String.fromCharCode(e):o.charAt(n))}return s.join("")},p.stringToUTF16BEString=function(o){const s=["\xFE\xFF"];for(let n=0,i=o.length;n<i;n++){const e=o.charCodeAt(n);s.push(String.fromCharCode(e>>8&255),String.fromCharCode(255&e))}return s.join("")},p.stringToUTF8String=L,p.unreachable=k,p.utf8StringToString=function(o){return unescape(encodeURIComponent(o))},p.warn=v,p.IDENTITY_MATRIX=[1,0,0,1,0,0],p.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],p.LINE_FACTOR=1.35,p.LINE_DESCENT_FACTOR=.35,p.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},p.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},p.AnnotationEditorPrefix="pdfjs_internal_editor_",p.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},p.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},p.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},p.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},p.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},p.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},p.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},p.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},p.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},p.AnnotationReplyType={GROUP:"Group",REPLY:"R"},p.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},p.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},p.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},p.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},p.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},p.PageActionEventType={O:"PageOpen",C:"PageClose"},p.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},p.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const H={ERRORS:0,WARNINGS:1,INFOS:5};p.VerbosityLevel=H,p.CMapCompressionType={NONE:0,BINARY:1},p.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},p.UNSUPPORTED_FEATURES={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},p.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _=H.WARNINGS;function v(m){_>=H.WARNINGS&&console.log(`Warning: ${m}`)}function k(m){throw new Error(m)}function q(m,o,s){return Object.defineProperty(m,o,{value:s,enumerable:!0,configurable:!0,writable:!1}),s}const N=function(){function o(s,n){this.constructor===o&&k("Cannot initialize BaseException."),this.message=s,this.name=n}return o.prototype=new Error,o.constructor=o,o}();p.BaseException=N,p.PasswordException=class extends N{constructor(o,s){super(o,"PasswordException"),this.code=s}},p.UnknownErrorException=class extends N{constructor(o,s){super(o,"UnknownErrorException"),this.details=s}},p.InvalidPDFException=class extends N{constructor(o){super(o,"InvalidPDFException")}},p.MissingPDFException=class extends N{constructor(o){super(o,"MissingPDFException")}},p.UnexpectedResponseException=class extends N{constructor(o,s){super(o,"UnexpectedResponseException"),this.status=s}},p.FormatError=class extends N{constructor(o){super(o,"FormatError")}},p.AbortException=class extends N{constructor(o){super(o,"AbortException")}};function A(m){typeof m!="string"&&k("Invalid argument for stringToBytes");const o=m.length,s=new Uint8Array(o);for(let n=0;n<o;++n)s[n]=255&m.charCodeAt(n);return s}function h(m){if(m.length!==void 0)return m.length;if(m.byteLength!==void 0)return m.byteLength;k("Invalid argument for arrayByteLength")}p.FeatureTest=class{static get isLittleEndian(){return q(this,"isLittleEndian",function(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}())}static get isEvalSupported(){return q(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return q(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}};const u=[...Array(256).keys()].map(m=>m.toString(16).padStart(2,"0"));class d{static makeHexColor(o,s,n){return`#${u[o]}${u[s]}${u[n]}`}static scaleMinMax(o,s){let n;o[0]?(o[0]<0&&(n=s[0],s[0]=s[1],s[1]=n),s[0]*=o[0],s[1]*=o[0],o[3]<0&&(n=s[2],s[2]=s[3],s[3]=n),s[2]*=o[3],s[3]*=o[3]):(n=s[0],s[0]=s[2],s[2]=n,n=s[1],s[1]=s[3],s[3]=n,o[1]<0&&(n=s[2],s[2]=s[3],s[3]=n),s[2]*=o[1],s[3]*=o[1],o[2]<0&&(n=s[0],s[0]=s[1],s[1]=n),s[0]*=o[2],s[1]*=o[2]),s[0]+=o[4],s[1]+=o[4],s[2]+=o[5],s[3]+=o[5]}static transform(o,s){return[o[0]*s[0]+o[2]*s[1],o[1]*s[0]+o[3]*s[1],o[0]*s[2]+o[2]*s[3],o[1]*s[2]+o[3]*s[3],o[0]*s[4]+o[2]*s[5]+o[4],o[1]*s[4]+o[3]*s[5]+o[5]]}static applyTransform(o,s){return[o[0]*s[0]+o[1]*s[2]+s[4],o[0]*s[1]+o[1]*s[3]+s[5]]}static applyInverseTransform(o,s){const n=s[0]*s[3]-s[1]*s[2];return[(o[0]*s[3]-o[1]*s[2]+s[2]*s[5]-s[4]*s[3])/n,(-o[0]*s[1]+o[1]*s[0]+s[4]*s[1]-s[5]*s[0])/n]}static getAxialAlignedBoundingBox(o,s){const n=d.applyTransform(o,s),i=d.applyTransform(o.slice(2,4),s),e=d.applyTransform([o[0],o[3]],s),a=d.applyTransform([o[2],o[1]],s);return[Math.min(n[0],i[0],e[0],a[0]),Math.min(n[1],i[1],e[1],a[1]),Math.max(n[0],i[0],e[0],a[0]),Math.max(n[1],i[1],e[1],a[1])]}static inverseTransform(o){const s=o[0]*o[3]-o[1]*o[2];return[o[3]/s,-o[1]/s,-o[2]/s,o[0]/s,(o[2]*o[5]-o[4]*o[3])/s,(o[4]*o[1]-o[5]*o[0])/s]}static singularValueDecompose2dScale(o){const s=[o[0],o[2],o[1],o[3]],n=o[0]*s[0]+o[1]*s[2],i=o[0]*s[1]+o[1]*s[3],e=o[2]*s[0]+o[3]*s[2],a=o[2]*s[1]+o[3]*s[3],t=(n+a)/2,r=Math.sqrt((n+a)**2-4*(n*a-e*i))/2,b=t+r||1,y=t-r||1;return[Math.sqrt(b),Math.sqrt(y)]}static normalizeRect(o){const s=o.slice(0);return o[0]>o[2]&&(s[0]=o[2],s[2]=o[0]),o[1]>o[3]&&(s[1]=o[3],s[3]=o[1]),s}static intersect(o,s){const n=Math.max(Math.min(o[0],o[2]),Math.min(s[0],s[2])),i=Math.min(Math.max(o[0],o[2]),Math.max(s[0],s[2]));if(n>i)return null;const e=Math.max(Math.min(o[1],o[3]),Math.min(s[1],s[3])),a=Math.min(Math.max(o[1],o[3]),Math.max(s[1],s[3]));return e>a?null:[n,e,i,a]}static bezierBoundingBox(o,s,n,i,e,a,t,r){const b=[],y=[[],[]];let F,S,x,I,$,K,j,f;for(let O=0;O<2;++O)if(O===0?(S=6*o-12*n+6*e,F=-3*o+9*n-9*e+3*t,x=3*n-3*o):(S=6*s-12*i+6*a,F=-3*s+9*i-9*a+3*r,x=3*i-3*s),Math.abs(F)<1e-12){if(Math.abs(S)<1e-12)continue;I=-x/S,0<I&&I<1&&b.push(I)}else j=S*S-4*x*F,f=Math.sqrt(j),j<0||($=(-S+f)/(2*F),0<$&&$<1&&b.push($),K=(-S-f)/(2*F),0<K&&K<1&&b.push(K));let l,T=b.length;const R=T;for(;T--;)I=b[T],l=1-I,y[0][T]=l*l*l*o+3*l*l*I*n+3*l*I*I*e+I*I*I*t,y[1][T]=l*l*l*s+3*l*l*I*i+3*l*I*I*a+I*I*I*r;return y[0][R]=o,y[1][R]=s,y[0][R+1]=t,y[1][R+1]=r,y[0].length=y[1].length=R+2,[Math.min(...y[0]),Math.min(...y[1]),Math.max(...y[0]),Math.max(...y[1])]}}p.Util=d;const C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function L(m){return decodeURIComponent(escape(m))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Y,H,_,v,k,q,N,A,h,u,d,se,L,m;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(12),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:s,NodeCMapReaderFactory:n,NodeStandardFontDataFactory:i}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=s,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=n,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=i}function setPDFNetworkStreamFactory(s){createPDFNetworkStream=s}function getDocument(s){const n=new PDFDocumentLoadingTask;let i;if(typeof s=="string"||s instanceof URL)i={url:s};else if((0,_util.isArrayBuffer)(s))i={data:s};else if(s instanceof PDFDataRangeTransport)i={range:s};else{if(typeof s!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");i=s}const e=Object.create(null);let a=null,t=null;for(const b in i){const y=i[b];switch(b){case"url":if(typeof window<"u")try{e[b]=new URL(y,window.location).href;continue}catch(F){(0,_util.warn)(`Cannot create valid URL: "${F}".`)}else if(typeof y=="string"||y instanceof URL){e[b]=y.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":a=y;continue;case"worker":t=y;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&y instanceof Buffer)e[b]=new Uint8Array(y);else{if(y instanceof Uint8Array)break;if(typeof y=="string")e[b]=(0,_util.stringToBytes)(y);else if(typeof y!="object"||y===null||isNaN(y.length)){if(!(0,_util.isArrayBuffer)(y))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");e[b]=new Uint8Array(y)}else e[b]=new Uint8Array(y)}continue}e[b]=y}if(e.CMapReaderFactory=e.CMapReaderFactory||DefaultCMapReaderFactory,e.StandardFontDataFactory=e.StandardFontDataFactory||DefaultStandardFontDataFactory,e.ignoreErrors=e.stopAtErrors!==!0,e.fontExtraProperties=e.fontExtraProperties===!0,e.pdfBug=e.pdfBug===!0,e.enableXfa=e.enableXfa===!0,(!Number.isInteger(e.rangeChunkSize)||e.rangeChunkSize<1)&&(e.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof e.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(e.docBaseUrl))&&(e.docBaseUrl=null),(!Number.isInteger(e.maxImageSize)||e.maxImageSize<-1)&&(e.maxImageSize=-1),typeof e.cMapUrl!="string"&&(e.cMapUrl=null),typeof e.standardFontDataUrl!="string"&&(e.standardFontDataUrl=null),typeof e.useWorkerFetch!="boolean"&&(e.useWorkerFetch=e.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&e.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof e.isEvalSupported!="boolean"&&(e.isEvalSupported=!0),typeof e.isOffscreenCanvasSupported!="boolean"&&(e.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof e.disableFontFace!="boolean"&&(e.disableFontFace=_is_node.isNodeJS),typeof e.useSystemFonts!="boolean"&&(e.useSystemFonts=!_is_node.isNodeJS&&!e.disableFontFace),typeof e.ownerDocument=="object"&&e.ownerDocument!==null||(e.ownerDocument=globalThis.document),typeof e.disableRange!="boolean"&&(e.disableRange=!1),typeof e.disableStream!="boolean"&&(e.disableStream=!1),typeof e.disableAutoFetch!="boolean"&&(e.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(e.verbosity),!t){const b={verbosity:e.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};t=b.port?PDFWorker.fromPort(b):new PDFWorker(b),n._worker=t}const r=n.docId;return t.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const b=_fetchDocument(t,e,a,r),y=new Promise(function(F){let S;a?S=new _transport_stream.PDFDataTransportStream({length:e.length,initialData:e.initialData,progressiveDone:e.progressiveDone,contentDispositionFilename:e.contentDispositionFilename,disableRange:e.disableRange,disableStream:e.disableStream},a):e.data||(S=createPDFNetworkStream({url:e.url,length:e.length,httpHeaders:e.httpHeaders,withCredentials:e.withCredentials,rangeChunkSize:e.rangeChunkSize,disableRange:e.disableRange,disableStream:e.disableStream})),F(S)});return Promise.all([b,y]).then(function([F,S]){if(n.destroyed)throw new Error("Loading aborted");const x=new _message_handler.MessageHandler(r,F,t.port),I=new WorkerTransport(x,n,S,e);n._transport=I,x.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(s,n,i,e){if(s.destroyed)throw new Error("Worker was destroyed");i&&(n.length=i.length,n.initialData=i.initialData,n.progressiveDone=i.progressiveDone,n.contentDispositionFilename=i.contentDispositionFilename);const a=await s.messageHandler.sendWithPromise("GetDocRequest",{docId:e,apiVersion:"3.0.279",data:n.data,password:n.password,disableAutoFetch:n.disableAutoFetch,rangeChunkSize:n.rangeChunkSize,length:n.length,docBaseUrl:n.docBaseUrl,enableXfa:n.enableXfa,evaluatorOptions:{maxImageSize:n.maxImageSize,disableFontFace:n.disableFontFace,ignoreErrors:n.ignoreErrors,isEvalSupported:n.isEvalSupported,isOffscreenCanvasSupported:n.isOffscreenCanvasSupported,fontExtraProperties:n.fontExtraProperties,useSystemFonts:n.useSystemFonts,cMapUrl:n.useWorkerFetch?n.cMapUrl:null,standardFontDataUrl:n.useWorkerFetch?n.standardFontDataUrl:null}});if(n.data&&(n.data=null),s.destroyed)throw new Error("Worker was destroyed");return a}const p=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+ee(p,Y)._++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var n;this.destroyed=!0,await((n=this._transport)==null?void 0:n.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=p;Y=new WeakMap,Z(PDFDocumentLoadingTask,Y,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,i,e=!1,a=null){this.length=n,this.initialData=i,this.progressiveDone=e,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,i){for(const e of this._rangeListeners)e(n,i)}onDataProgress(n,i){this._readyCapability.promise.then(()=>{for(const e of this._progressListeners)e(n,i)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const i of this._progressiveReadListeners)i(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,i){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,i){this._pdfInfo=n,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(n,i,e,a,t=!1){this._pageIndex=n,this._pageInfo=i,this._ownerDocument=a,this._transport=e,this._stats=t?new _display_utils.StatTimer:null,this._pdfBug=t,this.commonObjs=e.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:i=this.rotate,offsetX:e=0,offsetY:a=0,dontFlip:t=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:i,offsetX:e,offsetY:a,dontFlip:t})}getAnnotations({intent:n="display"}={}){const i=this._transport.getRenderingIntent(n);let e=this._annotationPromises.get(i.cacheKey);return e||(e=this._transport.getAnnotations(this._pageIndex,i.renderingIntent),this._annotationPromises.set(i.cacheKey,e)),e}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var n;return((n=this._transport._htmlForXfa)==null?void 0:n.children[this._pageIndex])||null}render({canvasContext:n,viewport:i,intent:e="display",annotationMode:a=_util.AnnotationMode.ENABLE,transform:t=null,canvasFactory:r=null,background:b=null,optionalContentConfigPromise:y=null,annotationCanvasMap:F=null,pageColors:S=null,printAnnotationStorage:x=null}){var R,O;(R=this._stats)==null||R.time("Overall");const I=this._transport.getRenderingIntent(e,a,x);this.pendingCleanup=!1,y||(y=this._transport.getOptionalContentConfig());let $=this._intentStates.get(I.cacheKey);$||($=Object.create(null),this._intentStates.set(I.cacheKey,$)),$.streamReaderCancelTimeout&&(clearTimeout($.streamReaderCancelTimeout),$.streamReaderCancelTimeout=null);const K=r||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),j=!!(I.renderingIntent&_util.RenderingIntentFlag.PRINT);$.displayReadyCapability||($.displayReadyCapability=(0,_util.createPromiseCapability)(),$.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(O=this._stats)==null||O.time("Page Request"),this._pumpOperatorList(I));const f=B=>{var P,z;$.renderTasks.delete(l),(this.cleanupAfterRender||j)&&(this.pendingCleanup=!0),this._tryCleanup(),B?(l.capability.reject(B),this._abortOperatorList({intentState:$,reason:B instanceof Error?B:new Error(B)})):l.capability.resolve(),(P=this._stats)==null||P.timeEnd("Rendering"),(z=this._stats)==null||z.timeEnd("Overall")},l=new InternalRenderTask({callback:f,params:{canvasContext:n,viewport:i,transform:t,background:b},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:F,operatorList:$.operatorList,pageIndex:this._pageIndex,canvasFactory:K,useRequestAnimationFrame:!j,pdfBug:this._pdfBug,pageColors:S});($.renderTasks||($.renderTasks=new Set)).add(l);const T=l.task;return Promise.all([$.displayReadyCapability.promise,y]).then(([B,P])=>{var z;this.pendingCleanup?f():((z=this._stats)==null||z.time("Rendering"),l.initializeGraphics({transparency:B,optionalContentConfig:P}),l.operatorListChanged())}).catch(f),T}getOperatorList({intent:n="display",annotationMode:i=_util.AnnotationMode.ENABLE,printAnnotationStorage:e=null}={}){var b;const a=this._transport.getRenderingIntent(n,i,e,!0);let t,r=this._intentStates.get(a.cacheKey);return r||(r=Object.create(null),this._intentStates.set(a.cacheKey,r)),r.opListReadCapability||(t=Object.create(null),t.operatorListChanged=function(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(t))},r.opListReadCapability=(0,_util.createPromiseCapability)(),(r.renderTasks||(r.renderTasks=new Set)).add(t),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(b=this._stats)==null||b.time("Page Request"),this._pumpOperatorList(a)),r.opListReadCapability.promise}streamTextContent({disableCombineTextItems:n=!1,includeMarkedContent:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:n!==!0,includeMarkedContent:i===!0},{highWaterMark:100,size:e=>e.items.length})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const i=this.streamTextContent(n);return new Promise(function(e,a){const t=i.getReader(),r={items:[],styles:Object.create(null)};(function b(){t.read().then(function({value:y,done:F}){F?e(r):(Object.assign(r.styles,y.styles),r.items.push(...y.items),b())},a)})()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const n=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const e of i.renderTasks)n.push(e.completed),e.cancel();this.objs.clear();for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(n)}cleanup(n=!1){return this.pendingCleanup=!0,this._tryCleanup(n)}_tryCleanup(n=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:i,operatorList:e}of this._intentStates.values())if(i.size>0||!e.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,n&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(n,i){var a,t;const e=this._intentStates.get(i);e&&((a=this._stats)==null||a.timeEnd("Page Request"),(t=e.displayReadyCapability)==null||t.resolve(n))}_renderPageChunk(n,i){for(let e=0,a=n.length;e<a;e++)i.operatorList.fnArray.push(n.fnArray[e]),i.operatorList.argsArray.push(n.argsArray[e]);i.operatorList.lastChunk=n.lastChunk,i.operatorList.separateAnnots=n.separateAnnots;for(const e of i.renderTasks)e.operatorListChanged();n.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:n,cacheKey:i,annotationStorageMap:e}){const a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:i,annotationStorage:e}).getReader(),t=this._intentStates.get(i);t.streamReader=a;const r=()=>{a.read().then(({value:b,done:y})=>{y?t.streamReader=null:this._transport.destroyed||(this._renderPageChunk(b,t),r())},b=>{if(t.streamReader=null,!this._transport.destroyed){if(t.operatorList){t.operatorList.lastChunk=!0;for(const y of t.renderTasks)y.operatorListChanged();this._tryCleanup()}if(t.displayReadyCapability)t.displayReadyCapability.reject(b);else{if(!t.opListReadCapability)throw b;t.opListReadCapability.reject(b)}}})};r()}_abortOperatorList({intentState:n,reason:i,force:e=!1}){if(n.streamReader){if(!e){if(n.renderTasks.size>0)return;if(i instanceof _display_utils.RenderingCancelledException){n.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:n,reason:i,force:!0}),n.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(n.streamReader.cancel(new _util.AbortException(i.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[a,t]of this._intentStates)if(t===n){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Z(this,H,[]);Z(this,_,Promise.resolve())}postMessage(n,i){const e={data:structuredClone(n,i)};E(this,_).then(()=>{for(const a of E(this,H))a.call(this,e)})}addEventListener(n,i){E(this,H).push(i)}removeEventListener(n,i){const e=E(this,H).indexOf(i);E(this,H).splice(e,1)}terminate(){E(this,H).length=0}}H=new WeakMap,_=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=(v=document==null?void 0:document.currentScript)==null?void 0:v.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,n){let i;try{if(i=new URL(s),!i.origin||i.origin==="null")return!1}catch{return!1}const e=new URL(n,i);return i.origin===e.origin},PDFWorkerUtil.createCDNWrapper=function(s){const n=`importScripts("${s}");`;return URL.createObjectURL(new Blob([n]))};const _PDFWorker=class{constructor({name:s=null,port:n=null,verbosity:i=(0,_util.getVerbosityLevel)()}={}){if(n&&E(_PDFWorker,k).has(n))throw new Error("Cannot use more than one PDFWorker per port.");this.name=s,this.destroyed=!1,this.verbosity=i,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,n?(E(_PDFWorker,k).set(n,this),this._initializeFromPort(n)):this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const n=new Worker(s),i=new _message_handler.MessageHandler("main","worker",n),e=()=>{n.removeEventListener("error",a),i.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||e()};n.addEventListener("error",a),i.on("test",r=>{n.removeEventListener("error",a),this.destroyed?e():r?(this._messageHandler=i,this._port=n,this._webWorker=n,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),n.terminate())}),i.on("ready",r=>{if(n.removeEventListener("error",a),this.destroyed)e();else try{t()}catch{this._setupFakeWorker()}});const t=()=>{const r=new Uint8Array;i.send("test",r,[r.buffer])};t();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const i="fake"+PDFWorkerUtil.fakeWorkerId++,e=new _message_handler.MessageHandler(i+"_worker",i,n);s.setup(e,n);const a=new _message_handler.MessageHandler(i,i+"_worker",n);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),E(_PDFWorker,k).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return E(this,k).has(s.port)?E(this,k).get(s.port):new _PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;k=new WeakMap,Z(PDFWorker,k,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(n,i,e,a){Z(this,q,null);Z(this,N,new Map);Z(this,A,new Map);Z(this,h,null);this.messageHandler=n,this.loadingTask=i,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this._params=a,a.useWorkerFetch||(this.CMapReaderFactory=new a.CMapReaderFactory({baseUrl:a.cMapUrl,isCompressed:a.cMapPacked}),this.StandardFontDataFactory=new a.StandardFontDataFactory({baseUrl:a.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=e,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return E(this,q)}getRenderingIntent(n,i=_util.AnnotationMode.ENABLE,e=null,a=!1){let t=_util.RenderingIntentFlag.DISPLAY,r=null;switch(n){case"any":t=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":t=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(i){case _util.AnnotationMode.DISABLE:t+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:t+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:t+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,r=(t&_util.RenderingIntentFlag.PRINT&&e instanceof _annotation_storage.PrintAnnotationStorage?e:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${i}`)}return a&&(t+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:t,cacheKey:`${t}_${_annotation_storage.AnnotationStorage.getHash(r)}`,annotationStorageMap:r}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const e of E(this,N).values())n.push(e._destroy());E(this,N).clear(),E(this,A).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return n.push(i),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),ut(this,h,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:i}=this;n.on("GetReader",(e,a)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},a.onPull=()=>{this._fullReader.read().then(function({value:t,done:r}){r?a.close():((0,_util.assert)((0,_util.isArrayBuffer)(t),"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(t),1,[t]))}).catch(t=>{a.error(t)})},a.onCancel=t=>{this._fullReader.cancel(t),a.ready.catch(r=>{if(!this.destroyed)throw r})}}),n.on("ReaderHeadersReady",e=>{const a=(0,_util.createPromiseCapability)(),t=this._fullReader;return t.headersReady.then(()=>{var r;(!t.isStreamingSupported||!t.isRangeSupported)&&(this._lastProgress&&((r=i.onProgress)==null||r.call(i,this._lastProgress)),t.onProgress=b=>{var y;(y=i.onProgress)==null||y.call(i,{loaded:b.loaded,total:b.total})}),a.resolve({isStreamingSupported:t.isStreamingSupported,isRangeSupported:t.isRangeSupported,contentLength:t.contentLength})},a.reject),a.promise}),n.on("GetRangeReader",(e,a)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const t=this._networkStream.getRangeReader(e.begin,e.end);t?(a.onPull=()=>{t.read().then(function({value:r,done:b}){b?a.close():((0,_util.assert)((0,_util.isArrayBuffer)(r),"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(r),1,[r]))}).catch(r=>{a.error(r)})},a.onCancel=r=>{t.cancel(r),a.ready.catch(b=>{if(!this.destroyed)throw b})}):a.close()}),n.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,i._capability.resolve(new PDFDocumentProxy(e,this))}),n.on("DocException",function(e){let a;switch(e.name){case"PasswordException":a=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":a=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":a=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":a=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":a=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}i._capability.reject(a)}),n.on("PasswordRequest",e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),i.onPassword){const a=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{i.onPassword(a,e.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise}),n.on("DataLoaded",e=>{var a;(a=i.onProgress)==null||a.call(i,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),n.on("StartRenderPage",e=>{this.destroyed||E(this,N).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),n.on("commonobj",([e,a,t])=>{var r;if(!this.destroyed&&!this.commonObjs.has(e))switch(a){case"Font":const b=this._params;if("error"in t){const S=t.error;(0,_util.warn)(`Error during font loading: ${S}`),this.commonObjs.resolve(e,S);break}let y=null;b.pdfBug&&((r=globalThis.FontInspector)==null?void 0:r.enabled)&&(y={registerFont(S,x){globalThis.FontInspector.fontAdded(S,x)}});const F=new _font_loader.FontFaceObject(t,{isEvalSupported:b.isEvalSupported,disableFontFace:b.disableFontFace,ignoreErrors:b.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:y});this.fontLoader.bind(F).catch(S=>n.sendWithPromise("FontFallback",{id:e})).finally(()=>{!b.fontExtraProperties&&F.data&&(F.data=null),this.commonObjs.resolve(e,F)});break;case"FontPath":case"Image":this.commonObjs.resolve(e,t);break;default:throw new Error(`Got unknown common object type ${a}`)}}),n.on("obj",([e,a,t,r])=>{var y;if(this.destroyed)return;const b=E(this,N).get(a);if(!b.objs.has(e))switch(t){case"Image":b.objs.resolve(e,r);const F=8e6;if(r){let S;if(r.bitmap){const{bitmap:x,width:I,height:$}=r;S=I*$*4,b._bitmaps.add(x)}else S=((y=r.data)==null?void 0:y.length)||0;S>F&&(b.cleanupAfterRender=!0)}break;case"Pattern":b.objs.resolve(e,r);break;default:throw new Error(`Got unknown object type ${t}`)}}),n.on("DocProgress",e=>{var a;this.destroyed||((a=i.onProgress)==null||a.call(i,{loaded:e.loaded,total:e.total}))}),n.on("DocStats",e=>{this.destroyed||ut(this,q,Object.freeze({streamTypes:Object.freeze(e.streamTypes),fontTypes:Object.freeze(e.fontTypes)}))}),n.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),n.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:n}){var i,e;this.destroyed||((e=(i=this.loadingTask).onUnsupportedFeature)==null||e.call(i,n))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n,i;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(i=(n=this._fullReader)==null?void 0:n.filename)!=null?i:null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=n-1,e=E(this,A).get(i);if(e)return e;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(t=>{if(this.destroyed)throw new Error("Transport destroyed");const r=new PDFPageProxy(i,t,this,this._params.ownerDocument,this._params.pdfBug);return E(this,N).set(i,r),r});return E(this,A).set(i,a),a}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:i})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return E(this,h)||ut(this,h,this.messageHandler.sendWithPromise("GetMetadata",null).then(n=>{var i,e,a,t;return{info:n[0],metadata:n[1]?new _metadata.Metadata(n[1]):null,contentDispositionFilename:(e=(i=this._fullReader)==null?void 0:i.filename)!=null?e:null,contentLength:(t=(a=this._fullReader)==null?void 0:a.contentLength)!=null?t:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of E(this,N).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),ut(this,h,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const n=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n.disableAutoFetch,enableXfa:n.enableXfa})}}q=new WeakMap,N=new WeakMap,A=new WeakMap,h=new WeakMap;class PDFObjects{constructor(){Z(this,d);Z(this,u,Object.create(null))}get(n,i=null){if(i){const a=rt(this,d,se).call(this,n);return a.capability.promise.then(()=>i(a.data)),null}const e=E(this,u)[n];if(!(e!=null&&e.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${n}.`);return e.data}has(n){var i;return((i=E(this,u)[n])==null?void 0:i.capability.settled)||!1}resolve(n,i=null){const e=rt(this,d,se).call(this,n);e.data=i,e.capability.resolve()}clear(){ut(this,u,Object.create(null))}}u=new WeakMap,d=new WeakSet,se=function(n){return E(this,u)[n]||(E(this,u)[n]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(n){Z(this,L,null);ut(this,L,n),this.onContinue=null}get promise(){return E(this,L).capability.promise}cancel(){E(this,L).cancel()}get separateAnnots(){const{separateAnnots:n}=E(this,L).operatorList;if(!n)return!1;const{annotationCanvasMap:i}=E(this,L);return n.form||n.canvas&&(i==null?void 0:i.size)>0}}L=new WeakMap,exports.RenderTask=RenderTask;const o=class{constructor({callback:n,params:i,objs:e,commonObjs:a,annotationCanvasMap:t,operatorList:r,pageIndex:b,canvasFactory:y,useRequestAnimationFrame:F=!1,pdfBug:S=!1,pageColors:x=null}){this.callback=n,this.params=i,this.objs=e,this.commonObjs=a,this.annotationCanvasMap=t,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=b,this.canvasFactory=y,this._pdfBug=S,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=F===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:i}){var b,y;if(this.cancelled)return;if(this._canvas){if(E(o,m).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");E(o,m).add(this._canvas)}this._pdfBug&&((b=globalThis.StepperManager)==null?void 0:b.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:e,viewport:a,transform:t,background:r}=this.params;this.gfx=new _canvas.CanvasGraphics(e,this.commonObjs,this.objs,this.canvasFactory,i,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:t,viewport:a,transparency:n,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(y=this.graphicsReadyCallback)==null||y.call(this)}cancel(n=null){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),this._canvas&&E(o,m).delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){var n;this.graphicsReady?((n=this.stepper)==null||n.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&E(o,m).delete(this._canvas),this.callback())))}};let InternalRenderTask=o;m=new WeakMap,Z(InternalRenderTask,m,new WeakSet);const version="3.0.279";exports.version=version;const build="d0823066c";exports.build=build},(Y,p,H)=>{var A,Se,u;Object.defineProperty(p,"__esModule",{value:!0}),p.PrintAnnotationStorage=p.AnnotationStorage=void 0;var _=H(1),v=H(4),k=H(8);class q{constructor(){Z(this,A);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(C,L){const m=this._storage.get(C);return m===void 0?L:Object.assign(L,m)}getRawValue(C){return this._storage.get(C)}remove(C){if(this._storage.delete(C),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const L of this._storage.values())if(L instanceof v.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(C,L){const m=this._storage.get(C);let o=!1;if(m!==void 0)for(const[s,n]of Object.entries(L))m[s]!==n&&(o=!0,m[s]=n);else o=!0,this._storage.set(C,L);o&&rt(this,A,Se).call(this),L instanceof v.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(L.constructor._type)}has(C){return this._storage.has(C)}getAll(){return this._storage.size>0?(0,_.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new N(this)}get serializable(){if(this._storage.size===0)return null;const C=new Map;for(const[L,m]of this._storage){const o=m instanceof v.AnnotationEditor?m.serialize():m;o&&C.set(L,o)}return C}static getHash(C){if(!C)return"";const L=new k.MurmurHash3_64;for(const[m,o]of C)L.update(`${m}:${JSON.stringify(o)}`);return L.hexdigest()}}A=new WeakSet,Se=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},p.AnnotationStorage=q;class N extends q{constructor(L){super();Z(this,u,null);ut(this,u,structuredClone(L.serializable))}get print(){(0,_.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return E(this,u)}}u=new WeakMap,p.PrintAnnotationStorage=N},(Y,p,H)=>{var q,N,A,h,u,d;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationEditor=void 0;var _=H(5),v=H(1);const C=class{constructor(m){Z(this,q,this.focusin.bind(this));Z(this,N,this.focusout.bind(this));Z(this,A,!1);Z(this,h,!1);Z(this,u,!1);Z(this,d,C._zIndex++);this.constructor===C&&(0,v.unreachable)("Cannot initialize AnnotationEditor."),this.parent=m.parent,this.id=m.id,this.width=this.height=null,this.pageIndex=m.parent.pageIndex,this.name=m.name,this.div=null;const[o,s]=this.parent.viewportBaseDimensions;this.x=m.x/o,this.y=m.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,v.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=E(this,d)}focusin(m){E(this,A)?ut(this,A,!1):this.parent.setSelected(this)}focusout(m){var o;!this.isAttachedToDOM||(o=m.relatedTarget)!=null&&o.closest(`#${this.id}`)||(m.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(m){const o=this.parent.div.getBoundingClientRect();this.startX=m.clientX-o.x,this.startY=m.clientY-o.y,m.dataTransfer.setData("text/plain",this.id),m.dataTransfer.effectAllowed="move"}setAt(m,o,s,n){const[i,e]=this.parent.viewportBaseDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(m+s)/i,this.y=(o+n)/e,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(m,o){const[s,n]=this.parent.viewportBaseDimensions;[m,o]=this.screenToPageTranslation(m,o),this.x+=m/s,this.y+=o/n,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(m,o){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[o,-m];case 180:return[-m,-o];case 270:return[-o,m];default:return[m,o]}}setDims(m,o){const[s,n]=this.parent.viewportBaseDimensions;this.div.style.width=100*m/s+"%",this.div.style.height=100*o/n+"%"}fixDims(){const{style:m}=this.div,{height:o,width:s}=m,n=s.endsWith("%"),i=o.endsWith("%");if(n&&i)return;const[e,a]=this.parent.viewportBaseDimensions;n||(m.width=100*parseFloat(s)/e+"%"),i||(m.height=100*parseFloat(o)/a+"%")}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",E(this,q)),this.div.addEventListener("focusout",E(this,N));const[m,o]=this.getInitialTranslation();return this.translate(m,o),(0,_.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(m){const o=_.KeyboardManager.platform.isMac;m.button!==0||m.ctrlKey&&o?m.preventDefault():(m.ctrlKey&&!o||m.shiftKey||m.metaKey&&o?this.parent.toggleSelected(this):this.parent.setSelected(this),ut(this,A,!0))}getRect(m,o){const[s,n]=this.parent.viewportBaseDimensions,[i,e]=this.parent.pageDimensions,a=i*m/s,t=e*o/n,r=this.x*i,b=this.y*e,y=this.width*i,F=this.height*e;switch(this.rotation){case 0:return[r+a,e-b-t-F,r+a+y,e-b-t];case 90:return[r+t,e-b+a,r+t+F,e-b+a+y];case 180:return[r-a-y,e-b+t,r-a,e-b+t+F];case 270:return[r-t-F,e-b-a-y,r-t,e-b-a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(m,o){const[s,n,i,e]=m,a=i-s,t=e-n;switch(this.rotation){case 0:return[s,o-e,a,t];case 90:return[s,o-n,t,a];case 180:return[i,o-n,a,t];case 270:return[i,o-e,t,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ut(this,u,!0)}disableEditMode(){ut(this,u,!1)}isInEditMode(){return E(this,u)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var m;(m=this.div)==null||m.addEventListener("focusin",E(this,q))}serialize(){(0,v.unreachable)("An editor must be serializable")}static deserialize(m,o){const s=new this.prototype.constructor({parent:o,id:o.getNextId()});s.rotation=m.rotation;const[n,i]=o.pageDimensions,[e,a,t,r]=s.getRectInCurrentCoords(m.rect,i);return s.x=e/n,s.y=a/i,s.width=t/n,s.height=r/i,s}remove(){this.div.removeEventListener("focusin",E(this,q)),this.div.removeEventListener("focusout",E(this,N)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var m;(m=this.div)==null||m.classList.add("selectedEditor")}unselect(){var m;(m=this.div)==null||m.classList.remove("selectedEditor")}updateParams(m,o){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return E(this,h)}set isEditing(m){ut(this,h,m),m?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let k=C;q=new WeakMap,N=new WeakMap,A=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap,wt(k,"_colorManager",new _.ColorManager),wt(k,"_zIndex",1),p.AnnotationEditor=k},(Y,p,H)=>{var u,d,C,L,m,o,xe,e,a,t,r,b,y,F,S,x,I,$,K,j,f,l,T,R,O,B,P,Ce,G,ie,J,Ee,at,Te,dt,Ot,ht,Gt,g,we,M,Pe,V,ne,et,Ht,gt,re;Object.defineProperty(p,"__esModule",{value:!0}),p.KeyboardManager=p.CommandManager=p.ColorManager=p.AnnotationEditorUIManager=void 0,p.bindEvents=function(W,it,_t){for(const At of _t)it.addEventListener(At,W[At].bind(W))},p.opacityToHex=function(W){return Math.round(Math.min(255,Math.max(1,255*W))).toString(16).padStart(2,"0")};var _=H(1),v=H(6);class k{constructor(){Z(this,u,0)}getId(){return`${_.AnnotationEditorPrefix}${ee(this,u)._++}`}}u=new WeakMap;class q{constructor(W=128){Z(this,d,[]);Z(this,C,!1);Z(this,L,void 0);Z(this,m,-1);ut(this,L,W)}add({cmd:W,undo:it,mustExec:_t,type:At=NaN,overwriteIfSameType:Ft=!1,keepUndo:Pt=!1}){if(_t&&W(),E(this,C))return;const Mt={cmd:W,undo:it,type:At};if(E(this,m)===-1){E(this,d).length>0&&(E(this,d).length=0),ut(this,m,0),E(this,d).push(Mt);return}if(Ft&&E(this,d)[E(this,m)].type===At){Pt&&(Mt.undo=E(this,d)[E(this,m)].undo),E(this,d)[E(this,m)]=Mt;return}const Ct=E(this,m)+1;Ct===E(this,L)?E(this,d).splice(0,1):(ut(this,m,Ct),Ct<E(this,d).length&&E(this,d).splice(Ct)),E(this,d).push(Mt)}undo(){E(this,m)!==-1&&(ut(this,C,!0),E(this,d)[E(this,m)].undo(),ut(this,C,!1),ut(this,m,E(this,m)-1))}redo(){E(this,m)<E(this,d).length-1&&(ut(this,m,E(this,m)+1),ut(this,C,!0),E(this,d)[E(this,m)].cmd(),ut(this,C,!1))}hasSomethingToUndo(){return E(this,m)!==-1}hasSomethingToRedo(){return E(this,m)<E(this,d).length-1}destroy(){ut(this,d,null)}}d=new WeakMap,C=new WeakMap,L=new WeakMap,m=new WeakMap,p.CommandManager=q;const n=class{constructor(W){Z(this,o);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const it=n.platform.isMac;for(const[_t,At]of W)for(const Ft of _t){const Pt=Ft.startsWith("mac+");it&&Pt?(this.callbacks.set(Ft.slice(4),At),this.allKeys.add(Ft.split("+").at(-1))):!it&&!Pt&&(this.callbacks.set(Ft,At),this.allKeys.add(Ft.split("+").at(-1)))}}static get platform(){const W=typeof navigator<"u"?navigator.platform:"";return(0,_.shadow)(this,"platform",{isWin:W.includes("Win"),isMac:W.includes("Mac")})}exec(W,it){if(!this.allKeys.has(it.key))return;const _t=this.callbacks.get(rt(this,o,xe).call(this,it));_t&&(_t.bind(W)(),it.stopPropagation(),it.preventDefault())}};let N=n;o=new WeakSet,xe=function(W){W.altKey&&this.buffer.push("alt"),W.ctrlKey&&this.buffer.push("ctrl"),W.metaKey&&this.buffer.push("meta"),W.shiftKey&&this.buffer.push("shift"),this.buffer.push(W.key);const it=this.buffer.join("+");return this.buffer.length=0,it},p.KeyboardManager=N;const i=class{get _colors(){const W=new Map([["CanvasText",null],["Canvas",null]]);return(0,v.getColorValues)(W),(0,_.shadow)(this,"_colors",W)}convert(W){const it=(0,v.getRGB)(W);if(!window.matchMedia("(forced-colors: active)").matches)return it;for(const[_t,At]of this._colors)if(At.every((Ft,Pt)=>Ft===it[Pt]))return i._colorsMapping.get(_t);return it}getHexCode(W){const it=this._colors.get(W);return it?_.Util.makeHexColor(...it):W}};let A=i;wt(A,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),p.ColorManager=A;const lt=class{constructor(W,it){Z(this,P);Z(this,G);Z(this,J);Z(this,at);Z(this,dt);Z(this,ht);Z(this,g);Z(this,M);Z(this,V);Z(this,et);Z(this,gt);Z(this,e,null);Z(this,a,new Map);Z(this,t,new Map);Z(this,r,new q);Z(this,b,0);Z(this,y,null);Z(this,F,null);Z(this,S,new k);Z(this,x,!1);Z(this,I,_.AnnotationEditorType.NONE);Z(this,$,new Set);Z(this,K,this.copy.bind(this));Z(this,j,this.cut.bind(this));Z(this,f,this.paste.bind(this));Z(this,l,this.keydown.bind(this));Z(this,T,this.onEditingAction.bind(this));Z(this,R,this.onPageChanging.bind(this));Z(this,O,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Z(this,B,null);ut(this,B,W),ut(this,F,it),E(this,F)._on("editingaction",E(this,T)),E(this,F)._on("pagechanging",E(this,R))}destroy(){rt(this,G,ie).call(this),E(this,F)._off("editingaction",E(this,T)),E(this,F)._off("pagechanging",E(this,R));for(const W of E(this,t).values())W.destroy();E(this,t).clear(),E(this,a).clear(),ut(this,e,null),E(this,$).clear(),E(this,r).destroy()}onPageChanging({pageNumber:W}){ut(this,b,W-1)}focusMainContainer(){E(this,B).focus()}copy(W){if(W.preventDefault(),E(this,e)&&E(this,e).commitOrRemove(),!this.hasSelection)return;const it=[];for(const _t of E(this,$))_t.isEmpty()||it.push(_t.serialize());it.length!==0&&W.clipboardData.setData("application/pdfjs",JSON.stringify(it))}cut(W){this.copy(W),this.delete()}paste(W){W.preventDefault();let it=W.clipboardData.getData("application/pdfjs");if(!it)return;try{it=JSON.parse(it)}catch(At){(0,_.warn)(`paste: "${At.message}".`);return}if(!Array.isArray(it))return;this.unselectAll();const _t=E(this,t).get(E(this,b));try{const At=[];for(const Mt of it){const Ct=_t.deserialize(Mt);if(!Ct)return;At.push(Ct)}const Ft=()=>{for(const Mt of At)rt(this,V,ne).call(this,Mt);rt(this,gt,re).call(this,At)},Pt=()=>{for(const Mt of At)Mt.remove()};this.addCommands({cmd:Ft,undo:Pt,mustExec:!0})}catch(At){(0,_.warn)(`paste: "${At.message}".`)}}keydown(W){var it;(it=this.getActive())!=null&&it.shouldGetKeyboardEvents()||lt._keyboardManager.exec(this,W)}onEditingAction(W){["undo","redo","delete","selectAll"].includes(W.name)&&this[W.name]()}setEditingState(W){W?(rt(this,P,Ce).call(this),rt(this,J,Ee).call(this),rt(this,dt,Ot).call(this,{isEditing:E(this,I)!==_.AnnotationEditorType.NONE,isEmpty:rt(this,et,Ht).call(this),hasSomethingToUndo:E(this,r).hasSomethingToUndo(),hasSomethingToRedo:E(this,r).hasSomethingToRedo(),hasSelectedEditor:!1})):(rt(this,G,ie).call(this),rt(this,at,Te).call(this),rt(this,dt,Ot).call(this,{isEditing:!1}))}registerEditorTypes(W){if(!E(this,y)){ut(this,y,W);for(const it of E(this,y))rt(this,ht,Gt).call(this,it.defaultPropertiesToUpdate)}}getId(){return E(this,S).getId()}addLayer(W){E(this,t).set(W.pageIndex,W),E(this,x)?W.enable():W.disable()}removeLayer(W){E(this,t).delete(W.pageIndex)}updateMode(W){if(ut(this,I,W),W===_.AnnotationEditorType.NONE)this.setEditingState(!1),rt(this,M,Pe).call(this);else{this.setEditingState(!0),rt(this,g,we).call(this);for(const it of E(this,t).values())it.updateMode(W)}}updateToolbar(W){W!==E(this,I)&&E(this,F).dispatch("switchannotationeditormode",{source:this,mode:W})}updateParams(W,it){if(E(this,y)){for(const _t of E(this,$))_t.updateParams(W,it);for(const _t of E(this,y))_t.updateDefaultParams(W,it)}}getEditors(W){const it=[];for(const _t of E(this,a).values())_t.pageIndex===W&&it.push(_t);return it}getEditor(W){return E(this,a).get(W)}addEditor(W){E(this,a).set(W.id,W)}removeEditor(W){E(this,a).delete(W.id),this.unselect(W)}setActiveEditor(W){E(this,e)!==W&&(ut(this,e,W),W&&rt(this,ht,Gt).call(this,W.propertiesToUpdate))}toggleSelected(W){E(this,$).has(W)?(E(this,$).delete(W),W.unselect(),rt(this,dt,Ot).call(this,{hasSelectedEditor:this.hasSelection})):(E(this,$).add(W),W.select(),rt(this,ht,Gt).call(this,W.propertiesToUpdate),rt(this,dt,Ot).call(this,{hasSelectedEditor:!0}))}setSelected(W){for(const it of E(this,$))it!==W&&it.unselect();E(this,$).clear(),E(this,$).add(W),W.select(),rt(this,ht,Gt).call(this,W.propertiesToUpdate),rt(this,dt,Ot).call(this,{hasSelectedEditor:!0})}isSelected(W){return E(this,$).has(W)}unselect(W){W.unselect(),E(this,$).delete(W),rt(this,dt,Ot).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return E(this,$).size!==0}undo(){E(this,r).undo(),rt(this,dt,Ot).call(this,{hasSomethingToUndo:E(this,r).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:rt(this,et,Ht).call(this)})}redo(){E(this,r).redo(),rt(this,dt,Ot).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:E(this,r).hasSomethingToRedo(),isEmpty:rt(this,et,Ht).call(this)})}addCommands(W){E(this,r).add(W),rt(this,dt,Ot).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:rt(this,et,Ht).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const W=[...E(this,$)];this.addCommands({cmd:()=>{for(const it of W)it.remove()},undo:()=>{for(const it of W)rt(this,V,ne).call(this,it)},mustExec:!0})}commitOrRemove(){var W;(W=E(this,e))==null||W.commitOrRemove()}selectAll(){for(const W of E(this,$))W.commit();rt(this,gt,re).call(this,E(this,a).values())}unselectAll(){if(E(this,e))E(this,e).commitOrRemove();else if(E(this,$).size!==0){for(const W of E(this,$))W.unselect();E(this,$).clear(),rt(this,dt,Ot).call(this,{hasSelectedEditor:!1})}}isActive(W){return E(this,e)===W}getActive(){return E(this,e)}getMode(){return E(this,I)}};let h=lt;e=new WeakMap,a=new WeakMap,t=new WeakMap,r=new WeakMap,b=new WeakMap,y=new WeakMap,F=new WeakMap,S=new WeakMap,x=new WeakMap,I=new WeakMap,$=new WeakMap,K=new WeakMap,j=new WeakMap,f=new WeakMap,l=new WeakMap,T=new WeakMap,R=new WeakMap,O=new WeakMap,B=new WeakMap,P=new WeakSet,Ce=function(){E(this,B).addEventListener("keydown",E(this,l))},G=new WeakSet,ie=function(){E(this,B).removeEventListener("keydown",E(this,l))},J=new WeakSet,Ee=function(){document.addEventListener("copy",E(this,K)),document.addEventListener("cut",E(this,j)),document.addEventListener("paste",E(this,f))},at=new WeakSet,Te=function(){document.removeEventListener("copy",E(this,K)),document.removeEventListener("cut",E(this,j)),document.removeEventListener("paste",E(this,f))},dt=new WeakSet,Ot=function(W){Object.entries(W).some(([it,_t])=>E(this,O)[it]!==_t)&&E(this,F).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(E(this,O),W)})},ht=new WeakSet,Gt=function(W){E(this,F).dispatch("annotationeditorparamschanged",{source:this,details:W})},g=new WeakSet,we=function(){if(!E(this,x)){ut(this,x,!0);for(const W of E(this,t).values())W.enable()}},M=new WeakSet,Pe=function(){if(this.unselectAll(),E(this,x)){ut(this,x,!1);for(const W of E(this,t).values())W.disable()}},V=new WeakSet,ne=function(W){const it=E(this,t).get(W.pageIndex);it?it.addOrRebuild(W):this.addEditor(W)},et=new WeakSet,Ht=function(){if(E(this,a).size===0)return!0;if(E(this,a).size===1)for(const W of E(this,a).values())return W.isEmpty();return!1},gt=new WeakSet,re=function(W){E(this,$).clear();for(const it of W)it.isEmpty()||(E(this,$).add(it),it.select());rt(this,dt,Ot).call(this,{hasSelectedEditor:!0})},wt(h,"_keyboardManager",new N([[["ctrl+a","mac+meta+a"],lt.prototype.selectAll],[["ctrl+z","mac+meta+z"],lt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],lt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],lt.prototype.delete],[["Escape","mac+Escape"],lt.prototype.unselectAll]])),p.AnnotationEditorUIManager=h},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.StatTimer=p.RenderingCancelledException=p.PixelsPerInch=p.PageViewport=p.PDFDateString=p.DOMStandardFontDataFactory=p.DOMSVGFactory=p.DOMCanvasFactory=p.DOMCMapReaderFactory=p.AnnotationPrefix=void 0,p.deprecated=function(e){console.log("Deprecated API usage: "+e)},p.getColorValues=function(e){const a=document.createElement("span");a.style.visibility="hidden",document.body.append(a);for(const t of e.keys()){a.style.color=t;const r=window.getComputedStyle(a).color;e.set(t,s(r))}a.remove()},p.getCurrentTransform=function(e){const{a,b:t,c:r,d:b,e:y,f:F}=e.getTransform();return[a,t,r,b,y,F]},p.getCurrentTransformInverse=function(e){const{a,b:t,c:r,d:b,e:y,f:F}=e.getTransform().invertSelf();return[a,t,r,b,y,F]},p.getFilenameFromUrl=function(e){const a=e.indexOf("#"),t=e.indexOf("?"),r=Math.min(a>0?a:e.length,t>0?t:e.length);return e.substring(e.lastIndexOf("/",r)+1,r)},p.getPdfFilenameFromUrl=function(e,a="document.pdf"){if(typeof e!="string")return a;if(L(e))return(0,v.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),a;const t=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let b=t.exec(r[1])||t.exec(r[2])||t.exec(r[3]);if(b&&(b=b[0],b.includes("%")))try{b=t.exec(decodeURIComponent(b))[0]}catch{}return b||a},p.getRGB=s,p.getXfaPageViewport=function(e,{scale:a=1,rotation:t=0}){const{width:r,height:b}=e.attributes.style,y=[0,0,parseInt(r),parseInt(b)];return new d({viewBox:y,scale:a,rotation:t})},p.isDataScheme=L,p.isPdfFile=function(e){return typeof e=="string"&&/\.pdf$/i.test(e)},p.isValidFetchUrl=m,p.loadScript=function(e,a=!1){return new Promise((t,r)=>{const b=document.createElement("script");b.src=e,b.onload=function(y){a&&b.remove(),t(y)},b.onerror=function(){r(new Error(`Cannot load script at: ${b.src}`))},(document.head||document.documentElement).append(b)})};var _=H(7),v=H(1);p.AnnotationPrefix="pdfjs_internal_id_";const n=class{};let k=n;wt(k,"CSS",96),wt(k,"PDF",72),wt(k,"PDF_TO_CSS_UNITS",n.CSS/n.PDF),p.PixelsPerInch=k;class q extends _.BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}_createCanvas(e,a){const t=this._document.createElement("canvas");return t.width=e,t.height=a,t}}p.DOMCanvasFactory=q;async function N(i,e=!1){if(m(i,document.baseURI)){const a=await fetch(i);if(!a.ok)throw new Error(a.statusText);return e?new Uint8Array(await a.arrayBuffer()):(0,v.stringToBytes)(await a.text())}return new Promise((a,t)=>{const r=new XMLHttpRequest;r.open("GET",i,!0),e&&(r.responseType="arraybuffer"),r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){let b;if(e&&r.response?b=new Uint8Array(r.response):!e&&r.responseText&&(b=(0,v.stringToBytes)(r.responseText)),b){a(b);return}}t(new Error(r.statusText))}},r.send(null)})}class A extends _.BaseCMapReaderFactory{_fetchData(e,a){return N(e,this.isCompressed).then(t=>({cMapData:t,compressionType:a}))}}p.DOMCMapReaderFactory=A;class h extends _.BaseStandardFontDataFactory{_fetchData(e){return N(e,!0)}}p.DOMStandardFontDataFactory=h;class u extends _.BaseSVGFactory{_createSVG(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}}p.DOMSVGFactory=u;class d{constructor({viewBox:e,scale:a,rotation:t,offsetX:r=0,offsetY:b=0,dontFlip:y=!1}){this.viewBox=e,this.scale=a,this.rotation=t,this.offsetX=r,this.offsetY=b;const F=(e[2]+e[0])/2,S=(e[3]+e[1])/2;let x,I,$,K,j,f,l,T;switch((t%=360)<0&&(t+=360),t){case 180:x=-1,I=0,$=0,K=1;break;case 90:x=0,I=1,$=1,K=0;break;case 270:x=0,I=-1,$=-1,K=0;break;case 0:x=1,I=0,$=0,K=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}y&&($=-$,K=-K),x===0?(j=Math.abs(S-e[1])*a+r,f=Math.abs(F-e[0])*a+b,l=Math.abs(e[3]-e[1])*a,T=Math.abs(e[2]-e[0])*a):(j=Math.abs(F-e[0])*a+r,f=Math.abs(S-e[1])*a+b,l=Math.abs(e[2]-e[0])*a,T=Math.abs(e[3]-e[1])*a),this.transform=[x*a,I*a,$*a,K*a,j-x*a*F-$*a*S,f-I*a*F-K*a*S],this.width=l,this.height=T}clone({scale:e=this.scale,rotation:a=this.rotation,offsetX:t=this.offsetX,offsetY:r=this.offsetY,dontFlip:b=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:e,rotation:a,offsetX:t,offsetY:r,dontFlip:b})}convertToViewportPoint(e,a){return v.Util.applyTransform([e,a],this.transform)}convertToViewportRectangle(e){const a=v.Util.applyTransform([e[0],e[1]],this.transform),t=v.Util.applyTransform([e[2],e[3]],this.transform);return[a[0],a[1],t[0],t[1]]}convertToPdfPoint(e,a){return v.Util.applyInverseTransform([e,a],this.transform)}}p.PageViewport=d;class C extends v.BaseException{constructor(e,a){super(e,"RenderingCancelledException"),this.type=a}}p.RenderingCancelledException=C;function L(i){const e=i.length;let a=0;for(;a<e&&i[a].trim()==="";)a++;return i.substring(a,a+5).toLowerCase()==="data:"}p.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(e){e in this.started&&(0,v.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,v.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let a=0;for(const t of this.times){const r=t.name;r.length>a&&(a=r.length)}for(const t of this.times){const r=t.end-t.start;e.push(`${t.name.padEnd(a)} ${r}ms
`)}return e.join("")}};function m(i,e){try{const{protocol:a}=e?new URL(i,e):new URL(i);return a==="http:"||a==="https:"}catch{return!1}}let o;p.PDFDateString=class{static toDateObject(e){if(!e||typeof e!="string")return null;o||(o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const a=o.exec(e);if(!a)return null;const t=parseInt(a[1],10);let r=parseInt(a[2],10);r=r>=1&&r<=12?r-1:0;let b=parseInt(a[3],10);b=b>=1&&b<=31?b:1;let y=parseInt(a[4],10);y=y>=0&&y<=23?y:0;let F=parseInt(a[5],10);F=F>=0&&F<=59?F:0;let S=parseInt(a[6],10);S=S>=0&&S<=59?S:0;const x=a[7]||"Z";let I=parseInt(a[8],10);I=I>=0&&I<=23?I:0;let $=parseInt(a[9],10)||0;return $=$>=0&&$<=59?$:0,x==="-"?(y+=I,F+=$):x==="+"&&(y-=I,F-=$),new Date(Date.UTC(t,r,b,y,F,S))}};function s(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):((0,v.warn)(`Not a valid color format: "${i}"`),[0,0,0])}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.BaseStandardFontDataFactory=p.BaseSVGFactory=p.BaseCanvasFactory=p.BaseCMapReaderFactory=void 0;var _=H(1);class v{constructor(){this.constructor===v&&(0,_.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,u){if(h<=0||u<=0)throw new Error("Invalid canvas size");const d=this._createCanvas(h,u);return{canvas:d,context:d.getContext("2d")}}reset(h,u,d){if(!h.canvas)throw new Error("Canvas is not specified");if(u<=0||d<=0)throw new Error("Invalid canvas size");h.canvas.width=u,h.canvas.height=d}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,u){(0,_.unreachable)("Abstract method `_createCanvas` called.")}}p.BaseCanvasFactory=v;class k{constructor({baseUrl:h=null,isCompressed:u=!1}){this.constructor===k&&(0,_.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=u}async fetch({name:h}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const u=this.baseUrl+h+(this.isCompressed?".bcmap":""),d=this.isCompressed?_.CMapCompressionType.BINARY:_.CMapCompressionType.NONE;return this._fetchData(u,d).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${u}`)})}_fetchData(h,u){(0,_.unreachable)("Abstract method `_fetchData` called.")}}p.BaseCMapReaderFactory=k;class q{constructor({baseUrl:h=null}){this.constructor===q&&(0,_.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch({filename:h}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const u=`${this.baseUrl}${h}`;return this._fetchData(u).catch(d=>{throw new Error(`Unable to load font data at: ${u}`)})}_fetchData(h){(0,_.unreachable)("Abstract method `_fetchData` called.")}}p.BaseStandardFontDataFactory=q;class N{constructor(){this.constructor===N&&(0,_.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,u,d=!1){if(h<=0||u<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),d||(C.setAttribute("width",`${h}px`),C.setAttribute("height",`${u}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${h} ${u}`),C}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,_.unreachable)("Abstract method `_createSVG` called.")}}p.BaseSVGFactory=N},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.MurmurHash3_64=void 0;var _=H(1);const v=3285377520,k=4294901760,q=65535;p.MurmurHash3_64=class{constructor(A){this.h1=A?4294967295&A:v,this.h2=A?4294967295&A:v}update(A){let h,u;if(typeof A=="string"){h=new Uint8Array(2*A.length),u=0;for(let r=0,b=A.length;r<b;r++){const y=A.charCodeAt(r);y<=255?h[u++]=y:(h[u++]=y>>>8,h[u++]=255&y)}}else{if(!(0,_.isArrayBuffer)(A))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");h=A.slice(),u=h.byteLength}const d=u>>2,C=u-4*d,L=new Uint32Array(h.buffer,0,d);let m=0,o=0,s=this.h1,n=this.h2;const i=3432918353,e=461845907,a=11601,t=13715;for(let r=0;r<d;r++)1&r?(m=L[r],m=m*i&k|m*a&q,m=m<<15|m>>>17,m=m*e&k|m*t&q,s^=m,s=s<<13|s>>>19,s=5*s+3864292196):(o=L[r],o=o*i&k|o*a&q,o=o<<15|o>>>17,o=o*e&k|o*t&q,n^=o,n=n<<13|n>>>19,n=5*n+3864292196);switch(m=0,C){case 3:m^=h[4*d+2]<<16;case 2:m^=h[4*d+1]<<8;case 1:m^=h[4*d],m=m*i&k|m*a&q,m=m<<15|m>>>17,m=m*e&k|m*t&q,1&d?s^=m:n^=m}this.h1=s,this.h2=n}hexdigest(){let A=this.h1,h=this.h2;A^=h>>>1,A=3981806797*A&k|36045*A&q,h=4283543511*h&k|(2950163797*(h<<16|A>>>16)&k)>>>16,A^=h>>>1,A=444984403*A&k|60499*A&q,h=3301882366*h&k|(3120437893*(h<<16|A>>>16)&k)>>>16,A^=h>>>1;const u=(A>>>0).toString(16),d=(h>>>0).toString(16);return u.padStart(8,"0")+d.padStart(8,"0")}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.FontLoader=p.FontFaceObject=void 0;var _=H(1);p.FontLoader=class{constructor({onUnsupportedFeature:k,ownerDocument:q=globalThis.document,styleElement:N=null}){this._onUnsupportedFeature=k,this._document=q,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.push(k),this._document.fonts.add(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const q=this.styleElement.sheet;q.insertRule(k,q.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(k){if(k.attached||k.missingFile)return;if(k.attached=!0,this.isFontLoadingAPISupported){const N=k.createNativeFontFace();if(N){this.addNativeFontFace(N);try{await N.loaded}catch(A){throw this._onUnsupportedFeature({featureId:_.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,_.warn)(`Failed to load font '${N.family}': '${A}'.`),k.disableFontFace=!0,A}}return}const q=k.createFontFaceRule();if(q){if(this.insertRule(q),this.isSyncFontLoadingSupported)return;await new Promise(N=>{const A=this._queueLoadingCallback(N);this._prepareFontLoadEvent(k,A)})}}get isFontLoadingAPISupported(){var q;const k=!!((q=this._document)!=null&&q.fonts);return(0,_.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){var q;let k=!1;return(typeof navigator>"u"||((q=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent))==null?void 0:q[1])>=14)&&(k=!0),(0,_.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){const{loadingRequests:q}=this,N={done:!1,complete:function(){for((0,_.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;q.length>0&&q[0].done;){const h=q.shift();setTimeout(h.callback,0)}},callback:k};return q.push(N),N}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,_.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,q){function N(a,t){return a.charCodeAt(t)<<24|a.charCodeAt(t+1)<<16|a.charCodeAt(t+2)<<8|255&a.charCodeAt(t+3)}function A(a,t,r,b){return a.substring(0,t)+b+a.substring(t+r)}let h,u;const d=this._document.createElement("canvas");d.width=1,d.height=1;const C=d.getContext("2d");let L=0;const m=`lt${Date.now()}${this.loadTestFontId++}`;let o=this._loadTestFont;o=A(o,976,m.length,m);const s=1482184792;let n=N(o,16);for(h=0,u=m.length-3;h<u;h+=4)n=n-s+N(m,h)|0;h<m.length&&(n=n-s+N(m+"XXX",h)|0),o=A(o,16,4,(0,_.string32)(n));const i=`@font-face {font-family:"${m}";src:${`url(data:font/opentype;base64,${btoa(o)});`}}`;this.insertRule(i);const e=this._document.createElement("div");e.style.visibility="hidden",e.style.width=e.style.height="10px",e.style.position="absolute",e.style.top=e.style.left="0px";for(const a of[k.loadedName,m]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=a,e.append(t)}this._document.body.append(e),function a(t,r){if(++L>30){(0,_.warn)("Load test font never loaded."),r();return}C.font="30px "+t,C.fillText(".",0,20),C.getImageData(0,0,1,1).data[3]>0?r():setTimeout(a.bind(null,t,r))}(m,()=>{e.remove(),q.complete()})}},p.FontFaceObject=class{constructor(k,{isEvalSupported:q=!0,disableFontFace:N=!1,ignoreErrors:A=!1,onUnsupportedFeature:h,fontRegistry:u=null}){this.compiledGlyphs=Object.create(null);for(const d in k)this[d]=k[d];this.isEvalSupported=q!==!1,this.disableFontFace=N===!0,this.ignoreErrors=A===!0,this._onUnsupportedFeature=h,this.fontRegistry=u}createNativeFontFace(){var q;if(!this.data||this.disableFontFace)return null;let k;if(this.cssFontInfo){const N={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(N.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,N)}else k=new FontFace(this.loadedName,this.data,{});return(q=this.fontRegistry)==null||q.registerFont(this),k}createFontFaceRule(){var A;if(!this.data||this.disableFontFace)return null;const k=(0,_.bytesToString)(this.data),q=`url(data:${this.mimetype};base64,${btoa(k)});`;let N;if(this.cssFontInfo){let h=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(h+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),N=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${h}src:${q}}`}else N=`@font-face {font-family:"${this.loadedName}";src:${q}}`;return(A=this.fontRegistry)==null||A.registerFont(this,q),N}getPathGenerator(k,q){if(this.compiledGlyphs[q]!==void 0)return this.compiledGlyphs[q];let N;try{N=k.get(this.loadedName+"_path_"+q)}catch(A){if(!this.ignoreErrors)throw A;return this._onUnsupportedFeature({featureId:_.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,_.warn)(`getPathGenerator - ignoring character: "${A}".`),this.compiledGlyphs[q]=function(h,u){}}if(this.isEvalSupported&&_.FeatureTest.isEvalSupported){const A=[];for(const h of N){const u=h.args!==void 0?h.args.join(","):"";A.push("c.",h.cmd,"(",u,`);
`)}return this.compiledGlyphs[q]=new Function("c","size",A.join(""))}return this.compiledGlyphs[q]=function(A,h){for(const u of N)u.cmd==="scale"&&(u.args=[h,-h]),A[u.cmd].apply(A,u.args)}}}},(Y,p,H)=>{var I,ae;Object.defineProperty(p,"__esModule",{value:!0}),p.CanvasGraphics=void 0;var _=H(1),v=H(6),k=H(11),q=H(13),N=H(12);const A=4096,h=N.isNodeJS&&typeof Path2D>"u"?-1:1e3,u=16;class d{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,l,T){let R;return this.cache[f]!==void 0?(R=this.cache[f],this.canvasFactory.reset(R,l,T)):(R=this.canvasFactory.create(l,T),this.cache[f]=R),R}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const l=this.cache[f];this.canvasFactory.destroy(l),delete this.cache[f]}}}function C(j,f,l,T,R,O,B,P,z,G){const[U,J,Q,at,X,dt]=(0,v.getCurrentTransform)(j);if(J===0&&Q===0){const pt=B*U+X,ht=Math.round(pt),c=P*at+dt,g=Math.round(c),w=(B+z)*U+X,M=Math.abs(Math.round(w)-ht)||1,D=(P+G)*at+dt,V=Math.abs(Math.round(D)-g)||1;return j.setTransform(Math.sign(U),0,0,Math.sign(at),ht,g),j.drawImage(f,l,T,R,O,0,0,M,V),j.setTransform(U,J,Q,at,X,dt),[M,V]}if(U===0&&at===0){const pt=P*Q+X,ht=Math.round(pt),c=B*J+dt,g=Math.round(c),w=(P+G)*Q+X,M=Math.abs(Math.round(w)-ht)||1,D=(B+z)*J+dt,V=Math.abs(Math.round(D)-g)||1;return j.setTransform(0,Math.sign(J),Math.sign(Q),0,ht,g),j.drawImage(f,l,T,R,O,0,0,V,M),j.setTransform(U,J,Q,at,X,dt),[V,M]}return j.drawImage(f,l,T,R,O,B,P,z,G),[Math.hypot(U,J)*z,Math.hypot(Q,at)*G]}class L{constructor(f,l){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=_.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,f,l])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,l){this.x=f,this.y=l}updatePathMinMax(f,l,T){[l,T]=_.Util.applyTransform([l,T],f),this.minX=Math.min(this.minX,l),this.minY=Math.min(this.minY,T),this.maxX=Math.max(this.maxX,l),this.maxY=Math.max(this.maxY,T)}updateRectMinMax(f,l){const T=_.Util.applyTransform(l,f),R=_.Util.applyTransform(l.slice(2),f);this.minX=Math.min(this.minX,T[0],R[0]),this.minY=Math.min(this.minY,T[1],R[1]),this.maxX=Math.max(this.maxX,T[0],R[0]),this.maxY=Math.max(this.maxY,T[1],R[1])}updateScalingPathMinMax(f,l){_.Util.scaleMinMax(f,l),this.minX=Math.min(this.minX,l[0]),this.maxX=Math.max(this.maxX,l[1]),this.minY=Math.min(this.minY,l[2]),this.maxY=Math.max(this.maxY,l[3])}updateCurvePathMinMax(f,l,T,R,O,B,P,z,G,U){const J=_.Util.bezierBoundingBox(l,T,R,O,B,P,z,G);U?(U[0]=Math.min(U[0],J[0],J[2]),U[1]=Math.max(U[1],J[0],J[2]),U[2]=Math.min(U[2],J[1],J[3]),U[3]=Math.max(U[3],J[1],J[3])):this.updateRectMinMax(f,J)}getPathBoundingBox(f=k.PathType.FILL,l=null){const T=[this.minX,this.minY,this.maxX,this.maxY];if(f===k.PathType.STROKE){l||(0,_.unreachable)("Stroke bounding box must include transform.");const R=_.Util.singularValueDecompose2dScale(l),O=R[0]*this.lineWidth/2,B=R[1]*this.lineWidth/2;T[0]-=O,T[1]-=B,T[2]+=O,T[3]+=B}return T}updateClipFromPath(){const f=_.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=k.PathType.FILL,l=null){return _.Util.intersect(this.clipBox,this.getPathBoundingBox(f,l))}}function m(j,f,l=null){if(typeof ImageData<"u"&&f instanceof ImageData){j.putImageData(f,0,0);return}const T=f.height,R=f.width,O=T%u,B=(T-O)/u,P=O===0?B:B+1,z=j.createImageData(R,u);let G,U=0;const J=f.data,Q=z.data;let at,X,dt,pt,ht,c,g,w;if(l)switch(l.length){case 1:ht=l[0],c=l[0],g=l[0],w=l[0];break;case 4:ht=l[0],c=l[1],g=l[2],w=l[3]}if(f.kind===_.ImageKind.GRAYSCALE_1BPP){const M=J.byteLength,D=new Uint32Array(Q.buffer,0,Q.byteLength>>2),V=D.length,ot=R+7>>3;let et=4294967295,nt=_.FeatureTest.isLittleEndian?4278190080:255;for(w&&w[0]===255&&w[255]===0&&([et,nt]=[nt,et]),at=0;at<P;at++){for(dt=at<B?u:O,G=0,X=0;X<dt;X++){const gt=M-U;let st=0;const lt=gt>ot?R:8*gt-7,ft=-8&lt;let W=0,it=0;for(;st<ft;st+=8)it=J[U++],D[G++]=128&it?et:nt,D[G++]=64&it?et:nt,D[G++]=32&it?et:nt,D[G++]=16&it?et:nt,D[G++]=8&it?et:nt,D[G++]=4&it?et:nt,D[G++]=2&it?et:nt,D[G++]=1&it?et:nt;for(;st<lt;st++)W===0&&(it=J[U++],W=128),D[G++]=it&W?et:nt,W>>=1}for(;G<V;)D[G++]=0;j.putImageData(z,0,at*u)}}else if(f.kind===_.ImageKind.RGBA_32BPP){const M=!!(ht||c||g);for(X=0,pt=R*u*4,at=0;at<B;at++){if(Q.set(J.subarray(U,U+pt)),U+=pt,M)for(let D=0;D<pt;D+=4)ht&&(Q[D+0]=ht[Q[D+0]]),c&&(Q[D+1]=c[Q[D+1]]),g&&(Q[D+2]=g[Q[D+2]]);j.putImageData(z,0,X),X+=u}if(at<P){if(pt=R*O*4,Q.set(J.subarray(U,U+pt)),M)for(let D=0;D<pt;D+=4)ht&&(Q[D+0]=ht[Q[D+0]]),c&&(Q[D+1]=c[Q[D+1]]),g&&(Q[D+2]=g[Q[D+2]]);j.putImageData(z,0,X)}}else{if(f.kind!==_.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${f.kind}`);{const M=!!(ht||c||g);for(dt=u,pt=R*dt,at=0;at<P;at++){for(at>=B&&(dt=O,pt=R*dt),G=0,X=pt;X--;)Q[G++]=J[U++],Q[G++]=J[U++],Q[G++]=J[U++],Q[G++]=255;if(M)for(let D=0;D<G;D+=4)ht&&(Q[D+0]=ht[Q[D+0]]),c&&(Q[D+1]=c[Q[D+1]]),g&&(Q[D+2]=g[Q[D+2]]);j.putImageData(z,0,at*u)}}}}function o(j,f){if(f.bitmap){j.drawImage(f.bitmap,0,0);return}const l=f.height,T=f.width,R=l%u,O=(l-R)/u,B=R===0?O:O+1,P=j.createImageData(T,u);let z=0;const G=f.data,U=P.data;for(let J=0;J<B;J++){const Q=J<O?u:R;({srcPos:z}=(0,q.applyMaskImageData)({src:G,srcPos:z,dest:U,width:T,height:Q})),j.putImageData(P,0,J*u)}}function s(j,f){const l=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const T of l)j[T]!==void 0&&(f[T]=j[T]);j.setLineDash!==void 0&&(f.setLineDash(j.getLineDash()),f.lineDashOffset=j.lineDashOffset)}function n(j,f){j.strokeStyle=j.fillStyle=f||"#000000",j.fillRule="nonzero",j.globalAlpha=1,j.lineWidth=1,j.lineCap="butt",j.lineJoin="miter",j.miterLimit=10,j.globalCompositeOperation="source-over",j.font="10px sans-serif",j.setLineDash!==void 0&&(j.setLineDash([]),j.lineDashOffset=0)}function i(j,f,l,T){const R=j.length;for(let O=3;O<R;O+=4){const B=j[O];if(B===0)j[O-3]=f,j[O-2]=l,j[O-1]=T;else if(B<255){const P=255-B;j[O-3]=j[O-3]*B+f*P>>8,j[O-2]=j[O-2]*B+l*P>>8,j[O-1]=j[O-1]*B+T*P>>8}}}function e(j,f,l){const T=j.length;for(let R=3;R<T;R+=4){const O=l?l[j[R]]:j[R];f[R]=f[R]*O*.00392156862745098|0}}function a(j,f,l){const T=j.length;for(let R=3;R<T;R+=4){const O=77*j[R-3]+152*j[R-2]+28*j[R-1];f[R]=l?f[R]*l[O>>8]>>8:f[R]*O>>16}}function t(j,f,l,T){const R=T[0],O=T[1],B=T[2]-R,P=T[3]-O;B!==0&&P!==0&&(function(G,U,J,Q,at,X,dt,pt,ht,c,g){const w=!!X,M=w?X[0]:0,D=w?X[1]:0,V=w?X[2]:0;let ot;ot=at==="Luminosity"?a:e;const et=Math.min(Q,Math.ceil(1048576/J));for(let nt=0;nt<Q;nt+=et){const gt=Math.min(et,Q-nt),st=G.getImageData(pt-c,nt+(ht-g),J,gt),lt=U.getImageData(pt,nt+ht,J,gt);w&&i(st.data,M,D,V),ot(st.data,lt.data,dt),U.putImageData(lt,pt,nt+ht)}}(f.context,l,B,P,f.subtype,f.backdrop,f.transferMap,R,O,f.offsetX,f.offsetY),j.save(),j.globalAlpha=1,j.globalCompositeOperation="source-over",j.setTransform(1,0,0,1,0,0),j.drawImage(l.canvas,0,0),j.restore())}function r(j,f){const l=_.Util.singularValueDecompose2dScale(j);l[0]=Math.fround(l[0]),l[1]=Math.fround(l[1]);const T=Math.fround((globalThis.devicePixelRatio||1)*v.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:l[0]<=T||l[1]<=T}const b=["butt","round","square"],y=["miter","round","bevel"],F={},S={},K=class{constructor(f,l,T,R,O,B,P){Z(this,I);this.ctx=f,this.current=new L(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=l,this.objs=T,this.canvasFactory=R,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=O,this.cachedCanvases=new d(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=B,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(P==null?void 0:P.background)||null,this.foregroundColor=(P==null?void 0:P.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,l=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):l}beginDrawing({transform:f,viewport:l,transparency:T=!1,background:R=null}){const O=this.ctx.canvas.width,B=this.ctx.canvas.height,P=R||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const z=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const G=this.backgroundColor=this.ctx.fillStyle;let U=!0,J=P;if(this.ctx.fillStyle=P,J=this.ctx.fillStyle,U=typeof J=="string"&&/^#[0-9A-Fa-f]{6}$/.test(J),z==="#000000"&&G==="#ffffff"||z===G||!U)this.foregroundColor=this.backgroundColor=null;else{const[Q,at,X]=(0,v.getRGB)(J),dt=ht=>(ht/=255)<=.03928?ht/12.92:((ht+.055)/1.055)**2.4,pt=Math.round(.2126*dt(Q)+.7152*dt(at)+.0722*dt(X));this.selectColor=(ht,c,g)=>{const w=.2126*dt(ht)+.7152*dt(c)+.0722*dt(g);return Math.round(w)===pt?G:z}}}if(this.ctx.fillStyle=this.backgroundColor||P,this.ctx.fillRect(0,0,O,B),this.ctx.restore(),T){const z=this.cachedCanvases.getCanvas("transparent",O,B);this.compositeCtx=this.ctx,this.transparentCanvas=z.canvas,this.ctx=z.context,this.ctx.save(),this.ctx.transform(...(0,v.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),n(this.ctx,this.foregroundColor),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...l.transform),this.viewportScale=l.scale,this.baseTransform=(0,v.getCurrentTransform)(this.ctx)}executeOperatorList(f,l,T,R){const O=f.argsArray,B=f.fnArray;let P=l||0;const z=O.length;if(z===P)return P;const G=z-P>10&&typeof T=="function",U=G?Date.now()+15:0;let J=0;const Q=this.commonObjs,at=this.objs;let X;for(;;){if(R!==void 0&&P===R.nextBreakPoint)return R.breakIt(P,T),P;if(X=B[P],X!==_.OPS.dependency)this[X].apply(this,O[P]);else for(const dt of O[P]){const pt=dt.startsWith("g_")?Q:at;if(!pt.has(dt))return pt.get(dt,T),P}if(P++,P===z)return P;if(G&&++J>10){if(Date.now()>U)return T(),P;J=0}}}endDrawing(){rt(this,I,ae).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const l of f.values())typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement&&(l.width=l.height=0);f.clear()}this._cachedBitmapsMap.clear()}_scaleImage(f,l){const T=f.width,R=f.height;let O,B,P=Math.max(Math.hypot(l[0],l[1]),1),z=Math.max(Math.hypot(l[2],l[3]),1),G=T,U=R,J="prescale1";for(;P>2&&G>1||z>2&&U>1;){let Q=G,at=U;P>2&&G>1&&(Q=Math.ceil(G/2),P/=G/Q),z>2&&U>1&&(at=Math.ceil(U/2),z/=U/at),O=this.cachedCanvases.getCanvas(J,Q,at),B=O.context,B.clearRect(0,0,Q,at),B.drawImage(f,0,0,G,U,0,0,Q,at),f=O.canvas,G=Q,U=at,J=J==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:G,paintHeight:U}}_createMaskCanvas(f){const l=this.ctx,{width:T,height:R}=f,O=this.current.fillColor,B=this.current.patternFill,P=(0,v.getCurrentTransform)(l);let z,G,U,J;if((f.bitmap||f.data)&&f.count>1){const V=f.bitmap||f.data.buffer;G=JSON.stringify(B?P:[P.slice(0,4),O]),z=this._cachedBitmapsMap.get(V),z||(z=new Map,this._cachedBitmapsMap.set(V,z));const ot=z.get(G);if(ot&&!B)return{canvas:ot,offsetX:Math.round(Math.min(P[0],P[2])+P[4]),offsetY:Math.round(Math.min(P[1],P[3])+P[5])};U=ot}U||(J=this.cachedCanvases.getCanvas("maskCanvas",T,R),o(J.context,f));let Q=_.Util.transform(P,[1/T,0,0,-1/R,0,0]);Q=_.Util.transform(Q,[1,0,0,1,0,-R]);const at=_.Util.applyTransform([0,0],Q),X=_.Util.applyTransform([T,R],Q),dt=_.Util.normalizeRect([at[0],at[1],X[0],X[1]]),pt=Math.round(dt[2]-dt[0])||1,ht=Math.round(dt[3]-dt[1])||1,c=this.cachedCanvases.getCanvas("fillCanvas",pt,ht),g=c.context,w=Math.min(at[0],X[0]),M=Math.min(at[1],X[1]);g.translate(-w,-M),g.transform(...Q),U||(U=this._scaleImage(J.canvas,(0,v.getCurrentTransformInverse)(g)),U=U.img,z&&B&&z.set(G,U)),g.imageSmoothingEnabled=r((0,v.getCurrentTransform)(g),f.interpolate),C(g,U,0,0,U.width,U.height,0,0,T,R),g.globalCompositeOperation="source-in";const D=_.Util.transform((0,v.getCurrentTransformInverse)(g),[1,0,0,1,-w,-M]);return g.fillStyle=B?O.getPattern(l,this,D,k.PathType.FILL):O,g.fillRect(0,0,T,R),z&&!B&&(this.cachedCanvases.delete("fillCanvas"),z.set(G,c.canvas)),{canvas:c.canvas,offsetX:Math.round(w),offsetY:Math.round(M)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=b[f]}setLineJoin(f){this.ctx.lineJoin=y[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,l){const T=this.ctx;T.setLineDash!==void 0&&(T.setLineDash(f),T.lineDashOffset=l)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[l,T]of f)switch(l){case"LW":this.setLineWidth(T);break;case"LC":this.setLineCap(T);break;case"LJ":this.setLineJoin(T);break;case"ML":this.setMiterLimit(T);break;case"D":this.setDash(T[0],T[1]);break;case"RI":this.setRenderingIntent(T);break;case"FL":this.setFlatness(T);break;case"Font":this.setFont(T[0],T[1]);break;case"CA":this.current.strokeAlpha=T;break;case"ca":this.current.fillAlpha=T,this.ctx.globalAlpha=T;break;case"BM":this.ctx.globalCompositeOperation=T;break;case"SMask":this.current.activeSMask=T?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=T}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,l=this.ctx.canvas.height,T="smaskGroupAt"+this.groupLevel,R=this.cachedCanvases.getCanvas(T,f,l);this.suspendedCtx=this.ctx,this.ctx=R.context;const O=this.ctx;O.setTransform(...(0,v.getCurrentTransform)(this.suspendedCtx)),s(this.suspendedCtx,O),function(P,z){if(P._removeMirroring)throw new Error("Context is already forwarding operations.");P.__originalSave=P.save,P.__originalRestore=P.restore,P.__originalRotate=P.rotate,P.__originalScale=P.scale,P.__originalTranslate=P.translate,P.__originalTransform=P.transform,P.__originalSetTransform=P.setTransform,P.__originalResetTransform=P.resetTransform,P.__originalClip=P.clip,P.__originalMoveTo=P.moveTo,P.__originalLineTo=P.lineTo,P.__originalBezierCurveTo=P.bezierCurveTo,P.__originalRect=P.rect,P.__originalClosePath=P.closePath,P.__originalBeginPath=P.beginPath,P._removeMirroring=()=>{P.save=P.__originalSave,P.restore=P.__originalRestore,P.rotate=P.__originalRotate,P.scale=P.__originalScale,P.translate=P.__originalTranslate,P.transform=P.__originalTransform,P.setTransform=P.__originalSetTransform,P.resetTransform=P.__originalResetTransform,P.clip=P.__originalClip,P.moveTo=P.__originalMoveTo,P.lineTo=P.__originalLineTo,P.bezierCurveTo=P.__originalBezierCurveTo,P.rect=P.__originalRect,P.closePath=P.__originalClosePath,P.beginPath=P.__originalBeginPath,delete P._removeMirroring},P.save=function(){z.save(),this.__originalSave()},P.restore=function(){z.restore(),this.__originalRestore()},P.translate=function(U,J){z.translate(U,J),this.__originalTranslate(U,J)},P.scale=function(U,J){z.scale(U,J),this.__originalScale(U,J)},P.transform=function(U,J,Q,at,X,dt){z.transform(U,J,Q,at,X,dt),this.__originalTransform(U,J,Q,at,X,dt)},P.setTransform=function(U,J,Q,at,X,dt){z.setTransform(U,J,Q,at,X,dt),this.__originalSetTransform(U,J,Q,at,X,dt)},P.resetTransform=function(){z.resetTransform(),this.__originalResetTransform()},P.rotate=function(U){z.rotate(U),this.__originalRotate(U)},P.clip=function(U){z.clip(U),this.__originalClip(U)},P.moveTo=function(G,U){z.moveTo(G,U),this.__originalMoveTo(G,U)},P.lineTo=function(G,U){z.lineTo(G,U),this.__originalLineTo(G,U)},P.bezierCurveTo=function(G,U,J,Q,at,X){z.bezierCurveTo(G,U,J,Q,at,X),this.__originalBezierCurveTo(G,U,J,Q,at,X)},P.rect=function(G,U,J,Q){z.rect(G,U,J,Q),this.__originalRect(G,U,J,Q)},P.closePath=function(){z.closePath(),this.__originalClosePath()},P.beginPath=function(){z.beginPath(),this.__originalBeginPath()}}(O,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),s(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const l=this.current.activeSMask;t(this.suspendedCtx,l,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(s(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),s(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(f,l,T,R,O,B){this.ctx.transform(f,l,T,R,O,B),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(f,l,T){const R=this.ctx,O=this.current;let B,P,z=O.x,G=O.y;const U=(0,v.getCurrentTransform)(R),J=U[0]===0&&U[3]===0||U[1]===0&&U[2]===0,Q=J?T.slice(0):null;for(let at=0,X=0,dt=f.length;at<dt;at++)switch(0|f[at]){case _.OPS.rectangle:z=l[X++],G=l[X++];const pt=l[X++],ht=l[X++],c=z+pt,g=G+ht;R.moveTo(z,G),pt===0||ht===0?R.lineTo(c,g):(R.lineTo(c,G),R.lineTo(c,g),R.lineTo(z,g)),J||O.updateRectMinMax(U,[z,G,c,g]),R.closePath();break;case _.OPS.moveTo:z=l[X++],G=l[X++],R.moveTo(z,G),J||O.updatePathMinMax(U,z,G);break;case _.OPS.lineTo:z=l[X++],G=l[X++],R.lineTo(z,G),J||O.updatePathMinMax(U,z,G);break;case _.OPS.curveTo:B=z,P=G,z=l[X+4],G=l[X+5],R.bezierCurveTo(l[X],l[X+1],l[X+2],l[X+3],z,G),O.updateCurvePathMinMax(U,B,P,l[X],l[X+1],l[X+2],l[X+3],z,G,Q),X+=6;break;case _.OPS.curveTo2:B=z,P=G,R.bezierCurveTo(z,G,l[X],l[X+1],l[X+2],l[X+3]),O.updateCurvePathMinMax(U,B,P,z,G,l[X],l[X+1],l[X+2],l[X+3],Q),z=l[X+2],G=l[X+3],X+=4;break;case _.OPS.curveTo3:B=z,P=G,z=l[X+2],G=l[X+3],R.bezierCurveTo(l[X],l[X+1],z,G,z,G),O.updateCurvePathMinMax(U,B,P,l[X],l[X+1],z,G,z,G,Q),X+=4;break;case _.OPS.closePath:R.closePath()}J&&O.updateScalingPathMinMax(U,Q),O.setCurrentPoint(z,G)}closePath(){this.ctx.closePath()}stroke(f){f=f===void 0||f;const l=this.ctx,T=this.current.strokeColor;l.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof T=="object"&&(T==null?void 0:T.getPattern)?(l.save(),l.strokeStyle=T.getPattern(l,this,(0,v.getCurrentTransformInverse)(l),k.PathType.STROKE),this.rescaleAndStroke(!1),l.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),l.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f){f=f===void 0||f;const l=this.ctx,T=this.current.fillColor;let R=!1;this.current.patternFill&&(l.save(),l.fillStyle=T.getPattern(l,this,(0,v.getCurrentTransformInverse)(l),k.PathType.FILL),R=!0);const O=this.current.getClippedPathBoundingBox();this.contentVisible&&O!==null&&(this.pendingEOFill?(l.fill("evenodd"),this.pendingEOFill=!1):l.fill()),R&&l.restore(),f&&this.consumePath(O)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=F}eoClip(){this.pendingClip=S}beginText(){this.current.textMatrix=_.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,l=this.ctx;if(f!==void 0){l.save(),l.beginPath();for(const T of f)l.setTransform(...T.transform),l.translate(T.x,T.y),T.addToPath(l,T.fontSize);l.restore(),l.clip(),l.beginPath(),delete this.pendingTextPaths}else l.beginPath()}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,l){const T=this.commonObjs.get(f),R=this.current;if(!T)throw new Error(`Can't find font for ${f}`);if(R.fontMatrix=T.fontMatrix||_.FONT_IDENTITY_MATRIX,R.fontMatrix[0]!==0&&R.fontMatrix[3]!==0||(0,_.warn)("Invalid font matrix for font "+f),l<0?(l=-l,R.fontDirection=-1):R.fontDirection=1,this.current.font=T,this.current.fontSize=l,T.isType3Font)return;const O=T.loadedName||"sans-serif";let B="normal";T.black?B="900":T.bold&&(B="bold");const P=T.italic?"italic":"normal",z=`"${O}", ${T.fallbackName}`;let G=l;l<16?G=16:l>100&&(G=100),this.current.fontSizeScale=l/G,this.ctx.font=`${P} ${B} ${G}px ${z}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,l){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=l}setLeadingMoveText(f,l){this.setLeading(-l),this.moveText(f,l)}setTextMatrix(f,l,T,R,O,B){this.current.textMatrix=[f,l,T,R,O,B],this.current.textMatrixScale=Math.hypot(f,l),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,l,T,R){const O=this.ctx,B=this.current,P=B.font,z=B.textRenderingMode,G=B.fontSize/B.fontSizeScale,U=z&_.TextRenderingMode.FILL_STROKE_MASK,J=!!(z&_.TextRenderingMode.ADD_TO_PATH_FLAG),Q=B.patternFill&&!P.missingFile;let at;(P.disableFontFace||J||Q)&&(at=P.getPathGenerator(this.commonObjs,f)),P.disableFontFace||Q?(O.save(),O.translate(l,T),O.beginPath(),at(O,G),R&&O.setTransform(...R),U!==_.TextRenderingMode.FILL&&U!==_.TextRenderingMode.FILL_STROKE||O.fill(),U!==_.TextRenderingMode.STROKE&&U!==_.TextRenderingMode.FILL_STROKE||O.stroke(),O.restore()):(U!==_.TextRenderingMode.FILL&&U!==_.TextRenderingMode.FILL_STROKE||O.fillText(f,l,T),U!==_.TextRenderingMode.STROKE&&U!==_.TextRenderingMode.FILL_STROKE||O.strokeText(f,l,T)),J&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,v.getCurrentTransform)(O),x:l,y:T,fontSize:G,addToPath:at})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const l=f.getImageData(0,0,10,10).data;let T=!1;for(let R=3;R<l.length;R+=4)if(l[R]>0&&l[R]<255){T=!0;break}return(0,_.shadow)(this,"isFontSubpixelAAEnabled",T)}showText(f){const l=this.current,T=l.font;if(T.isType3Font)return this.showType3Text(f);const R=l.fontSize;if(R===0)return;const O=this.ctx,B=l.fontSizeScale,P=l.charSpacing,z=l.wordSpacing,G=l.fontDirection,U=l.textHScale*G,J=f.length,Q=T.vertical,at=Q?1:-1,X=T.defaultVMetrics,dt=R*l.fontMatrix[0],pt=l.textRenderingMode===_.TextRenderingMode.FILL&&!T.disableFontFace&&!l.patternFill;O.save(),O.transform(...l.textMatrix),O.translate(l.x,l.y+l.textRise),G>0?O.scale(U,-1):O.scale(U,1);let ht;if(l.patternFill){O.save();const D=l.fillColor.getPattern(O,this,(0,v.getCurrentTransformInverse)(O),k.PathType.FILL);ht=(0,v.getCurrentTransform)(O),O.restore(),O.fillStyle=D}let c=l.lineWidth;const g=l.textMatrixScale;if(g===0||c===0){const D=l.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;D!==_.TextRenderingMode.STROKE&&D!==_.TextRenderingMode.FILL_STROKE||(c=this.getSinglePixelWidth())}else c/=g;B!==1&&(O.scale(B,B),c/=B),O.lineWidth=c;let w,M=0;for(w=0;w<J;++w){const D=f[w];if(typeof D=="number"){M+=at*D*R/1e3;continue}let V=!1;const ot=(D.isSpace?z:0)+P,et=D.fontChar,nt=D.accent;let gt,st,lt,ft=D.width;if(Q){const W=D.vmetric||X,it=-(D.vmetric?W[1]:.5*ft)*dt,_t=W[2]*dt;ft=W?-W[0]:ft,gt=it/B,st=(M+_t)/B}else gt=M/B,st=0;if(T.remeasure&&ft>0){const W=1e3*O.measureText(et).width/R*B;if(ft<W&&this.isFontSubpixelAAEnabled){const it=ft/W;V=!0,O.save(),O.scale(it,1),gt/=it}else ft!==W&&(gt+=(ft-W)/2e3*R/B)}if(this.contentVisible&&(D.isInFont||T.missingFile)){if(pt&&!nt)O.fillText(et,gt,st);else if(this.paintChar(et,gt,st,ht),nt){const W=gt+R*nt.offset.x/B,it=st-R*nt.offset.y/B;this.paintChar(nt.fontChar,W,it,ht)}}lt=Q?ft*dt-ot*G:ft*dt+ot*G,M+=lt,V&&O.restore()}Q?l.y-=M:l.x+=M*U,O.restore(),this.compose()}showType3Text(f){const l=this.ctx,T=this.current,R=T.font,O=T.fontSize,B=T.fontDirection,P=R.vertical?1:-1,z=T.charSpacing,G=T.wordSpacing,U=T.textHScale*B,J=T.fontMatrix||_.FONT_IDENTITY_MATRIX,Q=f.length;let at,X,dt,pt;if(T.textRenderingMode!==_.TextRenderingMode.INVISIBLE&&O!==0){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,l.save(),l.transform(...T.textMatrix),l.translate(T.x,T.y),l.scale(U,B),at=0;at<Q;++at){if(X=f[at],typeof X=="number"){pt=P*X*O/1e3,this.ctx.translate(pt,0),T.x+=pt*U;continue}const ht=(X.isSpace?G:0)+z,c=R.charProcOperatorList[X.operatorListId];if(!c){(0,_.warn)(`Type3 character "${X.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=X,this.save(),l.scale(O,O),l.transform(...J),this.executeOperatorList(c),this.restore()),dt=_.Util.applyTransform([X.width,0],J)[0]*O+ht,l.translate(dt,0),T.x+=dt*U}l.restore(),this.processingType3=null}}setCharWidth(f,l){}setCharWidthAndBounds(f,l,T,R,O,B){this.ctx.rect(T,R,O-T,B-R),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let l;if(f[0]==="TilingPattern"){const T=f[1],R=this.baseTransform||(0,v.getCurrentTransform)(this.ctx),O={createCanvasGraphics:B=>new K(B,this.commonObjs,this.objs,this.canvasFactory)};l=new k.TilingPattern(f,T,this.ctx,O,R)}else l=this._getPattern(f[1],f[2]);return l}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,l,T){var O;const R=((O=this.selectColor)==null?void 0:O.call(this,f,l,T))||_.Util.makeHexColor(f,l,T);this.ctx.strokeStyle=R,this.current.strokeColor=R}setFillRGBColor(f,l,T){var O;const R=((O=this.selectColor)==null?void 0:O.call(this,f,l,T))||_.Util.makeHexColor(f,l,T);this.ctx.fillStyle=R,this.current.fillColor=R,this.current.patternFill=!1}_getPattern(f,l=null){let T;return this.cachedPatterns.has(f)?T=this.cachedPatterns.get(f):(T=(0,k.getShadingPattern)(this.objs.get(f)),this.cachedPatterns.set(f,T)),l&&(T.matrix=l),T}shadingFill(f){if(!this.contentVisible)return;const l=this.ctx;this.save();const T=this._getPattern(f);l.fillStyle=T.getPattern(l,this,(0,v.getCurrentTransformInverse)(l),k.PathType.SHADING);const R=(0,v.getCurrentTransformInverse)(l);if(R){const O=l.canvas,B=O.width,P=O.height,z=_.Util.applyTransform([0,0],R),G=_.Util.applyTransform([0,P],R),U=_.Util.applyTransform([B,0],R),J=_.Util.applyTransform([B,P],R),Q=Math.min(z[0],G[0],U[0],J[0]),at=Math.min(z[1],G[1],U[1],J[1]),X=Math.max(z[0],G[0],U[0],J[0]),dt=Math.max(z[1],G[1],U[1],J[1]);this.ctx.fillRect(Q,at,X-Q,dt-at)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,_.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,_.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,l){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,v.getCurrentTransform)(this.ctx),l)){const T=l[2]-l[0],R=l[3]-l[1];this.ctx.rect(l[0],l[1],T,R),this.current.updateRectMinMax((0,v.getCurrentTransform)(this.ctx),l),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const l=this.ctx;f.isolated||(0,_.info)("TODO: Support non-isolated groups."),f.knockout&&(0,_.warn)("Knockout groups not supported.");const T=(0,v.getCurrentTransform)(l);if(f.matrix&&l.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let R=_.Util.getAxialAlignedBoundingBox(f.bbox,(0,v.getCurrentTransform)(l));const O=[0,0,l.canvas.width,l.canvas.height];R=_.Util.intersect(R,O)||[0,0,0,0];const B=Math.floor(R[0]),P=Math.floor(R[1]);let z=Math.max(Math.ceil(R[2])-B,1),G=Math.max(Math.ceil(R[3])-P,1),U=1,J=1;z>A&&(U=z/A,z=A),G>A&&(J=G/A,G=A),this.current.startNewPathAndClipBox([0,0,z,G]);let Q="groupAt"+this.groupLevel;f.smask&&(Q+="_smask_"+this.smaskCounter++%2);const at=this.cachedCanvases.getCanvas(Q,z,G),X=at.context;X.scale(1/U,1/J),X.translate(-B,-P),X.transform(...T),f.smask?this.smaskStack.push({canvas:at.canvas,context:X,offsetX:B,offsetY:P,scaleX:U,scaleY:J,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(l.setTransform(1,0,0,1,0,0),l.translate(B,P),l.scale(U,J),l.save()),s(l,X),this.ctx=X,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const l=this.ctx,T=this.groupStack.pop();if(this.ctx=T,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const R=(0,v.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...R);const O=_.Util.getAxialAlignedBoundingBox([0,0,l.canvas.width,l.canvas.height],R);this.ctx.drawImage(l.canvas,0,0),this.ctx.restore(),this.compose(O)}}beginAnnotation(f,l,T,R,O){if(rt(this,I,ae).call(this),n(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(l)&&l.length===4){const B=l[2]-l[0],P=l[3]-l[1];if(O&&this.annotationCanvasMap){(T=T.slice())[4]-=l[0],T[5]-=l[1],(l=l.slice())[0]=l[1]=0,l[2]=B,l[3]=P;const[z,G]=_.Util.singularValueDecompose2dScale((0,v.getCurrentTransform)(this.ctx)),{viewportScale:U}=this,J=Math.ceil(B*this.outputScaleX*U),Q=Math.ceil(P*this.outputScaleY*U);this.annotationCanvas=this.canvasFactory.create(J,Q);const{canvas:at,context:X}=this.annotationCanvas;this.annotationCanvasMap.set(f,at),this.annotationCanvas.savedCtx=this.ctx,this.ctx=X,this.ctx.setTransform(z,0,0,-G,0,P*G),n(this.ctx,this.foregroundColor)}else n(this.ctx,this.foregroundColor),this.ctx.rect(l[0],l[1],B,P),this.ctx.clip(),this.endPath()}this.current=new L(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...T),this.transform(...R)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const l=f.count;(f=this.getObject(f.data,f)).count=l;const T=this.ctx,R=this.processingType3;if(R&&(R.compiled===void 0&&(R.compiled=function(z){const{width:G,height:U}=z;if(G>h||U>h)return null;const J=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Q=G+1;let at,X,dt,pt=new Uint8Array(Q*(U+1));const ht=G+7&-8;let c=new Uint8Array(ht*U),g=0;for(const V of z.data){let ot=128;for(;ot>0;)c[g++]=V&ot?0:255,ot>>=1}let w=0;for(g=0,c[g]!==0&&(pt[0]=1,++w),X=1;X<G;X++)c[g]!==c[g+1]&&(pt[X]=c[g]?2:1,++w),g++;for(c[g]!==0&&(pt[X]=2,++w),at=1;at<U;at++){g=at*ht,dt=at*Q,c[g-ht]!==c[g]&&(pt[dt]=c[g]?1:8,++w);let V=(c[g]?4:0)+(c[g-ht]?8:0);for(X=1;X<G;X++)V=(V>>2)+(c[g+1]?4:0)+(c[g-ht+1]?8:0),J[V]&&(pt[dt+X]=J[V],++w),g++;if(c[g-ht]!==c[g]&&(pt[dt+X]=c[g]?2:4,++w),w>1e3)return null}for(g=ht*(U-1),dt=at*Q,c[g]!==0&&(pt[dt]=8,++w),X=1;X<G;X++)c[g]!==c[g+1]&&(pt[dt+X]=c[g]?4:8,++w),g++;if(c[g]!==0&&(pt[dt+X]=4,++w),w>1e3)return null;const M=new Int32Array([0,Q,-1,0,-Q,0,0,0,1]),D=new Path2D;for(at=0;w&&at<=U;at++){let V=at*Q;const ot=V+G;for(;V<ot&&!pt[V];)V++;if(V===ot)continue;D.moveTo(V%Q,at);const et=V;let nt=pt[V];do{const gt=M[nt];do V+=gt;while(!pt[V]);const st=pt[V];st!==5&&st!==10?(nt=st,pt[V]=0):(nt=st&51*nt>>4,pt[V]&=nt>>2|nt<<2),D.lineTo(V%Q,V/Q|0),pt[V]||--w}while(et!==V);--at}return c=null,pt=null,function(V){V.save(),V.scale(1/G,-1/U),V.translate(0,-U),V.fill(D),V.beginPath(),V.restore()}}(f)),R.compiled)){R.compiled(T);return}const O=this._createMaskCanvas(f),B=O.canvas;T.save(),T.setTransform(1,0,0,1,0,0),T.drawImage(B,O.offsetX,O.offsetY),T.restore(),this.compose()}paintImageMaskXObjectRepeat(f,l,T=0,R=0,O,B){if(!this.contentVisible)return;f=this.getObject(f.data,f);const P=this.ctx;P.save();const z=(0,v.getCurrentTransform)(P);P.transform(l,T,R,O,0,0);const G=this._createMaskCanvas(f);P.setTransform(1,0,0,1,0,0);for(let U=0,J=B.length;U<J;U+=2){const Q=_.Util.transform(z,[l,T,R,O,B[U],B[U+1]]),[at,X]=_.Util.applyTransform([0,0],Q);P.drawImage(G.canvas,at,X)}P.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const l=this.ctx,T=this.current.fillColor,R=this.current.patternFill;for(const O of f){const{data:B,width:P,height:z,transform:G}=O,U=this.cachedCanvases.getCanvas("maskCanvas",P,z),J=U.context;J.save(),o(J,this.getObject(B,O)),J.globalCompositeOperation="source-in",J.fillStyle=R?T.getPattern(J,this,(0,v.getCurrentTransformInverse)(l),k.PathType.FILL):T,J.fillRect(0,0,P,z),J.restore(),l.save(),l.transform(...G),l.scale(1,-1),C(l,U.canvas,0,0,P,z,0,-1,1,1),l.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const l=this.getObject(f);l?this.paintInlineImageXObject(l):(0,_.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(f,l,T,R){if(!this.contentVisible)return;const O=this.getObject(f);if(!O){(0,_.warn)("Dependent image isn't ready yet");return}const B=O.width,P=O.height,z=[];for(let G=0,U=R.length;G<U;G+=2)z.push({transform:[l,0,0,T,R[G],R[G+1]],x:0,y:0,w:B,h:P});this.paintInlineImageXObjectGroup(O,z)}paintInlineImageXObject(f){if(!this.contentVisible)return;const l=f.width,T=f.height,R=this.ctx;this.save(),R.scale(1/l,-1/T);let O;if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)O=f;else{const P=this.cachedCanvases.getCanvas("inlineImage",l,T);m(P.context,f,this.current.transferMaps),O=P.canvas}const B=this._scaleImage(O,(0,v.getCurrentTransformInverse)(R));R.imageSmoothingEnabled=r((0,v.getCurrentTransform)(R),f.interpolate),C(R,B.img,0,0,B.paintWidth,B.paintHeight,0,-T,l,T),this.compose(),this.restore()}paintInlineImageXObjectGroup(f,l){if(!this.contentVisible)return;const T=this.ctx,R=f.width,O=f.height,B=this.cachedCanvases.getCanvas("inlineImage",R,O);m(B.context,f,this.current.transferMaps);for(const P of l)T.save(),T.transform(...P.transform),T.scale(1,-1),C(T,B.canvas,P.x,P.y,P.w,P.h,0,-1,1,1),T.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,l){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,l){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(l)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const l=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const T=this.ctx;this.pendingClip&&(l||(this.pendingClip===S?T.clip("evenodd"):T.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),T.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,v.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const l=Math.abs(f[0]*f[3]-f[2]*f[1]),T=Math.hypot(f[0],f[2]),R=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(T,R)/l}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:f}=this.current,l=(0,v.getCurrentTransform)(this.ctx);let T,R;if(l[1]===0&&l[2]===0){const O=Math.abs(l[0]),B=Math.abs(l[3]);if(f===0)T=1/O,R=1/B;else{const P=O*f,z=B*f;T=P<1?1/P:1,R=z<1?1/z:1}}else{const O=Math.abs(l[0]*l[3]-l[2]*l[1]),B=Math.hypot(l[0],l[1]),P=Math.hypot(l[2],l[3]);if(f===0)T=P/O,R=B/O;else{const z=f*O;T=P>z?P/z:1,R=B>z?B/z:1}}this._cachedScaleForStroking=[T,R]}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:l}=this,{lineWidth:T}=this.current,[R,O]=this.getScaleForStroking();if(l.lineWidth=T||1,R===1&&O===1){l.stroke();return}let B,P,z;f&&(B=(0,v.getCurrentTransform)(l),P=l.getLineDash().slice(),z=l.lineDashOffset),l.scale(R,O);const G=Math.max(R,O);l.setLineDash(l.getLineDash().map(U=>U/G)),l.lineDashOffset/=G,l.stroke(),f&&(l.setTransform(...B),l.setLineDash(P),l.lineDashOffset=z)}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}};let x=K;I=new WeakSet,ae=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},p.CanvasGraphics=x;for(const j in _.OPS)x.prototype[j]!==void 0&&(x.prototype[_.OPS[j]]=x.prototype[j])},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.TilingPattern=p.PathType=void 0,p.getShadingPattern=function(i){switch(i[0]){case"RadialAxial":return new h(i);case"Mesh":return new C(i);case"Dummy":return new L}throw new Error(`Unknown IR type: ${i[0]}`)};var _=H(1),v=H(6),k=H(12);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};p.PathType=q;function N(n,i){if(!i||k.isNodeJS)return;const e=i[2]-i[0],a=i[3]-i[1],t=new Path2D;t.rect(i[0],i[1],e,a),n.clip(t)}class A{constructor(){this.constructor===A&&(0,_.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,_.unreachable)("Abstract method `getPattern` called.")}}class h extends A{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let e;this._type==="axial"?e=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)e.addColorStop(a[0],a[1]);return e}getPattern(i,e,a,t){let r;if(t===q.STROKE||t===q.FILL){const b=e.current.getClippedPathBoundingBox(t,(0,v.getCurrentTransform)(i))||[0,0,0,0],y=Math.ceil(b[2]-b[0])||1,F=Math.ceil(b[3]-b[1])||1,S=e.cachedCanvases.getCanvas("pattern",y,F,!0),x=S.context;x.clearRect(0,0,x.canvas.width,x.canvas.height),x.beginPath(),x.rect(0,0,x.canvas.width,x.canvas.height),x.translate(-b[0],-b[1]),a=_.Util.transform(a,[1,0,0,1,b[0],b[1]]),x.transform(...e.baseTransform),this.matrix&&x.transform(...this.matrix),N(x,this._bbox),x.fillStyle=this._createGradient(x),x.fill(),r=i.createPattern(S.canvas,"no-repeat");const I=new DOMMatrix(a);r.setTransform(I)}else N(i,this._bbox),r=this._createGradient(i);return r}}function u(n,i,e,a,t,r,b,y){const F=i.coords,S=i.colors,x=n.data,I=4*n.width;let $;F[e+1]>F[a+1]&&($=e,e=a,a=$,$=r,r=b,b=$),F[a+1]>F[t+1]&&($=a,a=t,t=$,$=b,b=y,y=$),F[e+1]>F[a+1]&&($=e,e=a,a=$,$=r,r=b,b=$);const K=(F[e]+i.offsetX)*i.scaleX,j=(F[e+1]+i.offsetY)*i.scaleY,f=(F[a]+i.offsetX)*i.scaleX,l=(F[a+1]+i.offsetY)*i.scaleY,T=(F[t]+i.offsetX)*i.scaleX,R=(F[t+1]+i.offsetY)*i.scaleY;if(j>=R)return;const O=S[r],B=S[r+1],P=S[r+2],z=S[b],G=S[b+1],U=S[b+2],J=S[y],Q=S[y+1],at=S[y+2],X=Math.round(j),dt=Math.round(R);let pt,ht,c,g,w,M,D,V;for(let ot=X;ot<=dt;ot++){if(ot<l){let lt;lt=ot<j?0:(j-ot)/(j-l),pt=K-(K-f)*lt,ht=O-(O-z)*lt,c=B-(B-G)*lt,g=P-(P-U)*lt}else{let lt;lt=ot>R?1:l===R?0:(l-ot)/(l-R),pt=f-(f-T)*lt,ht=z-(z-J)*lt,c=G-(G-Q)*lt,g=U-(U-at)*lt}let et;et=ot<j?0:ot>R?1:(j-ot)/(j-R),w=K-(K-T)*et,M=O-(O-J)*et,D=B-(B-Q)*et,V=P-(P-at)*et;const nt=Math.round(Math.min(pt,w)),gt=Math.round(Math.max(pt,w));let st=I*ot+4*nt;for(let lt=nt;lt<=gt;lt++)et=(pt-lt)/(pt-w),et<0?et=0:et>1&&(et=1),x[st++]=ht-(ht-M)*et|0,x[st++]=c-(c-D)*et|0,x[st++]=g-(g-V)*et|0,x[st++]=255}}function d(n,i,e){const a=i.coords,t=i.colors;let r,b;switch(i.type){case"lattice":const y=i.verticesPerRow,F=Math.floor(a.length/y)-1,S=y-1;for(r=0;r<F;r++){let x=r*y;for(let I=0;I<S;I++,x++)u(n,e,a[x],a[x+1],a[x+y],t[x],t[x+1],t[x+y]),u(n,e,a[x+y+1],a[x+1],a[x+y],t[x+y+1],t[x+1],t[x+y])}break;case"triangles":for(r=0,b=a.length;r<b;r+=3)u(n,e,a[r],a[r+1],a[r+2],t[r],t[r+1],t[r+2]);break;default:throw new Error("illegal figure")}}class C extends A{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,e,a){const t=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),b=Math.ceil(this._bounds[2])-t,y=Math.ceil(this._bounds[3])-r,F=Math.min(Math.ceil(Math.abs(b*i[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(y*i[1]*1.1)),3e3),x=b/F,I=y/S,$={coords:this._coords,colors:this._colors,offsetX:-t,offsetY:-r,scaleX:1/x,scaleY:1/I},K=F+4,j=S+4,f=a.getCanvas("mesh",K,j,!1),l=f.context,T=l.createImageData(F,S);if(e){const R=T.data;for(let O=0,B=R.length;O<B;O+=4)R[O]=e[0],R[O+1]=e[1],R[O+2]=e[2],R[O+3]=255}for(const R of this._figures)d(T,R,$);return l.putImageData(T,2,2),{canvas:f.canvas,offsetX:t-2*x,offsetY:r-2*I,scaleX:x,scaleY:I}}getPattern(i,e,a,t){N(i,this._bbox);let r;if(t===q.SHADING)r=_.Util.singularValueDecompose2dScale((0,v.getCurrentTransform)(i));else if(r=_.Util.singularValueDecompose2dScale(e.baseTransform),this.matrix){const y=_.Util.singularValueDecompose2dScale(this.matrix);r=[r[0]*y[0],r[1]*y[1]]}const b=this._createMeshCanvas(r,t===q.SHADING?null:this._background,e.cachedCanvases);return t!==q.SHADING&&(i.setTransform(...e.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(b.offsetX,b.offsetY),i.scale(b.scaleX,b.scaleY),i.createPattern(b.canvas,"no-repeat")}}class L extends A{getPattern(){return"hotpink"}}const m=1,o=2;class s{static get MAX_PATTERN_SIZE(){return(0,_.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(i,e,a,t,r){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=e,this.ctx=a,this.canvasGraphicsFactory=t,this.baseTransform=r}createPatternCanvas(i){const e=this.operatorList,a=this.bbox,t=this.xstep,r=this.ystep,b=this.paintType,y=this.tilingType,F=this.color,S=this.canvasGraphicsFactory;(0,_.info)("TilingType: "+y);const x=a[0],I=a[1],$=a[2],K=a[3],j=_.Util.singularValueDecompose2dScale(this.matrix),f=_.Util.singularValueDecompose2dScale(this.baseTransform),l=[j[0]*f[0],j[1]*f[1]],T=this.getSizeAndScale(t,this.ctx.canvas.width,l[0]),R=this.getSizeAndScale(r,this.ctx.canvas.height,l[1]),O=i.cachedCanvases.getCanvas("pattern",T.size,R.size,!0),B=O.context,P=S.createCanvasGraphics(B);P.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(P,b,F);let z=x,G=I,U=$,J=K;return x<0&&(z=0,U+=Math.abs(x)),I<0&&(G=0,J+=Math.abs(I)),B.translate(-T.scale*z,-R.scale*G),P.transform(T.scale,0,0,R.scale,0,0),B.save(),this.clipBbox(P,z,G,U,J),P.baseTransform=(0,v.getCurrentTransform)(P.ctx),P.executeOperatorList(e),P.endDrawing(),{canvas:O.canvas,scaleX:T.scale,scaleY:R.scale,offsetX:z,offsetY:G}}getSizeAndScale(i,e,a){i=Math.abs(i);const t=Math.max(s.MAX_PATTERN_SIZE,e);let r=Math.ceil(i*a);return r>=t?r=t:a=r/i,{scale:a,size:r}}clipBbox(i,e,a,t,r){const b=t-e,y=r-a;i.ctx.rect(e,a,b,y),i.current.updateRectMinMax((0,v.getCurrentTransform)(i.ctx),[e,a,t,r]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,e,a){const t=i.ctx,r=i.current;switch(e){case m:const b=this.ctx;t.fillStyle=b.fillStyle,t.strokeStyle=b.strokeStyle,r.fillColor=b.fillStyle,r.strokeColor=b.strokeStyle;break;case o:const y=_.Util.makeHexColor(a[0],a[1],a[2]);t.fillStyle=y,t.strokeStyle=y,r.fillColor=y,r.strokeColor=y;break;default:throw new _.FormatError(`Unsupported paint type: ${e}`)}}getPattern(i,e,a,t){let r=a;t!==q.SHADING&&(r=_.Util.transform(r,e.baseTransform),this.matrix&&(r=_.Util.transform(r,this.matrix)));const b=this.createPatternCanvas(e);let y=new DOMMatrix(r);y=y.translate(b.offsetX,b.offsetY),y=y.scale(1/b.scaleX,1/b.scaleY);const F=i.createPattern(b.canvas,"repeat");return F.setTransform(y),F}}p.TilingPattern=s},(Y,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.isNodeJS=void 0;const H=!(typeof process!="object"||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&process.type!=="browser");p.isNodeJS=H},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.applyMaskImageData=function({src:k,srcPos:q=0,dest:N,destPos:A=0,width:h,height:u,inverseDecode:d=!1}){const C=_.FeatureTest.isLittleEndian?4278190080:255,[L,m]=d?[0,C]:[C,0],o=h>>3,s=7&h,n=k.length;N=new Uint32Array(N.buffer);for(let i=0;i<u;i++){for(const a=q+o;q<a;q++){const t=q<n?k[q]:255;N[A++]=128&t?m:L,N[A++]=64&t?m:L,N[A++]=32&t?m:L,N[A++]=16&t?m:L,N[A++]=8&t?m:L,N[A++]=4&t?m:L,N[A++]=2&t?m:L,N[A++]=1&t?m:L}if(s===0)continue;const e=q<n?k[q++]:255;for(let a=0;a<s;a++)N[A++]=e&1<<7-a?m:L}return{srcPos:q,destPos:A}};var _=H(1)},(Y,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.GlobalWorkerOptions=void 0;const H=Object.create(null);p.GlobalWorkerOptions=H,H.workerPort=H.workerPort===void 0?null:H.workerPort,H.workerSrc=H.workerSrc===void 0?"":H.workerSrc},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.MessageHandler=void 0;var _=H(1);const v=1,k=2,q=1,N=2,A=3,h=4,u=5,d=6,C=7,L=8;function m(o){switch(o instanceof Error||typeof o=="object"&&o!==null||(0,_.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),o.name){case"AbortException":return new _.AbortException(o.message);case"MissingPDFException":return new _.MissingPDFException(o.message);case"PasswordException":return new _.PasswordException(o.message,o.code);case"UnexpectedResponseException":return new _.UnexpectedResponseException(o.message,o.status);case"UnknownErrorException":return new _.UnknownErrorException(o.message,o.details);default:return new _.UnknownErrorException(o.message,o.toString())}}p.MessageHandler=class{constructor(s,n,i){this.sourceName=s,this.targetName=n,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const a=e.data;if(a.targetName!==this.sourceName)return;if(a.stream){this._processStreamMessage(a);return}if(a.callback){const r=a.callbackId,b=this.callbackCapabilities[r];if(!b)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],a.callback===v)b.resolve(a.data);else{if(a.callback!==k)throw new Error("Unexpected callback case");b.reject(m(a.reason))}return}const t=this.actionHandler[a.action];if(!t)throw new Error(`Unknown action from worker: ${a.action}`);if(a.callbackId){const r=this.sourceName,b=a.sourceName;new Promise(function(y){y(t(a.data))}).then(function(y){i.postMessage({sourceName:r,targetName:b,callback:v,callbackId:a.callbackId,data:y})},function(y){i.postMessage({sourceName:r,targetName:b,callback:k,callbackId:a.callbackId,reason:m(y)})})}else a.streamId?this._createStreamSink(a):t(a.data)},i.addEventListener("message",this._onComObjOnMessage)}on(s,n){const i=this.actionHandler;if(i[s])throw new Error(`There is already an actionName called "${s}"`);i[s]=n}send(s,n,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,data:n},i)}sendWithPromise(s,n,i){const e=this.callbackId++,a=(0,_.createPromiseCapability)();this.callbackCapabilities[e]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,callbackId:e,data:n},i)}catch(t){a.reject(t)}return a.promise}sendWithStream(s,n,i,e){const a=this.streamId++,t=this.sourceName,r=this.targetName,b=this.comObj;return new ReadableStream({start:y=>{const F=(0,_.createPromiseCapability)();return this.streamControllers[a]={controller:y,startCall:F,pullCall:null,cancelCall:null,isClosed:!1},b.postMessage({sourceName:t,targetName:r,action:s,streamId:a,data:n,desiredSize:y.desiredSize},e),F.promise},pull:y=>{const F=(0,_.createPromiseCapability)();return this.streamControllers[a].pullCall=F,b.postMessage({sourceName:t,targetName:r,stream:d,streamId:a,desiredSize:y.desiredSize}),F.promise},cancel:y=>{(0,_.assert)(y instanceof Error,"cancel must have a valid reason");const F=(0,_.createPromiseCapability)();return this.streamControllers[a].cancelCall=F,this.streamControllers[a].isClosed=!0,b.postMessage({sourceName:t,targetName:r,stream:q,streamId:a,reason:m(y)}),F.promise}},i)}_createStreamSink(s){const n=s.streamId,i=this.sourceName,e=s.sourceName,a=this.comObj,t=this,r=this.actionHandler[s.action],b={enqueue(y,F=1,S){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=F,x>0&&this.desiredSize<=0&&(this.sinkCapability=(0,_.createPromiseCapability)(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:e,stream:h,streamId:n,chunk:y},S)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:e,stream:A,streamId:n}),delete t.streamSinks[n])},error(y){(0,_.assert)(y instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:e,stream:u,streamId:n,reason:m(y)}))},sinkCapability:(0,_.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:s.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[n]=b,new Promise(function(y){y(r(s.data,b))}).then(function(){a.postMessage({sourceName:i,targetName:e,stream:L,streamId:n,success:!0})},function(y){a.postMessage({sourceName:i,targetName:e,stream:L,streamId:n,reason:m(y)})})}_processStreamMessage(s){const n=s.streamId,i=this.sourceName,e=s.sourceName,a=this.comObj,t=this.streamControllers[n],r=this.streamSinks[n];switch(s.stream){case L:s.success?t.startCall.resolve():t.startCall.reject(m(s.reason));break;case C:s.success?t.pullCall.resolve():t.pullCall.reject(m(s.reason));break;case d:if(!r){a.postMessage({sourceName:i,targetName:e,stream:C,streamId:n,success:!0});break}r.desiredSize<=0&&s.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=s.desiredSize,new Promise(function(b){b(r.onPull&&r.onPull())}).then(function(){a.postMessage({sourceName:i,targetName:e,stream:C,streamId:n,success:!0})},function(b){a.postMessage({sourceName:i,targetName:e,stream:C,streamId:n,reason:m(b)})});break;case h:if((0,_.assert)(t,"enqueue should have stream controller"),t.isClosed)break;t.controller.enqueue(s.chunk);break;case A:if((0,_.assert)(t,"close should have stream controller"),t.isClosed)break;t.isClosed=!0,t.controller.close(),this._deleteStreamController(t,n);break;case u:(0,_.assert)(t,"error should have stream controller"),t.controller.error(m(s.reason)),this._deleteStreamController(t,n);break;case N:s.success?t.cancelCall.resolve():t.cancelCall.reject(m(s.reason)),this._deleteStreamController(t,n);break;case q:if(!r)break;new Promise(function(b){b(r.onCancel&&r.onCancel(m(s.reason)))}).then(function(){a.postMessage({sourceName:i,targetName:e,stream:N,streamId:n,success:!0})},function(b){a.postMessage({sourceName:i,targetName:e,stream:N,streamId:n,reason:m(b)})}),r.sinkCapability.reject(m(s.reason)),r.isCancelled=!0,delete this.streamSinks[n];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(s,n){await Promise.allSettled([s.startCall&&s.startCall.promise,s.pullCall&&s.pullCall.promise,s.cancelCall&&s.cancelCall.promise]),delete this.streamControllers[n]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(Y,p,H)=>{var v,k,q;Object.defineProperty(p,"__esModule",{value:!0}),p.Metadata=void 0;var _=H(1);p.Metadata=(q=class{constructor({parsedData:A,rawData:h}){Z(this,v,void 0);Z(this,k,void 0);ut(this,v,A),ut(this,k,h)}getRaw(){return E(this,k)}get(A){var h;return(h=E(this,v).get(A))!=null?h:null}getAll(){return(0,_.objectFromMap)(E(this,v))}has(A){return E(this,v).has(A)}},v=new WeakMap,k=new WeakMap,q)},(Y,p,H)=>{var N,A,h,u,d,C,oe,m;Object.defineProperty(p,"__esModule",{value:!0}),p.OptionalContentConfig=void 0;var _=H(1),v=H(8);const k=Symbol("INTERNAL");class q{constructor(s,n){Z(this,N,!0);this.name=s,this.intent=n}get visible(){return E(this,N)}_setVisible(s,n){s!==k&&(0,_.unreachable)("Internal method `_setVisible` called."),ut(this,N,n)}}N=new WeakMap,p.OptionalContentConfig=(m=class{constructor(s){Z(this,C);Z(this,A,null);Z(this,h,new Map);Z(this,u,null);Z(this,d,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,ut(this,d,s.order);for(const n of s.groups)E(this,h).set(n.id,new q(n.name,n.intent));if(s.baseState==="OFF")for(const n of E(this,h).values())n._setVisible(k,!1);for(const n of s.on)E(this,h).get(n)._setVisible(k,!0);for(const n of s.off)E(this,h).get(n)._setVisible(k,!1);ut(this,u,this.getHash())}}isVisible(s){if(E(this,h).size===0)return!0;if(!s)return(0,_.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return E(this,h).has(s.id)?E(this,h).get(s.id).visible:((0,_.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return rt(this,C,oe).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const n of s.ids){if(!E(this,h).has(n))return(0,_.warn)(`Optional content group not found: ${n}`),!0;if(E(this,h).get(n).visible)return!0}return!1}if(s.policy==="AllOn"){for(const n of s.ids){if(!E(this,h).has(n))return(0,_.warn)(`Optional content group not found: ${n}`),!0;if(!E(this,h).get(n).visible)return!1}return!0}if(s.policy==="AnyOff"){for(const n of s.ids){if(!E(this,h).has(n))return(0,_.warn)(`Optional content group not found: ${n}`),!0;if(!E(this,h).get(n).visible)return!0}return!1}if(s.policy==="AllOff"){for(const n of s.ids){if(!E(this,h).has(n))return(0,_.warn)(`Optional content group not found: ${n}`),!0;if(E(this,h).get(n).visible)return!1}return!0}return(0,_.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,_.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,n=!0){E(this,h).has(s)?(E(this,h).get(s)._setVisible(k,!!n),ut(this,A,null)):(0,_.warn)(`Optional content group not found: ${s}`)}get hasInitialVisibility(){return this.getHash()===E(this,u)}getOrder(){return E(this,h).size?E(this,d)?E(this,d).slice():[...E(this,h).keys()]:null}getGroups(){return E(this,h).size>0?(0,_.objectFromMap)(E(this,h)):null}getGroup(s){return E(this,h).get(s)||null}getHash(){if(E(this,A)!==null)return E(this,A);const s=new v.MurmurHash3_64;for(const[n,i]of E(this,h))s.update(`${n}:${i.visible}`);return ut(this,A,s.hexdigest())}},A=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap,C=new WeakSet,oe=function(s){const n=s.length;if(n<2)return!0;const i=s[0];for(let e=1;e<n;e++){const a=s[e];let t;if(Array.isArray(a))t=rt(this,C,oe).call(this,a);else{if(!E(this,h).has(a))return(0,_.warn)(`Optional content group not found: ${a}`),!0;t=E(this,h).get(a).visible}switch(i){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return i==="And"},m)},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFDataTransportStream=void 0;var _=H(1),v=H(6);p.PDFDataTransportStream=class{constructor(A,h){(0,_.assert)(h,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=A.progressiveDone||!1,this._contentDispositionFilename=A.contentDispositionFilename||null;const u=A.initialData;if((u==null?void 0:u.length)>0){const d=new Uint8Array(u).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=h,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._contentLength=A.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((d,C)=>{this._onReceiveData({begin:d,chunk:C})}),this._pdfDataRangeTransport.addProgressListener((d,C)=>{this._onProgress({loaded:d,total:C})}),this._pdfDataRangeTransport.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(A){const h=new Uint8Array(A.chunk).buffer;if(A.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(h):this._queuedChunks.push(h);else{const u=this._rangeReaders.some(function(d){return d._begin!==A.begin?!1:(d._enqueue(h),!0)});(0,_.assert)(u,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var A,h;return(h=(A=this._fullRequestReader)==null?void 0:A._loaded)!=null?h:0}_onProgress(A){var h,u,d,C;A.total===void 0?(u=(h=this._rangeReaders[0])==null?void 0:h.onProgress)==null||u.call(h,{loaded:A.loaded}):(C=(d=this._fullRequestReader)==null?void 0:d.onProgress)==null||C.call(d,{loaded:A.loaded,total:A.total})}_onProgressiveDone(){var A;(A=this._fullRequestReader)==null||A.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(A){const h=this._rangeReaders.indexOf(A);h>=0&&this._rangeReaders.splice(h,1)}getFullReader(){(0,_.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const A=this._queuedChunks;return this._queuedChunks=null,new k(this,A,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(A,h){if(h<=this._progressiveDataLength)return null;const u=new q(this,A,h);return this._pdfDataRangeTransport.requestDataRange(A,h),this._rangeReaders.push(u),u}cancelAllRequests(A){var h;(h=this._fullRequestReader)==null||h.cancel(A);for(const u of this._rangeReaders.slice(0))u.cancel(A);this._pdfDataRangeTransport.abort()}};class k{constructor(A,h,u=!1,d=null){this._stream=A,this._done=u||!1,this._filename=(0,v.isPdfFile)(d)?d:null,this._queuedChunks=h||[],this._loaded=0;for(const C of this._queuedChunks)this._loaded+=C.byteLength;this._requests=[],this._headersReady=Promise.resolve(),A._fullRequestReader=this,this.onProgress=null}_enqueue(A){this._done||(this._requests.length>0?this._requests.shift().resolve({value:A,done:!1}):this._queuedChunks.push(A),this._loaded+=A.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,_.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class q{constructor(A,h,u){this._stream=A,this._begin=h,this._end=u,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(A){if(!this._done){if(this._requests.length===0)this._queuedChunk=A;else{this._requests.shift().resolve({value:A,done:!1});for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,_.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Y,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.XfaText=void 0;class H{static textContent(v){const k=[],q={items:k,styles:Object.create(null)};return function N(A){var d;if(!A)return;let h=null;const u=A.name;if(u==="#text")h=A.value;else{if(!H.shouldBuildText(u))return;(d=A==null?void 0:A.attributes)!=null&&d.textContent?h=A.attributes.textContent:A.value&&(h=A.value)}if(h!==null&&k.push({str:h}),A.children)for(const C of A.children)N(C)}(v),q}static shouldBuildText(v){return!(v==="textarea"||v==="input"||v==="option"||v==="select")}}p.XfaText=H},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.NodeStandardFontDataFactory=p.NodeCanvasFactory=p.NodeCMapReaderFactory=void 0;var _=H(7);const v=function(A){return new Promise((h,u)=>{require$$2.readFile(A,(d,C)=>{!d&&C?h(new Uint8Array(C)):u(new Error(d))})})};class k extends _.BaseCanvasFactory{_createCanvas(h,u){return require$$2.createCanvas(h,u)}}p.NodeCanvasFactory=k;class q extends _.BaseCMapReaderFactory{_fetchData(h,u){return v(h).then(d=>({cMapData:d,compressionType:u}))}}p.NodeCMapReaderFactory=q;class N extends _.BaseStandardFontDataFactory{_fetchData(h){return v(h)}}p.NodeStandardFontDataFactory=N},(Y,p,H)=>{var A,h,u,d,C,L,m,o,s,le,i,ke,a,ce,r,Fe;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationEditorLayer=void 0;var _=H(5),v=H(1),k=H(22),q=H(23);const y=class{constructor(S){Z(this,s);Z(this,i);Z(this,a);Z(this,r);Z(this,A,void 0);Z(this,h,!1);Z(this,u,this.pointerup.bind(this));Z(this,d,this.pointerdown.bind(this));Z(this,C,new Map);Z(this,L,!1);Z(this,m,!1);Z(this,o,void 0);y._initialized||(y._initialized=!0,k.FreeTextEditor.initialize(S.l10n),q.InkEditor.initialize(S.l10n)),S.uiManager.registerEditorTypes([k.FreeTextEditor,q.InkEditor]),ut(this,o,S.uiManager),this.annotationStorage=S.annotationStorage,this.pageIndex=S.pageIndex,this.div=S.div,ut(this,A,S.accessibilityManager),E(this,o).addLayer(this)}updateToolbar(S){E(this,o).updateToolbar(S)}updateMode(S=E(this,o).getMode()){rt(this,r,Fe).call(this),S===v.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),E(this,o).unselectAll(),this.div.classList.toggle("freeTextEditing",S===v.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",S===v.AnnotationEditorType.INK)}addInkEditorIfNeeded(S){if(!(!S&&E(this,o).getMode()!==v.AnnotationEditorType.INK)){if(!S){for(const x of E(this,C).values())if(x.isEmpty()){x.setInBackground();return}}rt(this,a,ce).call(this,{offsetX:0,offsetY:0}).setInBackground()}}setEditingState(S){E(this,o).setEditingState(S)}addCommands(S){E(this,o).addCommands(S)}enable(){this.div.style.pointerEvents="auto";for(const S of E(this,C).values())S.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const S of E(this,C).values())S.disableEditing()}setActiveEditor(S){E(this,o).getActive()!==S&&E(this,o).setActiveEditor(S)}enableClick(){this.div.addEventListener("pointerdown",E(this,d)),this.div.addEventListener("pointerup",E(this,u))}disableClick(){this.div.removeEventListener("pointerdown",E(this,d)),this.div.removeEventListener("pointerup",E(this,u))}attach(S){E(this,C).set(S.id,S)}detach(S){var x;E(this,C).delete(S.id),(x=E(this,A))==null||x.removePointerInTextLayer(S.contentDiv)}remove(S){E(this,o).removeEditor(S),this.detach(S),this.annotationStorage.remove(S.id),S.div.style.display="none",setTimeout(()=>{S.div.style.display="",S.div.remove(),S.isAttachedToDOM=!1,document.activeElement===document.body&&E(this,o).focusMainContainer()},0),E(this,m)||this.addInkEditorIfNeeded(!1)}add(S){if(rt(this,s,le).call(this,S),E(this,o).addEditor(S),this.attach(S),!S.isAttachedToDOM){const x=S.render();this.div.append(x),S.isAttachedToDOM=!0}this.moveEditorInDOM(S),S.onceAdded(),this.addToAnnotationStorage(S)}moveEditorInDOM(S){var x;(x=E(this,A))==null||x.moveElementInDOM(this.div,S.div,S.contentDiv,!0)}addToAnnotationStorage(S){S.isEmpty()||this.annotationStorage.has(S.id)||this.annotationStorage.setValue(S.id,S)}addOrRebuild(S){S.needsToBeRebuilt()?S.rebuild():this.add(S)}addANewEditor(S){this.addCommands({cmd:()=>{this.addOrRebuild(S)},undo:()=>{S.remove()},mustExec:!0})}addUndoableEditor(S){this.addCommands({cmd:()=>{this.addOrRebuild(S)},undo:()=>{S.remove()},mustExec:!1})}getNextId(){return E(this,o).getId()}deserialize(S){switch(S.annotationType){case v.AnnotationEditorType.FREETEXT:return k.FreeTextEditor.deserialize(S,this);case v.AnnotationEditorType.INK:return q.InkEditor.deserialize(S,this)}return null}setSelected(S){E(this,o).setSelected(S)}toggleSelected(S){E(this,o).toggleSelected(S)}isSelected(S){return E(this,o).isSelected(S)}unselect(S){E(this,o).unselect(S)}pointerup(S){const x=_.KeyboardManager.platform.isMac;!(S.button!==0||S.ctrlKey&&x)&&S.target===this.div&&E(this,L)&&(ut(this,L,!1),E(this,h)?rt(this,a,ce).call(this,S):ut(this,h,!0))}pointerdown(S){const x=_.KeyboardManager.platform.isMac;if(S.button!==0||S.ctrlKey&&x||S.target!==this.div)return;ut(this,L,!0);const I=E(this,o).getActive();ut(this,h,!I||I.isEmpty())}drop(S){const x=S.dataTransfer.getData("text/plain"),I=E(this,o).getEditor(x);if(!I)return;S.preventDefault(),S.dataTransfer.dropEffect="move",rt(this,s,le).call(this,I);const $=this.div.getBoundingClientRect(),K=S.clientX-$.x,j=S.clientY-$.y;I.translate(K-I.startX,j-I.startY),this.moveEditorInDOM(I),I.div.focus()}dragover(S){S.preventDefault()}destroy(){var S,x;((S=E(this,o).getActive())==null?void 0:S.parent)===this&&E(this,o).setActiveEditor(null);for(const I of E(this,C).values())(x=E(this,A))==null||x.removePointerInTextLayer(I.contentDiv),I.isAttachedToDOM=!1,I.div.remove(),I.parent=null;this.div=null,E(this,C).clear(),E(this,o).removeLayer(this)}render(S){this.viewport=S.viewport,(0,_.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const x of E(this,o).getEditors(this.pageIndex))this.add(x);this.updateMode()}update(S){E(this,o).commitOrRemove(),this.viewport=S.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[S,x,I,$]=this.viewport.viewBox;return[I-S,$-x]}get viewportBaseDimensions(){const{width:S,height:x,rotation:I}=this.viewport;return I%180==0?[S,x]:[x,S]}setDimensions(){const{width:S,height:x,rotation:I}=this.viewport,$=I%180!=0,K=Math.floor(S)+"px",j=Math.floor(x)+"px";this.div.style.width=$?j:K,this.div.style.height=$?K:j,this.div.setAttribute("data-main-rotation",I)}};let N=y;A=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap,C=new WeakMap,L=new WeakMap,m=new WeakMap,o=new WeakMap,s=new WeakSet,le=function(S){var x;S.parent!==this&&(this.attach(S),S.pageIndex=this.pageIndex,(x=S.parent)==null||x.detach(S),S.parent=this,S.div&&S.isAttachedToDOM&&(S.div.remove(),this.div.append(S.div)))},i=new WeakSet,ke=function(S){switch(E(this,o).getMode()){case v.AnnotationEditorType.FREETEXT:return new k.FreeTextEditor(S);case v.AnnotationEditorType.INK:return new q.InkEditor(S)}return null},a=new WeakSet,ce=function(S){const x=this.getNextId(),I=rt(this,i,ke).call(this,{parent:this,id:x,x:S.offsetX,y:S.offsetY});return I&&this.add(I),I},r=new WeakSet,Fe=function(){ut(this,m,!0);for(const S of E(this,C).values())S.isEmpty()&&S.remove();ut(this,m,!1)},wt(N,"_initialized",!1),p.AnnotationEditorLayer=N},(Y,p,H)=>{var N,A,h,u,d,C,L,m,o,s,Re,i,Me,a,De,r,he;Object.defineProperty(p,"__esModule",{value:!0}),p.FreeTextEditor=void 0;var _=H(1),v=H(5),k=H(4);const y=class extends k.AnnotationEditor{constructor(x){super({...x,name:"freeTextEditor"});Z(this,s);Z(this,i);Z(this,a);Z(this,r);Z(this,N,this.editorDivBlur.bind(this));Z(this,A,this.editorDivFocus.bind(this));Z(this,h,this.editorDivInput.bind(this));Z(this,u,this.editorDivKeydown.bind(this));Z(this,d,void 0);Z(this,C,"");Z(this,L,`${this.id}-editor`);Z(this,m,!1);Z(this,o,void 0);ut(this,d,x.color||y._defaultColor||k.AnnotationEditor._defaultLineColor),ut(this,o,x.fontSize||y._defaultFontSize)}static initialize(x){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map($=>[$,x.get($)]));const I=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(I.getPropertyValue("--freetext-padding"))}static updateDefaultParams(x,I){switch(x){case _.AnnotationEditorParamsType.FREETEXT_SIZE:y._defaultFontSize=I;break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:y._defaultColor=I}}updateParams(x,I){switch(x){case _.AnnotationEditorParamsType.FREETEXT_SIZE:rt(this,s,Re).call(this,I);break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:rt(this,i,Me).call(this,I)}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,y._defaultFontSize],[_.AnnotationEditorParamsType.FREETEXT_COLOR,y._defaultColor||k.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,E(this,o)],[_.AnnotationEditorParamsType.FREETEXT_COLOR,E(this,d)]]}getInitialTranslation(){return[-y._internalPadding*this.parent.scaleFactor,-(y._internalPadding+E(this,o))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(_.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",E(this,u)),this.editorDiv.addEventListener("focus",E(this,A)),this.editorDiv.addEventListener("blur",E(this,N)),this.editorDiv.addEventListener("input",E(this,h)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",E(this,L)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",E(this,u)),this.editorDiv.removeEventListener("focus",E(this,A)),this.editorDiv.removeEventListener("blur",E(this,N)),this.editorDiv.removeEventListener("input",E(this,h)),this.div.focus(),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(x){super.focusin(x),x.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){super.commit(),E(this,m)||(ut(this,m,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),ut(this,C,rt(this,a,De).call(this).trimEnd()),rt(this,r,he).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(x){this.enableEditMode(),this.editorDiv.focus()}keydown(x){x.target===this.div&&x.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(x){y._keyboardManager.exec(this,x)}editorDivFocus(x){this.isEditing=!0}editorDivBlur(x){this.isEditing=!1}editorDivInput(x){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let x,I;this.width&&(x=this.x,I=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",E(this,L)),this.enableEditing(),y._l10nPromise.get("editor_free_text2_aria_label").then(K=>{var j;return(j=this.editorDiv)==null?void 0:j.setAttribute("aria-label",K)}),y._l10nPromise.get("free_text2_default_content").then(K=>{var j;return(j=this.editorDiv)==null?void 0:j.setAttribute("default-content",K)}),this.editorDiv.contentEditable=!0;const{style:$}=this.editorDiv;if($.fontSize=`calc(${E(this,o)}px * var(--scale-factor))`,$.color=E(this,d),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,v.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[K,j]=this.parent.viewportBaseDimensions;this.setAt(x*K,I*j,this.width*K,this.height*j);for(const f of E(this,C).split(`
`)){const l=document.createElement("div");l.append(f?document.createTextNode(f):document.createElement("br")),this.editorDiv.append(l)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(x,I){const $=super.deserialize(x,I);return ut($,o,x.fontSize),ut($,d,_.Util.makeHexColor(...x.color)),ut($,C,x.value),$}serialize(){if(this.isEmpty())return null;const x=y._internalPadding*this.parent.scaleFactor,I=this.getRect(x,x),$=k.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:_.AnnotationEditorType.FREETEXT,color:$,fontSize:E(this,o),value:E(this,C),pageIndex:this.parent.pageIndex,rect:I,rotation:this.rotation}}};let q=y;N=new WeakMap,A=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap,C=new WeakMap,L=new WeakMap,m=new WeakMap,o=new WeakMap,s=new WeakSet,Re=function(x){const I=K=>{this.editorDiv.style.fontSize=`calc(${K}px * var(--scale-factor))`,this.translate(0,-(K-E(this,o))*this.parent.scaleFactor),ut(this,o,K),rt(this,r,he).call(this)},$=E(this,o);this.parent.addCommands({cmd:()=>{I(x)},undo:()=>{I($)},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,Me=function(x){const I=E(this,d);this.parent.addCommands({cmd:()=>{ut(this,d,x),this.editorDiv.style.color=x},undo:()=>{ut(this,d,I),this.editorDiv.style.color=I},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},a=new WeakSet,De=function(){const x=this.editorDiv.getElementsByTagName("div");if(x.length===0)return this.editorDiv.innerText;const I=[];for(const $ of x){const K=$.firstChild;(K==null?void 0:K.nodeName)==="#text"?I.push(K.data):I.push("")}return I.join(`
`)},r=new WeakSet,he=function(){const[x,I]=this.parent.viewportBaseDimensions,$=this.div.getBoundingClientRect();this.width=$.width/x,this.height=$.height/I},wt(q,"_freeTextDefaultContent",""),wt(q,"_l10nPromise"),wt(q,"_internalPadding",0),wt(q,"_defaultColor",null),wt(q,"_defaultFontSize",10),wt(q,"_keyboardManager",new v.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],y.prototype.commitOrRemove]])),wt(q,"_type","freetext"),p.FreeTextEditor=q},(Y,p,H)=>{var h,u,d,C,L,m,o,s,n,i,e,a,t,r,b,Oe,F,Ie,x,Le,$,Ne,j,de,l,Be,R,je,B,Ue,z,Ut,U,ue,Q,Kt,X,Jt,pt,qt,c,pe,w,Qt,D,fe,ot,qe,nt,We,st,Ge,ft,ge,it,Zt,At,Wt,Pt,me;Object.defineProperty(p,"__esModule",{value:!0}),p.InkEditor=void 0,Object.defineProperty(p,"fitCurve",{enumerable:!0,get:function(){return k.fitCurve}});var _=H(1),v=H(4),k=H(24),q=H(5);const N=16,Ct=class extends v.AnnotationEditor{constructor(tt){super({...tt,name:"inkEditor"});Z(this,b);Z(this,F);Z(this,x);Z(this,$);Z(this,j);Z(this,l);Z(this,R);Z(this,B);Z(this,z);Z(this,U);Z(this,Q);Z(this,X);Z(this,pt);Z(this,c);Z(this,w);Z(this,ot);Z(this,nt);Z(this,st);Z(this,ft);Z(this,it);Z(this,At);Z(this,Pt);Z(this,h,0);Z(this,u,0);Z(this,d,0);Z(this,C,this.canvasPointermove.bind(this));Z(this,L,this.canvasPointerleave.bind(this));Z(this,m,this.canvasPointerup.bind(this));Z(this,o,this.canvasPointerdown.bind(this));Z(this,s,!1);Z(this,n,!1);Z(this,i,null);Z(this,e,null);Z(this,a,0);Z(this,t,0);Z(this,r,null);this.color=tt.color||null,this.thickness=tt.thickness||null,this.opacity=tt.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(tt){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ct=>[ct,tt.get(ct)]))}static updateDefaultParams(tt,ct){switch(tt){case _.AnnotationEditorParamsType.INK_THICKNESS:Ct._defaultThickness=ct;break;case _.AnnotationEditorParamsType.INK_COLOR:Ct._defaultColor=ct;break;case _.AnnotationEditorParamsType.INK_OPACITY:Ct._defaultOpacity=ct/100}}updateParams(tt,ct){switch(tt){case _.AnnotationEditorParamsType.INK_THICKNESS:rt(this,b,Oe).call(this,ct);break;case _.AnnotationEditorParamsType.INK_COLOR:rt(this,F,Ie).call(this,ct);break;case _.AnnotationEditorParamsType.INK_OPACITY:rt(this,x,Le).call(this,ct)}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.INK_THICKNESS,Ct._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,Ct._defaultColor||v.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*Ct._defaultOpacity)]]}get propertiesToUpdate(){var tt;return[[_.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ct._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,this.color||Ct._defaultColor||v.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((tt=this.opacity)!=null?tt:Ct._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(rt(this,Q,Kt).call(this),rt(this,X,Jt).call(this)),this.isAttachedToDOM||(this.parent.add(this),rt(this,pt,qt).call(this)),rt(this,At,Wt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,E(this,e).disconnect(),ut(this,e,null),super.remove())}enableEditMode(){!E(this,s)&&this.canvas!==null&&(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",E(this,o)),this.canvas.addEventListener("pointerup",E(this,m)))}disableEditMode(){this.isInEditMode()&&this.canvas!==null&&(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",E(this,o)),this.canvas.removeEventListener("pointerup",E(this,m)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){E(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ut(this,s,!0),this.div.classList.add("disabled"),rt(this,At,Wt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(tt){super.focusin(tt),this.enableEditMode()}canvasPointerdown(tt){tt.button===0&&this.isInEditMode()&&!E(this,s)&&(this.setInForeground(),tt.type!=="mouse"&&this.div.focus(),tt.stopPropagation(),this.canvas.addEventListener("pointerleave",E(this,L)),this.canvas.addEventListener("pointermove",E(this,C)),rt(this,l,Be).call(this,tt.offsetX,tt.offsetY))}canvasPointermove(tt){tt.stopPropagation(),rt(this,R,je).call(this,tt.offsetX,tt.offsetY)}canvasPointerup(tt){tt.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(tt.stopPropagation(),rt(this,U,ue).call(this,tt),this.setInBackground())}canvasPointerleave(tt){rt(this,U,ue).call(this,tt),this.setInBackground()}render(){if(this.div)return this.div;let tt,ct;this.width&&(tt=this.x,ct=this.y),super.render(),Ct._l10nPromise.get("editor_ink2_aria_label").then(vt=>{var bt;return(bt=this.div)==null?void 0:bt.setAttribute("aria-label",vt)});const[mt,yt,xt,St]=rt(this,$,Ne).call(this);if(this.setAt(mt,yt,0,0),this.setDims(xt,St),rt(this,Q,Kt).call(this),this.width){const[vt,bt]=this.parent.viewportBaseDimensions;this.setAt(tt*vt,ct*bt,this.width*vt,this.height*bt),ut(this,n,!0),rt(this,pt,qt).call(this),this.setDims(this.width*vt,this.height*bt),rt(this,z,Ut).call(this),rt(this,Pt,me).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return rt(this,X,Jt).call(this),this.div}setDimensions(tt,ct){const mt=Math.round(tt),yt=Math.round(ct);if(E(this,a)===mt&&E(this,t)===yt)return;ut(this,a,mt),ut(this,t,yt),this.canvas.style.visibility="hidden",E(this,h)&&Math.abs(E(this,h)-tt/ct)>.01&&(ct=Math.ceil(tt/E(this,h)),this.setDims(tt,ct));const[xt,St]=this.parent.viewportBaseDimensions;this.width=tt/xt,this.height=ct/St,E(this,s)&&rt(this,c,pe).call(this,tt,ct),rt(this,pt,qt).call(this),rt(this,z,Ut).call(this),this.canvas.style.visibility="visible"}static deserialize(tt,ct){var Bt,kt;const mt=super.deserialize(tt,ct);mt.thickness=tt.thickness,mt.color=_.Util.makeHexColor(...tt.color),mt.opacity=tt.opacity;const[yt,xt]=ct.pageDimensions,St=mt.width*yt,vt=mt.height*xt,bt=ct.scaleFactor,Rt=tt.thickness/2;ut(mt,h,St/vt),ut(mt,s,!0),ut(mt,a,Math.round(St)),ut(mt,t,Math.round(vt));for(const{bezier:Et}of tt.paths){const Dt=[];mt.paths.push(Dt);let It=bt*(Et[0]-Rt),Lt=bt*(vt-Et[1]-Rt);for(let Nt=2,Vt=Et.length;Nt<Vt;Nt+=6){const zt=bt*(Et[Nt]-Rt),$t=bt*(vt-Et[Nt+1]-Rt),Xt=bt*(Et[Nt+2]-Rt),Yt=bt*(vt-Et[Nt+3]-Rt),ve=bt*(Et[Nt+4]-Rt),ye=bt*(vt-Et[Nt+5]-Rt);Dt.push([[It,Lt],[zt,$t],[Xt,Yt],[ve,ye]]),It=ve,Lt=ye}const jt=rt(this,D,fe).call(this,Dt);mt.bezierPath2D.push(jt)}const Tt=rt(Bt=mt,ft,ge).call(Bt);return ut(mt,d,Math.max(N,Tt[2]-Tt[0])),ut(mt,u,Math.max(N,Tt[3]-Tt[1])),rt(kt=mt,c,pe).call(kt,St,vt),mt}serialize(){if(this.isEmpty())return null;const tt=this.getRect(0,0),ct=this.rotation%180==0?tt[3]-tt[1]:tt[2]-tt[0],mt=v.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:_.AnnotationEditorType.INK,color:mt,thickness:this.thickness,opacity:this.opacity,paths:rt(this,ot,qe).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,ct),pageIndex:this.parent.pageIndex,rect:tt,rotation:this.rotation}}};let A=Ct;h=new WeakMap,u=new WeakMap,d=new WeakMap,C=new WeakMap,L=new WeakMap,m=new WeakMap,o=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,e=new WeakMap,a=new WeakMap,t=new WeakMap,r=new WeakMap,b=new WeakSet,Oe=function(tt){const ct=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=tt,rt(this,At,Wt).call(this)},undo:()=>{this.thickness=ct,rt(this,At,Wt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},F=new WeakSet,Ie=function(tt){const ct=this.color;this.parent.addCommands({cmd:()=>{this.color=tt,rt(this,z,Ut).call(this)},undo:()=>{this.color=ct,rt(this,z,Ut).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Le=function(tt){tt/=100;const ct=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=tt,rt(this,z,Ut).call(this)},undo:()=>{this.opacity=ct,rt(this,z,Ut).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,Ne=function(){const{width:tt,height:ct,rotation:mt}=this.parent.viewport;switch(mt){case 90:return[0,tt,tt,ct];case 180:return[tt,ct,tt,ct];case 270:return[ct,0,tt,ct];default:return[0,0,tt,ct]}},j=new WeakSet,de=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,q.opacityToHex)(this.opacity)}`},l=new WeakSet,Be=function(tt,ct){var mt;this.isEditing=!0,E(this,n)||(ut(this,n,!0),rt(this,pt,qt).call(this),this.thickness||(this.thickness=Ct._defaultThickness),this.color||(this.color=Ct._defaultColor||v.AnnotationEditor._defaultLineColor),(mt=this.opacity)!=null||(this.opacity=Ct._defaultOpacity)),this.currentPath.push([tt,ct]),ut(this,i,null),rt(this,j,de).call(this),this.ctx.beginPath(),this.ctx.moveTo(tt,ct),ut(this,r,()=>{E(this,r)&&(E(this,i)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):rt(this,z,Ut).call(this),this.ctx.lineTo(...E(this,i)),ut(this,i,null),this.ctx.stroke()),window.requestAnimationFrame(E(this,r)))}),window.requestAnimationFrame(E(this,r))},R=new WeakSet,je=function(tt,ct){const[mt,yt]=this.currentPath.at(-1);(tt!==mt||ct!==yt)&&(this.currentPath.push([tt,ct]),ut(this,i,[tt,ct]))},B=new WeakSet,Ue=function(tt,ct){var vt;this.ctx.closePath(),ut(this,r,null),tt=Math.min(Math.max(tt,0),this.canvas.width),ct=Math.min(Math.max(ct,0),this.canvas.height);const[mt,yt]=this.currentPath.at(-1);tt===mt&&ct===yt||this.currentPath.push([tt,ct]);let xt;if(this.currentPath.length!==1)xt=(0,k.fitCurve)(this.currentPath,30,null);else{const bt=[tt,ct];xt=[[bt,bt.slice(),bt.slice(),bt]]}const St=rt(vt=Ct,D,fe).call(vt,xt);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(xt),this.bezierPath2D.push(St),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(rt(this,Q,Kt).call(this),rt(this,X,Jt).call(this)),rt(this,At,Wt).call(this))},mustExec:!0})},z=new WeakSet,Ut=function(){if(this.isEmpty()){rt(this,w,Qt).call(this);return}rt(this,j,de).call(this);const{canvas:tt,ctx:ct}=this;ct.setTransform(1,0,0,1,0,0),ct.clearRect(0,0,tt.width,tt.height),rt(this,w,Qt).call(this);for(const mt of this.bezierPath2D)ct.stroke(mt)},U=new WeakSet,ue=function(tt){rt(this,B,Ue).call(this,tt.offsetX,tt.offsetY),this.canvas.removeEventListener("pointerleave",E(this,L)),this.canvas.removeEventListener("pointermove",E(this,C)),this.parent.addToAnnotationStorage(this)},Q=new WeakSet,Kt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Ct._l10nPromise.get("editor_ink_canvas_aria_label").then(tt=>{var ct;return(ct=this.canvas)==null?void 0:ct.setAttribute("aria-label",tt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},X=new WeakSet,Jt=function(){let tt=null;ut(this,e,new ResizeObserver(ct=>{const mt=ct[0].contentRect;mt.width&&mt.height&&(tt!==null&&clearTimeout(tt),tt=setTimeout(()=>{this.fixDims(),tt=null},100),this.setDimensions(mt.width,mt.height))})),E(this,e).observe(this.div)},pt=new WeakSet,qt=function(){if(!E(this,n))return;const[tt,ct]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*tt),this.canvas.height=Math.ceil(this.height*ct),rt(this,w,Qt).call(this)},c=new WeakSet,pe=function(tt,ct){const mt=rt(this,it,Zt).call(this),yt=(tt-mt)/E(this,d),xt=(ct-mt)/E(this,u);this.scaleFactor=Math.min(yt,xt)},w=new WeakSet,Qt=function(){const tt=rt(this,it,Zt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+tt,this.translationY*this.scaleFactor+tt)},D=new WeakSet,fe=function(tt){const ct=new Path2D;for(let mt=0,yt=tt.length;mt<yt;mt++){const[xt,St,vt,bt]=tt[mt];mt===0&&ct.moveTo(...xt),ct.bezierCurveTo(St[0],St[1],vt[0],vt[1],bt[0],bt[1])}return ct},ot=new WeakSet,qe=function(tt,ct,mt,yt){const xt=[],St=this.thickness/2;let vt,bt;for(const Rt of this.paths){vt=[],bt=[];for(let Tt=0,Bt=Rt.length;Tt<Bt;Tt++){const[kt,Et,Dt,It]=Rt[Tt],Lt=tt*(kt[0]+ct)+St,jt=yt-tt*(kt[1]+mt)-St,Nt=tt*(Et[0]+ct)+St,Vt=yt-tt*(Et[1]+mt)-St,zt=tt*(Dt[0]+ct)+St,$t=yt-tt*(Dt[1]+mt)-St,Xt=tt*(It[0]+ct)+St,Yt=yt-tt*(It[1]+mt)-St;Tt===0&&(vt.push(Lt,jt),bt.push(Lt,jt)),vt.push(Nt,Vt,zt,$t,Xt,Yt),rt(this,nt,We).call(this,Lt,jt,Nt,Vt,zt,$t,Xt,Yt,4,bt)}xt.push({bezier:vt,points:bt})}return xt},nt=new WeakSet,We=function(tt,ct,mt,yt,xt,St,vt,bt,Rt,Tt){if(rt(this,st,Ge).call(this,tt,ct,mt,yt,xt,St,vt,bt))Tt.push(vt,bt);else{for(let Bt=1;Bt<Rt-1;Bt++){const kt=Bt/Rt,Et=1-kt;let Dt=kt*tt+Et*mt,It=kt*ct+Et*yt,Lt=kt*mt+Et*xt,jt=kt*yt+Et*St;Dt=kt*Dt+Et*Lt,It=kt*It+Et*jt,Lt=kt*Lt+Et*(kt*xt+Et*vt),jt=kt*jt+Et*(kt*St+Et*bt),Dt=kt*Dt+Et*Lt,It=kt*It+Et*jt,Tt.push(Dt,It)}Tt.push(vt,bt)}},st=new WeakSet,Ge=function(tt,ct,mt,yt,xt,St,vt,bt){const Rt=(3*mt-2*tt-vt)**2,Tt=(3*yt-2*ct-bt)**2,Bt=(3*xt-tt-2*vt)**2,kt=(3*St-ct-2*bt)**2;return Math.max(Rt,Bt)+Math.max(Tt,kt)<=10},ft=new WeakSet,ge=function(){let tt=1/0,ct=-1/0,mt=1/0,yt=-1/0;for(const xt of this.paths)for(const[St,vt,bt,Rt]of xt){const Tt=_.Util.bezierBoundingBox(...St,...vt,...bt,...Rt);tt=Math.min(tt,Tt[0]),mt=Math.min(mt,Tt[1]),ct=Math.max(ct,Tt[2]),yt=Math.max(yt,Tt[3])}return[tt,mt,ct,yt]},it=new WeakSet,Zt=function(){return E(this,s)?Math.ceil(this.thickness*this.parent.scaleFactor):0},At=new WeakSet,Wt=function(tt=!1){if(this.isEmpty())return;if(!E(this,s)){rt(this,z,Ut).call(this);return}const ct=rt(this,ft,ge).call(this),mt=rt(this,it,Zt).call(this);ut(this,d,Math.max(N,ct[2]-ct[0])),ut(this,u,Math.max(N,ct[3]-ct[1]));const yt=Math.ceil(mt+E(this,d)*this.scaleFactor),xt=Math.ceil(mt+E(this,u)*this.scaleFactor),[St,vt]=this.parent.viewportBaseDimensions;this.width=yt/St,this.height=xt/vt,ut(this,h,yt/xt),rt(this,Pt,me).call(this);const bt=this.translationX,Rt=this.translationY;this.translationX=-ct[0],this.translationY=-ct[1],rt(this,pt,qt).call(this),rt(this,z,Ut).call(this),ut(this,a,yt),ut(this,t,xt),this.setDims(yt,xt);const Tt=tt?mt/this.scaleFactor/2:0;this.translate(bt-this.translationX-Tt,Rt-this.translationY-Tt)},Pt=new WeakSet,me=function(){const{style:tt}=this.div;E(this,h)>=1?(tt.minHeight="16px",tt.minWidth=`${Math.round(E(this,h)*N)}px`):(tt.minWidth="16px",tt.minHeight=`${Math.round(N/E(this,h))}px`)},Z(A,D),wt(A,"_defaultColor",null),wt(A,"_defaultOpacity",1),wt(A,"_defaultThickness",1),wt(A,"_l10nPromise"),wt(A,"_type","ink"),p.InkEditor=A},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.fitCurve=void 0;const _=H(25);p.fitCurve=_},Y=>{function p(u,d,C,L,m){var o,s,n,i,e,a,t,r,b,y,F,S,x;if(u.length===2)return S=A.vectorLen(A.subtract(u[0],u[1]))/3,[o=[u[0],A.addArrays(u[0],A.mulItems(d,S)),A.addArrays(u[1],A.mulItems(C,S)),u[1]]];if(s=function($){var K,j,f,l=[];return $.forEach((T,R)=>{K=R?j+A.vectorLen(A.subtract(T,f)):0,l.push(K),j=K,f=T}),l=l.map(T=>T/j)}(u),[o,i,a]=H(u,s,s,d,C,m),i===0||i<L)return[o];if(i<L*L)for(n=s,e=i,t=a,x=0;x<20;x++){if(n=_(o,u,n),[o,i,a]=H(u,s,n,d,C,m),i<L)return[o];if(a===t){let I=i/e;if(I>.9999&&I<1.0001)break}e=i,t=a}return F=[],(r=A.subtract(u[a-1],u[a+1])).every(I=>I===0)&&(r=A.subtract(u[a-1],u[a]),[r[0],r[1]]=[-r[1],r[0]]),b=A.normalize(r),y=A.mulItems(b,-1),F=(F=F.concat(p(u.slice(0,a+1),d,b,L,m))).concat(p(u.slice(a),y,C,L,m))}function H(u,d,C,L,m,o){var s,n,i;return s=function(a,t,r,b){var y,F,S,x,I,$,K,j,f,l,T,R,O,B,P,z,G,U=a[0],J=a[a.length-1];for(y=[U,null,null,J],F=A.zeros_Xx2x2(t.length),O=0,B=t.length;O<B;O++)G=1-(z=t[O]),(S=F[O])[0]=A.mulItems(r,3*z*(G*G)),S[1]=A.mulItems(b,3*G*(z*z));for(x=[[0,0],[0,0]],I=[0,0],O=0,B=a.length;O<B;O++)z=t[O],S=F[O],x[0][0]+=A.dot(S[0],S[0]),x[0][1]+=A.dot(S[0],S[1]),x[1][0]+=A.dot(S[0],S[1]),x[1][1]+=A.dot(S[1],S[1]),P=A.subtract(a[O],h.q([U,U,J,J],z)),I[0]+=A.dot(S[0],P),I[1]+=A.dot(S[1],P);return $=x[0][0]*x[1][1]-x[1][0]*x[0][1],K=x[0][0]*I[1]-x[1][0]*I[0],j=I[0]*x[1][1]-I[1]*x[0][1],f=$===0?0:j/$,l=$===0?0:K/$,R=A.vectorLen(A.subtract(U,J)),f<(T=1e-6*R)||l<T?(y[1]=A.addArrays(U,A.mulItems(r,R/3)),y[2]=A.addArrays(J,A.mulItems(b,R/3))):(y[1]=A.addArrays(U,A.mulItems(r,f)),y[2]=A.addArrays(J,A.mulItems(b,l))),y}(u,C,L,m),[n,i]=function(a,t,r){var b,y,F,S,x,I,$,K;y=0,F=Math.floor(a.length/2);const j=k(t,10);for(x=0,I=a.length;x<I;x++)$=a[x],K=q(t,r[x],j,10),(b=(S=A.subtract(h.q(t,K),$))[0]*S[0]+S[1]*S[1])>y&&(y=b,F=x);return[y,F]}(u,s,d),o&&o({bez:s,points:u,params:d,maxErr:n,maxPoint:i}),[s,n,i]}function _(u,d,C){return C.map((L,m)=>v(u,d[m],L))}function v(u,d,C){var L=A.subtract(h.q(u,C),d),m=h.qprime(u,C),o=A.mulMatrix(L,m),s=A.sum(A.squareItems(m))+2*A.mulMatrix(L,h.qprimeprime(u,C));return s===0?C:C-o/s}var k=function(u,d){for(var C,L=[0],m=u[0],o=0,s=1;s<=d;s++)C=h.q(u,s/d),o+=A.vectorLen(A.subtract(C,m)),L.push(o),m=C;return L=L.map(n=>n/o)};function q(u,d,C,L){if(d<0)return 0;if(d>1)return 1;for(var m,o,s,n,i=1;i<=L;i++)if(d<=C[i]){s=(i-1)/L,o=i/L,n=(d-(m=C[i-1]))/(C[i]-m)*(o-s)+s;break}return n}function N(u,d){return A.normalize(A.subtract(u,d))}class A{static zeros_Xx2x2(d){for(var C=[];d--;)C.push([0,0]);return C}static mulItems(d,C){return d.map(L=>L*C)}static mulMatrix(d,C){return d.reduce((L,m,o)=>L+m*C[o],0)}static subtract(d,C){return d.map((L,m)=>L-C[m])}static addArrays(d,C){return d.map((L,m)=>L+C[m])}static addItems(d,C){return d.map(L=>L+C)}static sum(d){return d.reduce((C,L)=>C+L)}static dot(d,C){return A.mulMatrix(d,C)}static vectorLen(d){return Math.hypot(...d)}static divItems(d,C){return d.map(L=>L/C)}static squareItems(d){return d.map(C=>C*C)}static normalize(d){return this.divItems(d,this.vectorLen(d))}}class h{static q(d,C){var L=1-C,m=A.mulItems(d[0],L*L*L),o=A.mulItems(d[1],3*L*L*C),s=A.mulItems(d[2],3*L*C*C),n=A.mulItems(d[3],C*C*C);return A.addArrays(A.addArrays(m,o),A.addArrays(s,n))}static qprime(d,C){var L=1-C,m=A.mulItems(A.subtract(d[1],d[0]),3*L*L),o=A.mulItems(A.subtract(d[2],d[1]),6*L*C),s=A.mulItems(A.subtract(d[3],d[2]),3*C*C);return A.addArrays(A.addArrays(m,o),s)}static qprimeprime(d,C){return A.addArrays(A.mulItems(A.addArrays(A.subtract(d[2],A.mulItems(d[1],2)),d[0]),6*(1-C)),A.mulItems(A.addArrays(A.subtract(d[3],A.mulItems(d[2],2)),d[1]),6*C))}}Y.exports=function(d,C,L){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(n=>{if(!Array.isArray(n)||n.some(i=>typeof i!="number")||n.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(d=d.filter((n,i)=>i===0||!n.every((e,a)=>e===d[i-1][a]))).length<2)return[];const m=d.length,o=N(d[1],d[0]),s=N(d[m-2],d[m-1]);return p(d,o,s,C,L)},Y.exports.fitCubic=p,Y.exports.createTangent=N},(Y,p,H)=>{var P,He,U,_e,Q,be,X,Ae;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationLayer=void 0;var _=H(1),v=H(6),k=H(3),q=H(27),N=H(28);const A=1e3,h=new WeakSet;function u(ht){return{width:ht[2]-ht[0],height:ht[3]-ht[1]}}class d{static create(c){switch(c.data.annotationType){case _.AnnotationType.LINK:return new L(c);case _.AnnotationType.TEXT:return new m(c);case _.AnnotationType.WIDGET:switch(c.data.fieldType){case"Tx":return new s(c);case"Btn":return c.data.radioButton?new i(c):c.data.checkBox?new n(c):new e(c);case"Ch":return new a(c)}return new o(c);case _.AnnotationType.POPUP:return new t(c);case _.AnnotationType.FREETEXT:return new b(c);case _.AnnotationType.LINE:return new y(c);case _.AnnotationType.SQUARE:return new F(c);case _.AnnotationType.CIRCLE:return new S(c);case _.AnnotationType.POLYLINE:return new x(c);case _.AnnotationType.CARET:return new $(c);case _.AnnotationType.INK:return new K(c);case _.AnnotationType.POLYGON:return new I(c);case _.AnnotationType.HIGHLIGHT:return new j(c);case _.AnnotationType.UNDERLINE:return new f(c);case _.AnnotationType.SQUIGGLY:return new l(c);case _.AnnotationType.STRIKEOUT:return new T(c);case _.AnnotationType.STAMP:return new R(c);case _.AnnotationType.FILEATTACHMENT:return new O(c);default:return new C(c)}}}class C{constructor(c,{isRenderable:g=!1,ignoreBorder:w=!1,createQuadrilaterals:M=!1}={}){this.isRenderable=g,this.data=c.data,this.layer=c.layer,this.page=c.page,this.viewport=c.viewport,this.linkService=c.linkService,this.downloadManager=c.downloadManager,this.imageResourcesPath=c.imageResourcesPath,this.renderForms=c.renderForms,this.svgFactory=c.svgFactory,this.annotationStorage=c.annotationStorage,this.enableScripting=c.enableScripting,this.hasJSActions=c.hasJSActions,this._fieldObjects=c.fieldObjects,this._mouseState=c.mouseState,g&&(this.container=this._createContainer(w)),M&&(this.quadrilaterals=this._createQuadrilaterals(w))}_createContainer(c=!1){const g=this.data,w=this.page,M=this.viewport,D=document.createElement("section"),{width:V,height:ot}=u(g.rect),[et,nt,gt,st]=M.viewBox,lt=gt-et,ft=st-nt;D.setAttribute("data-annotation-id",g.id);const W=_.Util.normalizeRect([g.rect[0],w.view[3]-g.rect[1]+w.view[1],g.rect[2],w.view[3]-g.rect[3]+w.view[1]]);if(!c&&g.borderStyle.width>0){D.style.borderWidth=`${g.borderStyle.width}px`;const _t=g.borderStyle.horizontalCornerRadius,At=g.borderStyle.verticalCornerRadius;if(_t>0||At>0){const Pt=`calc(${_t}px * var(--scale-factor)) / calc(${At}px * var(--scale-factor))`;D.style.borderRadius=Pt}else if(this instanceof i){const Pt=`calc(${V}px * var(--scale-factor)) / calc(${ot}px * var(--scale-factor))`;D.style.borderRadius=Pt}switch(g.borderStyle.style){case _.AnnotationBorderStyleType.SOLID:D.style.borderStyle="solid";break;case _.AnnotationBorderStyleType.DASHED:D.style.borderStyle="dashed";break;case _.AnnotationBorderStyleType.BEVELED:(0,_.warn)("Unimplemented border style: beveled");break;case _.AnnotationBorderStyleType.INSET:(0,_.warn)("Unimplemented border style: inset");break;case _.AnnotationBorderStyleType.UNDERLINE:D.style.borderBottomStyle="solid"}const Ft=g.borderColor||null;Ft?D.style.borderColor=_.Util.makeHexColor(0|Ft[0],0|Ft[1],0|Ft[2]):D.style.borderWidth=0}D.style.left=100*(W[0]-et)/lt+"%",D.style.top=100*(W[1]-nt)/ft+"%";const{rotation:it}=g;return g.hasOwnCanvas||it===0?(D.style.width=100*V/lt+"%",D.style.height=100*ot/ft+"%"):this.setRotation(it,D),D}setRotation(c,g=this.container){const[w,M,D,V]=this.viewport.viewBox,ot=D-w,et=V-M,{width:nt,height:gt}=u(this.data.rect);let st,lt;c%180==0?(st=100*nt/ot,lt=100*gt/et):(st=100*gt/ot,lt=100*nt/et),g.style.width=`${st}%`,g.style.height=`${lt}%`,g.setAttribute("data-main-rotation",(360-c)%360)}get _commonActions(){const c=(g,w,M)=>{const D=M.detail[g];M.target.style[w]=q.ColorConverters[`${D[0]}_HTML`](D.slice(1))};return(0,_.shadow)(this,"_commonActions",{display:g=>{const w=g.detail.display%2==1;this.container.style.visibility=w?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:w,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{c("bgColor","backgroundColor",g)},fillColor:g=>{c("fillColor","backgroundColor",g)},fgColor:g=>{c("fgColor","color",g)},textColor:g=>{c("textColor","color",g)},borderColor:g=>{c("borderColor","borderColor",g)},strokeColor:g=>{c("strokeColor","borderColor",g)},rotation:g=>{const w=g.detail.rotation;this.setRotation(w),this.annotationStorage.setValue(this.data.id,{rotation:w})}})}_dispatchEventFromSandbox(c,g){var M;const w=this._commonActions;for(const D of Object.keys(g.detail))(M=c[D]||w[D])==null||M(g)}_setDefaultPropertiesFromJS(c){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const w=this._commonActions;for(const[M,D]of Object.entries(g)){const V=w[M];V&&(V({detail:{[M]:D},target:c}),delete g[M])}}_createQuadrilaterals(c=!1){if(!this.data.quadPoints)return null;const g=[],w=this.data.rect;for(const M of this.data.quadPoints)this.data.rect=[M[2].x,M[2].y,M[1].x,M[1].y],g.push(this._createContainer(c));return this.data.rect=w,g}_createPopup(c,g){let w=this.container;this.quadrilaterals&&(c=c||this.quadrilaterals,w=this.quadrilaterals[0]),c||((c=document.createElement("div")).className="popupTriggerArea",w.append(c));const M=new r({container:w,trigger:c,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();M.style.left="100%",w.append(M)}_renderQuadrilaterals(c){for(const g of this.quadrilaterals)g.className=c;return this.quadrilaterals}render(){(0,_.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(c,g=null){const w=[];if(this._fieldObjects){const M=this._fieldObjects[c];if(M)for(const{page:D,id:V,exportValues:ot}of M){if(D===-1||V===g)continue;const et=typeof ot=="string"?ot:null,nt=document.querySelector(`[data-element-id="${V}"]`);!nt||h.has(nt)?w.push({id:V,exportValue:et,domElement:nt}):(0,_.warn)(`_getElementsByName - element not allowed: ${V}`)}return w}for(const M of document.getElementsByName(c)){const{exportValue:D}=M,V=M.getAttribute("data-element-id");V!==g&&h.has(M)&&w.push({id:V,exportValue:D,domElement:M})}return w}static get platform(){const c=typeof navigator<"u"?navigator.platform:"";return(0,_.shadow)(this,"platform",{isWin:c.includes("Win"),isMac:c.includes("Mac")})}}class L extends C{constructor(g,w=null){super(g,{isRenderable:!0,ignoreBorder:!!(w!=null&&w.ignoreBorder),createQuadrilaterals:!0});Z(this,P);this.isTooltipOnly=g.data.isTooltipOnly}render(){const{data:g,linkService:w}=this,M=document.createElement("a");M.setAttribute("data-element-id",g.id);let D=!1;return g.url?(w.addLinkAttributes(M,g.url,g.newWindow),D=!0):g.action?(this._bindNamedAction(M,g.action),D=!0):g.attachment?(this._bindAttachment(M,g.attachment),D=!0):g.setOCGState?(rt(this,P,He).call(this,M,g.setOCGState),D=!0):g.dest?(this._bindLink(M,g.dest),D=!0):(g.actions&&(g.actions.Action||g.actions["Mouse Up"]||g.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(M,g),D=!0),g.resetForm?(this._bindResetFormAction(M,g.resetForm),D=!0):this.isTooltipOnly&&!D&&(this._bindLink(M,""),D=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((V,ot)=>{const et=ot===0?M:M.cloneNode();return V.append(et),V}):(this.container.className="linkAnnotation",D&&this.container.append(M),this.container)}_bindLink(g,w){g.href=this.linkService.getDestinationHash(w),g.onclick=()=>(w&&this.linkService.goToDestination(w),!1),(w||w==="")&&(g.className="internalLink")}_bindNamedAction(g,w){g.href=this.linkService.getAnchorUrl(""),g.onclick=()=>(this.linkService.executeNamedAction(w),!1),g.className="internalLink"}_bindAttachment(g,w){g.href=this.linkService.getAnchorUrl(""),g.onclick=()=>{var M;return(M=this.downloadManager)==null||M.openOrDownloadData(this.container,w.content,w.filename),!1},g.className="internalLink"}_bindJSAction(g,w){g.href=this.linkService.getAnchorUrl("");const M=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const D of Object.keys(w.actions)){const V=M.get(D);V&&(g[V]=()=>{var ot;return(ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:w.id,name:D}}),!1})}g.onclick||(g.onclick=()=>!1),g.className="internalLink"}_bindResetFormAction(g,w){const M=g.onclick;M||(g.href=this.linkService.getAnchorUrl("")),g.className="internalLink",this._fieldObjects?g.onclick=()=>{var st;M==null||M();const{fields:D,refs:V,include:ot}=w,et=[];if(D.length!==0||V.length!==0){const lt=new Set(V);for(const ft of D){const W=this._fieldObjects[ft]||[];for(const{id:it}of W)lt.add(it)}for(const ft of Object.values(this._fieldObjects))for(const W of ft)lt.has(W.id)===ot&&et.push(W)}else for(const lt of Object.values(this._fieldObjects))et.push(...lt);const nt=this.annotationStorage,gt=[];for(const lt of et){const{id:ft}=lt;switch(gt.push(ft),lt.type){case"text":{const it=lt.defaultValue||"";nt.setValue(ft,{value:it});break}case"checkbox":case"radiobutton":{const it=lt.defaultValue===lt.exportValues;nt.setValue(ft,{value:it});break}case"combobox":case"listbox":{const it=lt.defaultValue||"";nt.setValue(ft,{value:it});break}default:continue}const W=document.querySelector(`[data-element-id="${ft}"]`);W&&(h.has(W)?W.dispatchEvent(new Event("resetform")):(0,_.warn)(`_bindResetFormAction - element not allowed: ${ft}`))}return this.enableScripting&&((st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:gt,name:"ResetForm"}})),!1}:((0,_.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),M||(g.onclick=()=>!1))}}P=new WeakSet,He=function(g,w){g.href=this.linkService.getAnchorUrl(""),g.onclick=()=>(this.linkService.executeSetOCGState(w),!1),g.className="internalLink"};class m extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str))})}render(){this.container.className="textAnnotation";const c=document.createElement("img");return c.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",c.alt="[{{type}} Annotation]",c.dataset.l10nId="text_annotation_type",c.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(c,this.data),this.container.append(c),this.container}}class o extends C{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(c){const{isWin:g,isMac:w}=C.platform;return g&&c.ctrlKey||w&&c.metaKey}_setEventListener(c,g,w,M){g.includes("mouse")?c.addEventListener(g,D=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:w,value:M(D),shift:D.shiftKey,modifier:this._getKeyModifier(D)}})}):c.addEventListener(g,D=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:w,value:M(D)}})})}_setEventListeners(c,g,w){var M;for(const[D,V]of g)(V==="Action"||((M=this.data.actions)==null?void 0:M[V]))&&this._setEventListener(c,D,V,w)}_setBackgroundColor(c){const g=this.data.backgroundColor||null;c.style.backgroundColor=g===null?"transparent":_.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(c){const g=["left","center","right"],{fontColor:w}=this.data.defaultAppearanceData,M=this.data.defaultAppearanceData.fontSize||9,D=c.style;let V;const ot=et=>Math.round(10*et)/10;if(this.data.multiLine){const et=Math.abs(this.data.rect[3]-this.data.rect[1]-2),nt=et/(Math.round(et/(_.LINE_FACTOR*M))||1);V=Math.min(M,ot(nt/_.LINE_FACTOR))}else{const et=Math.abs(this.data.rect[3]-this.data.rect[1]-2);V=Math.min(M,ot(et/_.LINE_FACTOR))}D.fontSize=`calc(${V}px * var(--scale-factor))`,D.color=_.Util.makeHexColor(w[0],w[1],w[2]),this.data.textAlignment!==null&&(D.textAlign=g[this.data.textAlignment])}_setRequired(c,g){g?c.setAttribute("required",!0):c.removeAttribute("required"),c.setAttribute("aria-required",g)}}class s extends o{constructor(c){super(c,{isRenderable:c.renderForms||!c.data.hasAppearance&&!!c.data.fieldValue})}setPropertyOnSiblings(c,g,w,M){const D=this.annotationStorage;for(const V of this._getElementsByName(c.name,c.id))V.domElement&&(V.domElement[g]=w),D.setValue(V.id,{[M]:w})}render(){var M;const c=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let w=null;if(this.renderForms){const D=c.getValue(g,{value:this.data.fieldValue});let V=D.formattedValue||D.value||"";const ot=c.getValue(g,{charLimit:this.data.maxLen}).charLimit;ot&&V.length>ot&&(V=V.slice(0,ot));const et={userValue:V,formattedValue:null,valueOnFocus:""};this.data.multiLine?(w=document.createElement("textarea"),w.textContent=V,this.data.doNotScroll&&(w.style.overflowY="hidden")):(w=document.createElement("input"),w.type="text",w.setAttribute("value",V),this.data.doNotScroll&&(w.style.overflowX="hidden")),h.add(w),w.setAttribute("data-element-id",g),w.disabled=this.data.readOnly,w.name=this.data.fieldName,w.tabIndex=A,this._setRequired(w,this.data.required),ot&&(w.maxLength=ot),w.addEventListener("input",gt=>{c.setValue(g,{value:gt.target.value}),this.setPropertyOnSiblings(w,"value",gt.target.value,"value")}),w.addEventListener("resetform",gt=>{var lt;const st=(lt=this.data.defaultFieldValue)!=null?lt:"";w.value=et.userValue=st,et.formattedValue=null});let nt=gt=>{const{formattedValue:st}=et;st!=null&&(gt.target.value=st),gt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){w.addEventListener("focus",st=>{et.userValue&&(st.target.value=et.userValue),et.valueOnFocus=st.target.value}),w.addEventListener("updatefromsandbox",st=>{const lt={value(ft){var W;et.userValue=(W=ft.detail.value)!=null?W:"",c.setValue(g,{value:et.userValue.toString()}),ft.target.value=et.userValue},formattedValue(ft){const{formattedValue:W}=ft.detail;et.formattedValue=W,W!=null&&ft.target!==document.activeElement&&(ft.target.value=W),c.setValue(g,{formattedValue:W})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var At;const{charLimit:W}=ft.detail,{target:it}=ft;if(W===0){it.removeAttribute("maxLength");return}it.setAttribute("maxLength",W);let _t=et.userValue;_t&&!(_t.length<=W)&&(_t=_t.slice(0,W),it.value=et.userValue=_t,c.setValue(g,{value:_t}),(At=this.linkService.eventBus)==null||At.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:_t,willCommit:!0,commitKey:1,selStart:it.selectionStart,selEnd:it.selectionEnd}}))}};this._dispatchEventFromSandbox(lt,st)}),w.addEventListener("keydown",st=>{var W;let lt=-1;if(st.key==="Escape"?lt=0:st.key!=="Enter"||this.data.multiLine?st.key==="Tab"&&(lt=3):lt=2,lt===-1)return;const{value:ft}=st.target;et.valueOnFocus!==ft&&(et.userValue=ft,(W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ft,willCommit:!0,commitKey:lt,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}))});const gt=nt;nt=null,w.addEventListener("blur",st=>{var ft;const{value:lt}=st.target;et.userValue=lt,this._mouseState.isDown&&et.valueOnFocus!==lt&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:lt,willCommit:!0,commitKey:1,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}})),gt(st)}),(M=this.data.actions)!=null&&M.Keystroke&&w.addEventListener("beforeinput",st=>{var Pt;const{data:lt,target:ft}=st,{value:W,selectionStart:it,selectionEnd:_t}=ft;let At=it,Ft=_t;switch(st.inputType){case"deleteWordBackward":{const Mt=W.substring(0,it).match(/\w*[^\w]*$/);Mt&&(At-=Mt[0].length);break}case"deleteWordForward":{const Mt=W.substring(it).match(/^[^\w]*\w*/);Mt&&(Ft+=Mt[0].length);break}case"deleteContentBackward":it===_t&&(At-=1);break;case"deleteContentForward":it===_t&&(Ft+=1)}st.preventDefault(),(Pt=this.linkService.eventBus)==null||Pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:W,change:lt||"",willCommit:!1,selStart:At,selEnd:Ft}})}),this._setEventListeners(w,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.value)}if(nt&&w.addEventListener("blur",nt),this.data.comb){const gt=(this.data.rect[2]-this.data.rect[0])/ot;w.classList.add("comb"),w.style.letterSpacing=`calc(${gt}px * var(--scale-factor) - 1ch)`}}else w=document.createElement("div"),w.textContent=this.data.fieldValue,w.style.verticalAlign="middle",w.style.display="table-cell";return this._setTextStyle(w),this._setBackgroundColor(w),this._setDefaultPropertiesFromJS(w),this.container.append(w),this.container}}class n extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){const c=this.annotationStorage,g=this.data,w=g.id;let M=c.getValue(w,{value:g.exportValue===g.fieldValue}).value;typeof M=="string"&&(M=M!=="Off",c.setValue(w,{value:M})),this.container.className="buttonWidgetAnnotation checkBox";const D=document.createElement("input");return h.add(D),D.setAttribute("data-element-id",w),D.disabled=g.readOnly,this._setRequired(D,this.data.required),D.type="checkbox",D.name=g.fieldName,M&&D.setAttribute("checked",!0),D.setAttribute("exportValue",g.exportValue),D.tabIndex=A,D.addEventListener("change",V=>{const{name:ot,checked:et}=V.target;for(const nt of this._getElementsByName(ot,w)){const gt=et&&nt.exportValue===g.exportValue;nt.domElement&&(nt.domElement.checked=gt),c.setValue(nt.id,{value:gt})}c.setValue(w,{value:et})}),D.addEventListener("resetform",V=>{const ot=g.defaultFieldValue||"Off";V.target.checked=ot===g.exportValue}),this.enableScripting&&this.hasJSActions&&(D.addEventListener("updatefromsandbox",V=>{const ot={value(et){et.target.checked=et.detail.value!=="Off",c.setValue(w,{value:et.target.checked})}};this._dispatchEventFromSandbox(ot,V)}),this._setEventListeners(D,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.checked)),this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class i extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const c=this.annotationStorage,g=this.data,w=g.id;let M=c.getValue(w,{value:g.fieldValue===g.buttonValue}).value;typeof M=="string"&&(M=M!==g.buttonValue,c.setValue(w,{value:M}));const D=document.createElement("input");if(h.add(D),D.setAttribute("data-element-id",w),D.disabled=g.readOnly,this._setRequired(D,this.data.required),D.type="radio",D.name=g.fieldName,M&&D.setAttribute("checked",!0),D.tabIndex=A,D.addEventListener("change",V=>{const{name:ot,checked:et}=V.target;for(const nt of this._getElementsByName(ot,w))c.setValue(nt.id,{value:!1});c.setValue(w,{value:et})}),D.addEventListener("resetform",V=>{const ot=g.defaultFieldValue;V.target.checked=ot!=null&&ot===g.buttonValue}),this.enableScripting&&this.hasJSActions){const V=g.buttonValue;D.addEventListener("updatefromsandbox",ot=>{const et={value:nt=>{const gt=V===nt.detail.value;for(const st of this._getElementsByName(nt.target.name)){const lt=gt&&st.id===w;st.domElement&&(st.domElement.checked=lt),c.setValue(st.id,{value:lt})}}};this._dispatchEventFromSandbox(et,ot)}),this._setEventListeners(D,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ot=>ot.target.checked)}return this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class e extends L{constructor(c){super(c,{ignoreBorder:c.data.hasAppearance})}render(){const c=super.render();c.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(c.title=this.data.alternativeText);const g=c.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",w=>{this._dispatchEventFromSandbox({},w)})),c}}class a extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const c=this.annotationStorage,g=this.data.id,w=c.getValue(g,{value:this.data.fieldValue}),M=document.createElement("select");h.add(M),M.setAttribute("data-element-id",g),M.disabled=this.data.readOnly,this._setRequired(M,this.data.required),M.name=this.data.fieldName,M.tabIndex=A;let D=this.data.combo&&this.data.options.length>0;this.data.combo||(M.size=this.data.options.length,this.data.multiSelect&&(M.multiple=!0)),M.addEventListener("resetform",nt=>{const gt=this.data.defaultFieldValue;for(const st of M.options)st.selected=st.value===gt});for(const nt of this.data.options){const gt=document.createElement("option");gt.textContent=nt.displayValue,gt.value=nt.exportValue,w.value.includes(nt.exportValue)&&(gt.setAttribute("selected",!0),D=!1),M.append(gt)}let V=null;if(D){const nt=document.createElement("option");nt.value=" ",nt.setAttribute("hidden",!0),nt.setAttribute("selected",!0),M.prepend(nt),V=()=>{nt.remove(),M.removeEventListener("input",V),V=null},M.addEventListener("input",V)}const ot=(nt,gt)=>{const st=gt?"value":"textContent",lt=nt.target.options;return nt.target.multiple?Array.prototype.filter.call(lt,ft=>ft.selected).map(ft=>ft[st]):lt.selectedIndex===-1?null:lt[lt.selectedIndex][st]},et=nt=>{const gt=nt.target.options;return Array.prototype.map.call(gt,st=>({displayValue:st.textContent,exportValue:st.value}))};return this.enableScripting&&this.hasJSActions?(M.addEventListener("updatefromsandbox",nt=>{const gt={value(st){V==null||V();const lt=st.detail.value,ft=new Set(Array.isArray(lt)?lt:[lt]);for(const W of M.options)W.selected=ft.has(W.value);c.setValue(g,{value:ot(st,!0)})},multipleSelection(st){M.multiple=!0},remove(st){const lt=M.options,ft=st.detail.remove;lt[ft].selected=!1,M.remove(ft),lt.length>0&&Array.prototype.findIndex.call(lt,W=>W.selected)===-1&&(lt[0].selected=!0),c.setValue(g,{value:ot(st,!0),items:et(st)})},clear(st){for(;M.length!==0;)M.remove(0);c.setValue(g,{value:null,items:[]})},insert(st){const{index:lt,displayValue:ft,exportValue:W}=st.detail.insert,it=M.children[lt],_t=document.createElement("option");_t.textContent=ft,_t.value=W,it?it.before(_t):M.append(_t),c.setValue(g,{value:ot(st,!0),items:et(st)})},items(st){const{items:lt}=st.detail;for(;M.length!==0;)M.remove(0);for(const ft of lt){const{displayValue:W,exportValue:it}=ft,_t=document.createElement("option");_t.textContent=W,_t.value=it,M.append(_t)}M.options.length>0&&(M.options[0].selected=!0),c.setValue(g,{value:ot(st,!0),items:et(st)})},indices(st){const lt=new Set(st.detail.indices);for(const ft of st.target.options)ft.selected=lt.has(ft.index);c.setValue(g,{value:ot(st,!0)})},editable(st){st.target.disabled=!st.detail.editable}};this._dispatchEventFromSandbox(gt,nt)}),M.addEventListener("input",nt=>{var lt;const gt=ot(nt,!0),st=ot(nt,!1);c.setValue(g,{value:gt}),(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:st,changeEx:gt,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(M,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],nt=>nt.target.checked)):M.addEventListener("input",function(nt){c.setValue(g,{value:ot(nt,!0)})}),this.data.combo&&this._setTextStyle(M),this._setBackgroundColor(M),this._setDefaultPropertiesFromJS(M),this.container.append(M),this.container}}const G=class extends C{constructor(c){var w,M,D;const{data:g}=c;super(c,{isRenderable:!G.IGNORE_TYPES.has(g.parentType)&&!!(((w=g.titleObj)==null?void 0:w.str)||((M=g.contentsObj)==null?void 0:M.str)||((D=g.richText)==null?void 0:D.str))})}render(){this.container.className="popupAnnotation";const c=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(c.length===0)return this.container;const g=new r({container:this.container,trigger:Array.from(c),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),w=this.page,M=_.Util.normalizeRect([this.data.parentRect[0],w.view[3]-this.data.parentRect[1]+w.view[1],this.data.parentRect[2],w.view[3]-this.data.parentRect[3]+w.view[1]]),D=M[0]+this.data.parentRect[2]-this.data.parentRect[0],V=M[1],[ot,et,nt,gt]=this.viewport.viewBox,st=nt-ot,lt=gt-et;return this.container.style.left=100*(D-ot)/st+"%",this.container.style.top=100*(V-et)/lt+"%",this.container.append(g.render()),this.container}};let t=G;wt(t,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class r{constructor(c){this.container=c.container,this.trigger=c.trigger,this.color=c.color,this.titleObj=c.titleObj,this.modificationDate=c.modificationDate,this.contentsObj=c.contentsObj,this.richText=c.richText,this.hideWrapper=c.hideWrapper||!1,this.pinned=!1}render(){var V,ot;const c=document.createElement("div");c.className="popupWrapper",this.hideElement=this.hideWrapper?c:this.container,this.hideElement.hidden=!0;const g=document.createElement("div");g.className="popup";const w=this.color;if(w){const et=.7*(255-w[0])+w[0],nt=.7*(255-w[1])+w[1],gt=.7*(255-w[2])+w[2];g.style.backgroundColor=_.Util.makeHexColor(0|et,0|nt,0|gt)}const M=document.createElement("h1");M.dir=this.titleObj.dir,M.textContent=this.titleObj.str,g.append(M);const D=v.PDFDateString.toDateObject(this.modificationDate);if(D){const et=document.createElement("span");et.className="popupDate",et.textContent="{{date}}, {{time}}",et.dataset.l10nId="annotation_date_string",et.dataset.l10nArgs=JSON.stringify({date:D.toLocaleDateString(),time:D.toLocaleTimeString()}),g.append(et)}if(!((V=this.richText)!=null&&V.str)||((ot=this.contentsObj)==null?void 0:ot.str)&&this.contentsObj.str!==this.richText.str){const et=this._formatContents(this.contentsObj);g.append(et)}else N.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:g}),g.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const et of this.trigger)et.addEventListener("click",this._toggle.bind(this)),et.addEventListener("mouseover",this._show.bind(this,!1)),et.addEventListener("mouseout",this._hide.bind(this,!1));return g.addEventListener("click",this._hide.bind(this,!0)),c.append(g),c}_formatContents({str:c,dir:g}){const w=document.createElement("p");w.className="popupContent",w.dir=g;const M=c.split(/(?:\r\n?|\n)/);for(let D=0,V=M.length;D<V;++D){const ot=M[D];w.append(document.createTextNode(ot)),D<V-1&&w.append(document.createElement("br"))}return w}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(c=!1){c&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(c=!0){c&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class b extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0}),this.textContent=c.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const c=document.createElement("div");c.className="annotationTextContent",c.setAttribute("role","comment");for(const g of this.textContent){const w=document.createElement("span");w.textContent=g,c.append(w)}this.container.append(c)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class y extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const c=this.data,{width:g,height:w}=u(c.rect),M=this.svgFactory.create(g,w,!0),D=this.svgFactory.createElement("svg:line");return D.setAttribute("x1",c.rect[2]-c.lineCoordinates[0]),D.setAttribute("y1",c.rect[3]-c.lineCoordinates[1]),D.setAttribute("x2",c.rect[2]-c.lineCoordinates[2]),D.setAttribute("y2",c.rect[3]-c.lineCoordinates[3]),D.setAttribute("stroke-width",c.borderStyle.width||1),D.setAttribute("stroke","transparent"),D.setAttribute("fill","transparent"),M.append(D),this.container.append(M),this._createPopup(D,c),this.container}}class F extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const c=this.data,{width:g,height:w}=u(c.rect),M=this.svgFactory.create(g,w,!0),D=c.borderStyle.width,V=this.svgFactory.createElement("svg:rect");return V.setAttribute("x",D/2),V.setAttribute("y",D/2),V.setAttribute("width",g-D),V.setAttribute("height",w-D),V.setAttribute("stroke-width",D||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),M.append(V),this.container.append(M),this._createPopup(V,c),this.container}}class S extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const c=this.data,{width:g,height:w}=u(c.rect),M=this.svgFactory.create(g,w,!0),D=c.borderStyle.width,V=this.svgFactory.createElement("svg:ellipse");return V.setAttribute("cx",g/2),V.setAttribute("cy",w/2),V.setAttribute("rx",g/2-D/2),V.setAttribute("ry",w/2-D/2),V.setAttribute("stroke-width",D||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),M.append(V),this.container.append(M),this._createPopup(V,c),this.container}}class x extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const c=this.data,{width:g,height:w}=u(c.rect),M=this.svgFactory.create(g,w,!0);let D=[];for(const ot of c.vertices){const et=ot.x-c.rect[0],nt=c.rect[3]-ot.y;D.push(et+","+nt)}D=D.join(" ");const V=this.svgFactory.createElement(this.svgElementName);return V.setAttribute("points",D),V.setAttribute("stroke-width",c.borderStyle.width||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),M.append(V),this.container.append(M),this._createPopup(V,c),this.container}}class I extends x{constructor(c){super(c),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class K extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const c=this.data,{width:g,height:w}=u(c.rect),M=this.svgFactory.create(g,w,!0);for(const D of c.inkLists){let V=[];for(const et of D){const nt=et.x-c.rect[0],gt=c.rect[3]-et.y;V.push(`${nt},${gt}`)}V=V.join(" ");const ot=this.svgFactory.createElement(this.svgElementName);ot.setAttribute("points",V),ot.setAttribute("stroke-width",c.borderStyle.width||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),this._createPopup(ot,c),M.append(ot)}return this.container.append(M),this.container}}class j extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class f extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class l extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class T extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class R extends C{constructor(c){var g,w,M;super(c,{isRenderable:!!(c.data.hasPopup||((g=c.data.titleObj)==null?void 0:g.str)||((w=c.data.contentsObj)==null?void 0:w.str)||((M=c.data.richText)==null?void 0:M.str)),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class O extends C{constructor(c){var M;super(c,{isRenderable:!0});const{filename:g,content:w}=this.data.file;this.filename=(0,v.getFilenameFromUrl)(g),this.content=w,(M=this.linkService.eventBus)==null||M.dispatch("fileattachmentannotation",{source:this,filename:g,content:w})}render(){var g,w;this.container.className="fileAttachmentAnnotation";const c=document.createElement("div");return c.className="popupTriggerArea",c.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((g=this.data.titleObj)==null?void 0:g.str)||((w=this.data.contentsObj)==null?void 0:w.str)||this.data.richText)&&this._createPopup(c,this.data),this.container.append(c),this.container}_download(){var c;(c=this.downloadManager)==null||c.openOrDownloadData(this.container,this.content,this.filename)}}const pt=class{static render(c){var ot,et;const{annotations:g,div:w,viewport:M,accessibilityManager:D}=c;rt(this,Q,be).call(this,w,M);let V=0;for(const nt of g){if(nt.annotationType!==_.AnnotationType.POPUP){const{width:st,height:lt}=u(nt.rect);if(st<=0||lt<=0)continue}const gt=d.create({data:nt,layer:w,page:c.page,viewport:M,linkService:c.linkService,downloadManager:c.downloadManager,imageResourcesPath:c.imageResourcesPath||"",renderForms:c.renderForms!==!1,svgFactory:new v.DOMSVGFactory,annotationStorage:c.annotationStorage||new k.AnnotationStorage,enableScripting:c.enableScripting,hasJSActions:c.hasJSActions,fieldObjects:c.fieldObjects,mouseState:c.mouseState||{isDown:!1}});if(gt.isRenderable){const st=gt.render();if(nt.hidden&&(st.style.visibility="hidden"),Array.isArray(st))for(const lt of st)lt.style.zIndex=V++,rt(ot=pt,U,_e).call(ot,lt,nt.id,w,D);else st.style.zIndex=V++,gt instanceof t?w.prepend(st):rt(et=pt,U,_e).call(et,st,nt.id,w,D)}}rt(this,X,Ae).call(this,w,c.annotationCanvasMap)}static update(c){const{annotationCanvasMap:g,div:w,viewport:M}=c;rt(this,Q,be).call(this,w,M),rt(this,X,Ae).call(this,w,g),w.hidden=!1}};let B=pt;U=new WeakSet,_e=function(c,g,w,M){const D=c.firstChild||c;D.id=`${v.AnnotationPrefix}${g}`,w.append(c),M==null||M.moveElementInDOM(w,c,D,!1)},Q=new WeakSet,be=function(c,{width:g,height:w,rotation:M}){const{style:D}=c,V=M%180!=0,ot=Math.floor(g)+"px",et=Math.floor(w)+"px";D.width=V?et:ot,D.height=V?ot:et,c.setAttribute("data-main-rotation",M)},X=new WeakSet,Ae=function(c,g){if(g){for(const[w,M]of g){const D=c.querySelector(`[data-annotation-id="${w}"]`);if(!D)continue;const{firstChild:V}=D;V?V.nodeName==="CANVAS"?V.replaceWith(M):V.before(M):D.append(M)}g.clear()}},Z(B,U),Z(B,Q),Z(B,X),p.AnnotationLayer=B},(Y,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.ColorConverters=void 0;function H(_){return Math.floor(255*Math.max(0,Math.min(1,_))).toString(16).padStart(2,"0")}p.ColorConverters=class{static CMYK_G([v,k,q,N]){return["G",1-Math.min(1,.3*v+.59*q+.11*k+N)]}static G_CMYK([v]){return["CMYK",0,0,0,1-v]}static G_RGB([v]){return["RGB",v,v,v]}static G_HTML([v]){const k=H(v);return`#${k}${k}${k}`}static RGB_G([v,k,q]){return["G",.3*v+.59*k+.11*q]}static RGB_HTML([v,k,q]){return`#${H(v)}${H(k)}${H(q)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([v,k,q,N]){return["RGB",1-Math.min(1,v+N),1-Math.min(1,q+N),1-Math.min(1,k+N)]}static CMYK_HTML(v){const k=this.CMYK_RGB(v).slice(1);return this.RGB_HTML(k)}static RGB_CMYK([v,k,q]){const N=1-v,A=1-k,h=1-q;return["CMYK",N,A,h,Math.min(N,A,h)]}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.XfaLayer=void 0;var _=H(19);p.XfaLayer=class{static setupStorage(k,q,N,A,h){const u=A.getValue(q,{value:null});switch(N.name){case"textarea":if(u.value!==null&&(k.textContent=u.value),h==="print")break;k.addEventListener("input",d=>{A.setValue(q,{value:d.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(u.value===N.attributes.xfaOn?k.setAttribute("checked",!0):u.value===N.attributes.xfaOff&&k.removeAttribute("checked"),h==="print")break;k.addEventListener("change",d=>{A.setValue(q,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(u.value!==null&&k.setAttribute("value",u.value),h==="print")break;k.addEventListener("input",d=>{A.setValue(q,{value:d.target.value})})}break;case"select":if(u.value!==null)for(const d of N.children)d.attributes.value===u.value&&(d.attributes.selected=!0);k.addEventListener("input",d=>{const C=d.target.options,L=C.selectedIndex===-1?"":C[C.selectedIndex].value;A.setValue(q,{value:L})})}}static setAttributes({html:k,element:q,storage:N=null,intent:A,linkService:h}){const{attributes:u}=q,d=k instanceof HTMLAnchorElement;u.type==="radio"&&(u.name=`${u.name}-${A}`);for(const[C,L]of Object.entries(u))if(L!=null)switch(C){case"class":L.length&&k.setAttribute(C,L.join(" "));break;case"dataId":break;case"id":k.setAttribute("data-element-id",L);break;case"style":Object.assign(k.style,L);break;case"textContent":k.textContent=L;break;default:(!d||C!=="href"&&C!=="newWindow")&&k.setAttribute(C,L)}d&&h.addLinkAttributes(k,u.href,u.newWindow),N&&u.dataId&&this.setupStorage(k,u.dataId,q,N)}static render(k){var m;const q=k.annotationStorage,N=k.linkService,A=k.xfaHtml,h=k.intent||"display",u=document.createElement(A.name);A.attributes&&this.setAttributes({html:u,element:A,intent:h,linkService:N});const d=[[A,-1,u]],C=k.div;if(C.append(u),k.viewport){const o=`matrix(${k.viewport.transform.join(",")})`;C.style.transform=o}h!=="richText"&&C.setAttribute("class","xfaLayer xfaFont");const L=[];for(;d.length>0;){const[o,s,n]=d.at(-1);if(s+1===o.children.length){d.pop();continue}const i=o.children[++d.at(-1)[1]];if(i===null)continue;const{name:e}=i;if(e==="#text"){const t=document.createTextNode(i.value);L.push(t),n.append(t);continue}let a;if(a=(m=i==null?void 0:i.attributes)!=null&&m.xmlns?document.createElementNS(i.attributes.xmlns,e):document.createElement(e),n.append(a),i.attributes&&this.setAttributes({html:a,element:i,storage:q,intent:h,linkService:N}),i.children&&i.children.length>0)d.push([i,-1,a]);else if(i.value){const t=document.createTextNode(i.value);_.XfaText.shouldBuildText(e)&&L.push(t),a.append(t)}}for(const o of C.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))o.setAttribute("readOnly",!0);return{textDivs:L}}static update(k){const q=`matrix(${k.viewport.transform.join(",")})`;k.div.style.transform=q,k.div.hidden=!1}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.TextLayerRenderTask=void 0,p.renderTextLayer=function(u){const d=new A({textContent:u.textContent,textContentStream:u.textContentStream,container:u.container,viewport:u.viewport,textDivs:u.textDivs,textContentItemsStr:u.textContentItemsStr});return d._render(u.timeout),d};var _=H(1);const v=30,k=new Map;function q(h,u,d,C){const L=document.createElement("span"),m={angle:0,canvasWidth:0,hasText:u.str!=="",hasEOL:u.hasEOL,fontSize:0};h._textDivs.push(L);const o=_.Util.transform(h._viewport.transform,u.transform);let s=Math.atan2(o[1],o[0]);const n=d[u.fontName];n.vertical&&(s+=Math.PI/2);const i=Math.hypot(o[2],o[3]),e=i*function(y,F){const S=k.get(y);if(S)return S;F.save(),F.font=`30px ${y}`;const x=F.measureText("");let I=x.fontBoundingBoxAscent,$=Math.abs(x.fontBoundingBoxDescent);if(I){F.restore();const j=I/(I+$);return k.set(y,j),j}F.strokeStyle="red",F.clearRect(0,0,v,v),F.strokeText("g",0,0);let K=F.getImageData(0,0,v,v).data;$=0;for(let j=K.length-1-3;j>=0;j-=4)if(K[j]>0){$=Math.ceil(j/4/v);break}F.clearRect(0,0,v,v),F.strokeText("A",0,v),K=F.getImageData(0,0,v,v).data,I=0;for(let j=0,f=K.length;j<f;j+=4)if(K[j]>0){I=v-Math.floor(j/4/v);break}if(F.restore(),I){const j=I/(I+$);return k.set(y,j),j}return k.set(y,.8),.8}(n.fontFamily,C);let a,t;s===0?(a=o[4],t=o[5]-e):(a=o[4]+e*Math.sin(s),t=o[5]-e*Math.cos(s)),L.style.left=`${a}px`,L.style.top=`${t}px`,L.style.fontSize=`${i}px`,L.style.fontFamily=n.fontFamily,m.fontSize=i,L.setAttribute("role","presentation"),L.textContent=u.str,L.dir=u.dir,h._fontInspectorEnabled&&(L.dataset.fontName=u.fontName),s!==0&&(m.angle=s*(180/Math.PI));let r=!1;if(u.str.length>1)r=!0;else if(u.str!==" "&&u.transform[0]!==u.transform[3]){const b=Math.abs(u.transform[0]),y=Math.abs(u.transform[3]);b!==y&&Math.max(b,y)/Math.min(b,y)>1.5&&(r=!0)}r&&(n.vertical?m.canvasWidth=u.height*h._viewport.scale:m.canvasWidth=u.width*h._viewport.scale),h._textDivProperties.set(L,m),h._textContentStream&&h._layoutText(L)}function N(h){if(h._canceled)return;const u=h._textDivs,d=h._capability;if(u.length>1e5)h._renderingDone=!0,d.resolve();else{if(!h._textContentStream)for(const C of u)h._layoutText(C);h._renderingDone=!0,d.resolve()}}class A{constructor({textContent:u,textContentStream:d,container:C,viewport:L,textDivs:m,textContentItemsStr:o}){var s;this._textContent=u,this._textContentStream=d,this._container=C,this._document=C.ownerDocument,this._viewport=L,this._textDivs=m||[],this._textContentItemsStr=o||[],this._fontInspectorEnabled=!!((s=globalThis.FontInspector)!=null&&s.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,_.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._textDivProperties=null,this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new _.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(u,d){for(const C of u)if(C.str!==void 0)this._textContentItemsStr.push(C.str),q(this,C,d,this._layoutTextCtx);else if(C.type==="beginMarkedContentProps"||C.type==="beginMarkedContent"){const L=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),C.id!==null&&this._container.setAttribute("id",`${C.id}`),L.append(this._container)}else C.type==="endMarkedContent"&&(this._container=this._container.parentNode)}_layoutText(u){const d=this._textDivProperties.get(u);let C="";if(d.canvasWidth!==0&&d.hasText){const{fontFamily:L}=u.style,{fontSize:m}=d;(m!==this._layoutTextLastFontSize||L!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${m*this._devicePixelRatio}px ${L}`,this._layoutTextLastFontSize=m,this._layoutTextLastFontFamily=L);const{width:o}=this._layoutTextCtx.measureText(u.textContent);o>0&&(C=`scaleX(${this._devicePixelRatio*d.canvasWidth/o})`)}if(d.angle!==0&&(C=`rotate(${d.angle}deg) ${C}`),C.length>0&&(u.style.transform=C),d.hasText&&this._container.append(u),d.hasEOL){const L=document.createElement("br");L.setAttribute("role","presentation"),this._container.append(L)}}_render(u=0){const d=(0,_.createPromiseCapability)();let C=Object.create(null);const L=this._document.createElement("canvas");if(L.height=L.width=v,this._layoutTextCtx=L.getContext("2d",{alpha:!1}),this._textContent){const m=this._textContent.items,o=this._textContent.styles;this._processItems(m,o),d.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const m=()=>{this._reader.read().then(({value:o,done:s})=>{s?d.resolve():(Object.assign(C,o.styles),this._processItems(o.items,C),m())},d.reject)};this._reader=this._textContentStream.getReader(),m()}}d.promise.then(()=>{C=null,u?this._renderTimer=setTimeout(()=>{N(this),this._renderTimer=null},u):N(this)},this._capability.reject)}}p.TextLayerRenderTask=A},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.SVGGraphics=void 0;var _=H(6),v=H(1),k=H(12);let q=class{constructor(){(0,v.unreachable)("Not implemented: SVGGraphics")}};p.SVGGraphics=q;{let o=function(t){let r=[];const b=[];for(const y of t)y.fn!=="save"?y.fn==="restore"?r=b.pop():r.push(y):(r.push({fnId:92,fn:"group",items:[]}),b.push(r),r=r.at(-1).items);return r},s=function(t){if(Number.isInteger(t))return t.toString();const r=t.toFixed(10);let b=r.length-1;if(r[b]!=="0")return r;do b--;while(r[b]==="0");return r.substring(0,r[b]==="."?b:b+1)},n=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${s(t[0])} ${s(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2])return`rotate(${s(180*Math.acos(t[0])/Math.PI)})`}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${s(t[4])} ${s(t[5])})`;return`matrix(${s(t[0])} ${s(t[1])} ${s(t[2])} ${s(t[3])} ${s(t[4])} ${s(t[5])})`};const N={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},A="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",u=["butt","round","square"],d=["miter","round","bevel"],C=function(t,r="",b=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!b)return URL.createObjectURL(new Blob([t],{type:r}));const y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let F=`data:${r};base64,`;for(let S=0,x=t.length;S<x;S+=3){const I=255&t[S],$=255&t[S+1],K=255&t[S+2];F+=y[I>>2]+y[(3&I)<<4|$>>4]+y[S+1<x?(15&$)<<2|K>>6:64]+y[S+2<x?63&K:64]}return F},L=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),r=new Int32Array(256);for(let S=0;S<256;S++){let x=S;for(let I=0;I<8;I++)x=1&x?3988292384^x>>1&2147483647:x>>1&2147483647;r[S]=x}function b(S,x,I,$){let K=$;const j=x.length;I[K]=j>>24&255,I[K+1]=j>>16&255,I[K+2]=j>>8&255,I[K+3]=255&j,K+=4,I[K]=255&S.charCodeAt(0),I[K+1]=255&S.charCodeAt(1),I[K+2]=255&S.charCodeAt(2),I[K+3]=255&S.charCodeAt(3),K+=4,I.set(x,K),K+=x.length;const f=function(T,R,O){let B=-1;for(let P=R;P<O;P++){const z=255&(B^T[P]);B=B>>>8^r[z]}return-1^B}(I,$+4,K);I[K]=f>>24&255,I[K+1]=f>>16&255,I[K+2]=f>>8&255,I[K+3]=255&f}function y(S){let x=S.length;const I=65535,$=Math.ceil(x/I),K=new Uint8Array(2+x+5*$+4);let j=0;K[j++]=120,K[j++]=156;let f=0;for(;x>I;)K[j++]=0,K[j++]=255,K[j++]=255,K[j++]=0,K[j++]=0,K.set(S.subarray(f,f+I),j),j+=I,f+=I,x-=I;K[j++]=1,K[j++]=255&x,K[j++]=x>>8&255,K[j++]=255&~x,K[j++]=(65535&~x)>>8&255,K.set(S.subarray(f),j),j+=S.length-f;const l=function(R,O,B){let P=1,z=0;for(let G=O;G<B;++G)P=(P+(255&R[G]))%65521,z=(z+P)%65521;return z<<16|P}(S,0,S.length);return K[j++]=l>>24&255,K[j++]=l>>16&255,K[j++]=l>>8&255,K[j++]=255&l,K}function F(S,x,I,$){const K=S.width,j=S.height;let f,l,T;const R=S.data;switch(x){case v.ImageKind.GRAYSCALE_1BPP:l=0,f=1,T=K+7>>3;break;case v.ImageKind.RGB_24BPP:l=2,f=8,T=3*K;break;case v.ImageKind.RGBA_32BPP:l=6,f=8,T=4*K;break;default:throw new Error("invalid format")}const O=new Uint8Array((1+T)*j);let B=0,P=0;for(let at=0;at<j;++at)O[B++]=0,O.set(R.subarray(P,P+T),B),P+=T,B+=T;if(x===v.ImageKind.GRAYSCALE_1BPP&&$){B=0;for(let at=0;at<j;at++){B++;for(let X=0;X<T;X++)O[B++]^=255}}const z=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,255&K,j>>24&255,j>>16&255,j>>8&255,255&j,f,l,0,0,0]),G=function(X){if(!k.isNodeJS)return y(X);try{let dt;dt=parseInt(process.versions.node)>=8?X:Buffer.from(X);const pt=require$$2.deflateSync(dt,{level:9});return pt instanceof Uint8Array?pt:new Uint8Array(pt)}catch(dt){(0,v.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+dt)}return y(X)}(O),U=t.length+36+z.length+G.length,J=new Uint8Array(U);let Q=0;return J.set(t,Q),Q+=t.length,b("IHDR",z,J,Q),Q+=12+z.length,b("IDATA",G,J,Q),Q+=12+G.length,b("IEND",new Uint8Array(0),J,Q),C(J,"image/png",I)}return function(x,I,$){return F(x,x.kind===void 0?v.ImageKind.GRAYSCALE_1BPP:x.kind,I,$)}}();class m{constructor(){this.fontSizeScale=1,this.fontWeight=N.fontWeight,this.fontSize=0,this.textMatrix=v.IDENTITY_MATRIX,this.fontMatrix=v.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=v.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=N.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(r,b){this.x=r,this.y=b}}let i=0,e=0,a=0;p.SVGGraphics=q=class{constructor(t,r,b=!1){(0,_.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new _.DOMSVGFactory,this.current=new m,this.transformMatrix=v.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=r,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!b,this._operatorIdMapping=[];for(const y in v.OPS)this._operatorIdMapping[v.OPS[y]]=y}getObject(t,r=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):r}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const r=t.fnArray,b=t.argsArray;for(let y=0,F=r.length;y<F;y++)if(r[y]===v.OPS.dependency)for(const S of b[y]){const x=S.startsWith("g_")?this.commonObjs:this.objs,I=new Promise($=>{x.get(S,$)});this.current.dependencies.push(I)}return Promise.all(this.current.dependencies)}transform(t,r,b,y,F,S){const x=[t,r,b,y,F,S];this.transformMatrix=v.Util.transform(this.transformMatrix,x),this.tgrp=null}getSVG(t,r){this.viewport=r;const b=this._initialize(r);return this.loadDependencies(t).then(()=>(this.transformMatrix=v.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),b))}convertOpList(t){const r=this._operatorIdMapping,b=t.argsArray,y=t.fnArray,F=[];for(let S=0,x=y.length;S<x;S++){const I=y[S];F.push({fnId:I,fn:r[I],args:b[S]})}return o(F)}executeOpTree(t){for(const r of t){const b=r.fn,y=r.fnId,F=r.args;switch(0|y){case v.OPS.beginText:this.beginText();break;case v.OPS.dependency:break;case v.OPS.setLeading:this.setLeading(F);break;case v.OPS.setLeadingMoveText:this.setLeadingMoveText(F[0],F[1]);break;case v.OPS.setFont:this.setFont(F);break;case v.OPS.showText:case v.OPS.showSpacedText:this.showText(F[0]);break;case v.OPS.endText:this.endText();break;case v.OPS.moveText:this.moveText(F[0],F[1]);break;case v.OPS.setCharSpacing:this.setCharSpacing(F[0]);break;case v.OPS.setWordSpacing:this.setWordSpacing(F[0]);break;case v.OPS.setHScale:this.setHScale(F[0]);break;case v.OPS.setTextMatrix:this.setTextMatrix(F[0],F[1],F[2],F[3],F[4],F[5]);break;case v.OPS.setTextRise:this.setTextRise(F[0]);break;case v.OPS.setTextRenderingMode:this.setTextRenderingMode(F[0]);break;case v.OPS.setLineWidth:this.setLineWidth(F[0]);break;case v.OPS.setLineJoin:this.setLineJoin(F[0]);break;case v.OPS.setLineCap:this.setLineCap(F[0]);break;case v.OPS.setMiterLimit:this.setMiterLimit(F[0]);break;case v.OPS.setFillRGBColor:this.setFillRGBColor(F[0],F[1],F[2]);break;case v.OPS.setStrokeRGBColor:this.setStrokeRGBColor(F[0],F[1],F[2]);break;case v.OPS.setStrokeColorN:this.setStrokeColorN(F);break;case v.OPS.setFillColorN:this.setFillColorN(F);break;case v.OPS.shadingFill:this.shadingFill(F[0]);break;case v.OPS.setDash:this.setDash(F[0],F[1]);break;case v.OPS.setRenderingIntent:this.setRenderingIntent(F[0]);break;case v.OPS.setFlatness:this.setFlatness(F[0]);break;case v.OPS.setGState:this.setGState(F[0]);break;case v.OPS.fill:this.fill();break;case v.OPS.eoFill:this.eoFill();break;case v.OPS.stroke:this.stroke();break;case v.OPS.fillStroke:this.fillStroke();break;case v.OPS.eoFillStroke:this.eoFillStroke();break;case v.OPS.clip:this.clip("nonzero");break;case v.OPS.eoClip:this.clip("evenodd");break;case v.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case v.OPS.paintImageXObject:this.paintImageXObject(F[0]);break;case v.OPS.paintInlineImageXObject:this.paintInlineImageXObject(F[0]);break;case v.OPS.paintImageMaskXObject:this.paintImageMaskXObject(F[0]);break;case v.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(F[0],F[1]);break;case v.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case v.OPS.closePath:this.closePath();break;case v.OPS.closeStroke:this.closeStroke();break;case v.OPS.closeFillStroke:this.closeFillStroke();break;case v.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case v.OPS.nextLine:this.nextLine();break;case v.OPS.transform:this.transform(F[0],F[1],F[2],F[3],F[4],F[5]);break;case v.OPS.constructPath:this.constructPath(F[0],F[1]);break;case v.OPS.endPath:this.endPath();break;case 92:this.group(r.items);break;default:(0,v.warn)(`Unimplemented operator ${b}`)}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,r,b,y,F,S){const x=this.current;x.textMatrix=x.lineMatrix=[t,r,b,y,F,S],x.textMatrixScale=Math.hypot(t,r),x.x=x.lineX=0,x.y=x.lineY=0,x.xcoords=[],x.ycoords=[],x.tspan=this.svgFactory.createElement("svg:tspan"),x.tspan.setAttributeNS(null,"font-family",x.fontFamily),x.tspan.setAttributeNS(null,"font-size",`${s(x.fontSize)}px`),x.tspan.setAttributeNS(null,"y",s(-x.y)),x.txtElement=this.svgFactory.createElement("svg:text"),x.txtElement.append(x.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=v.IDENTITY_MATRIX,t.lineMatrix=v.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,r){const b=this.current;b.x=b.lineX+=t,b.y=b.lineY+=r,b.xcoords=[],b.ycoords=[],b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${s(b.fontSize)}px`),b.tspan.setAttributeNS(null,"y",s(-b.y))}showText(t){const r=this.current,b=r.font,y=r.fontSize;if(y===0)return;const F=r.fontSizeScale,S=r.charSpacing,x=r.wordSpacing,I=r.fontDirection,$=r.textHScale*I,K=b.vertical,j=K?1:-1,f=b.defaultVMetrics,l=y*r.fontMatrix[0];let T=0;for(const B of t){if(B===null){T+=I*x;continue}if(typeof B=="number"){T+=j*B*y/1e3;continue}const P=(B.isSpace?x:0)+S,z=B.fontChar;let G,U,J,Q=B.width;if(K){let at;const X=B.vmetric||f;at=B.vmetric?X[1]:.5*Q,at=-at*l;const dt=X[2]*l;Q=X?-X[0]:Q,G=at/F,U=(T+dt)/F}else G=T/F,U=0;(B.isInFont||b.missingFile)&&(r.xcoords.push(r.x+G),K&&r.ycoords.push(-r.y+U),r.tspan.textContent+=z),J=K?Q*l-P*I:Q*l+P*I,T+=J}r.tspan.setAttributeNS(null,"x",r.xcoords.map(s).join(" ")),K?r.tspan.setAttributeNS(null,"y",r.ycoords.map(s).join(" ")):r.tspan.setAttributeNS(null,"y",s(-r.y)),K?r.y-=T:r.x+=T*$,r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${s(r.fontSize)}px`),r.fontStyle!==N.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==N.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);const R=r.textRenderingMode&v.TextRenderingMode.FILL_STROKE_MASK;if(R===v.TextRenderingMode.FILL||R===v.TextRenderingMode.FILL_STROKE?(r.fillColor!==N.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===v.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),R===v.TextRenderingMode.STROKE||R===v.TextRenderingMode.FILL_STROKE){const B=1/(r.textMatrixScale||1);this._setStrokeAttributes(r.tspan,B)}let O=r.textMatrix;r.textRise!==0&&(O=O.slice(),O[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",`${n(O)} scale(${s($)}, -1)`),r.txtElement.setAttributeNS(A,"xml:space","preserve"),r.txtElement.append(r.tspan),r.txtgrp.append(r.txtElement),this._ensureTransformGroup().append(r.txtElement)}setLeadingMoveText(t,r){this.setLeading(-r),this.moveText(t,r)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const r=C(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${r}); }
`}setFont(t){const r=this.current,b=this.commonObjs.get(t[0]);let y=t[1];r.font=b,this.embedFonts&&!b.missingFile&&!this.embeddedFonts[b.loadedName]&&(this.addFontStyle(b),this.embeddedFonts[b.loadedName]=b),r.fontMatrix=b.fontMatrix||v.FONT_IDENTITY_MATRIX;let F="normal";b.black?F="900":b.bold&&(F="bold");const S=b.italic?"italic":"normal";y<0?(y=-y,r.fontDirection=-1):r.fontDirection=1,r.fontSize=y,r.fontFamily=b.loadedName,r.fontWeight=F,r.fontStyle=S,r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"y",s(-r.y)),r.xcoords=[],r.ycoords=[]}endText(){var r;const t=this.current;t.textRenderingMode&v.TextRenderingMode.ADD_TO_PATH_FLAG&&((r=t.txtElement)==null?void 0:r.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=u[t]}setLineJoin(t){this.current.lineJoin=d[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,r,b){this.current.strokeColor=v.Util.makeHexColor(t,r,b)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,r,b){this.current.fillColor=v.Util.makeHexColor(t,r,b),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const r=this.viewport.width,b=this.viewport.height,y=v.Util.inverseTransform(this.transformMatrix),F=v.Util.applyTransform([0,0],y),S=v.Util.applyTransform([0,b],y),x=v.Util.applyTransform([r,0],y),I=v.Util.applyTransform([r,b],y),$=Math.min(F[0],S[0],x[0],I[0]),K=Math.min(F[1],S[1],x[1],I[1]),j=Math.max(F[0],S[0],x[0],I[0]),f=Math.max(F[1],S[1],x[1],I[1]),l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x",$),l.setAttributeNS(null,"y",K),l.setAttributeNS(null,"width",j-$),l.setAttributeNS(null,"height",f-K),l.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&l.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(l)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const r=t[1],b=t[2],y=t[3]||v.IDENTITY_MATRIX,[F,S,x,I]=t[4],$=t[5],K=t[6],j=t[7],f="shading"+a++,[l,T,R,O]=v.Util.normalizeRect([...v.Util.applyTransform([F,S],y),...v.Util.applyTransform([x,I],y)]),[B,P]=v.Util.singularValueDecompose2dScale(y),z=$*B,G=K*P,U=this.svgFactory.createElement("svg:pattern");U.setAttributeNS(null,"id",f),U.setAttributeNS(null,"patternUnits","userSpaceOnUse"),U.setAttributeNS(null,"width",z),U.setAttributeNS(null,"height",G),U.setAttributeNS(null,"x",`${l}`),U.setAttributeNS(null,"y",`${T}`);const J=this.svg,Q=this.transformMatrix,at=this.current.fillColor,X=this.current.strokeColor,dt=this.svgFactory.create(R-l,O-T);if(this.svg=dt,this.transformMatrix=y,j===2){const pt=v.Util.makeHexColor(...r);this.current.fillColor=pt,this.current.strokeColor=pt}return this.executeOpTree(this.convertOpList(b)),this.svg=J,this.transformMatrix=Q,this.current.fillColor=at,this.current.strokeColor=X,U.append(dt.childNodes[0]),this.defs.append(U),`url(#${f})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const r="shading"+a++,b=t[3];let y;switch(t[1]){case"axial":const F=t[4],S=t[5];y=this.svgFactory.createElement("svg:linearGradient"),y.setAttributeNS(null,"id",r),y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),y.setAttributeNS(null,"x1",F[0]),y.setAttributeNS(null,"y1",F[1]),y.setAttributeNS(null,"x2",S[0]),y.setAttributeNS(null,"y2",S[1]);break;case"radial":const x=t[4],I=t[5],$=t[6],K=t[7];y=this.svgFactory.createElement("svg:radialGradient"),y.setAttributeNS(null,"id",r),y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),y.setAttributeNS(null,"cx",I[0]),y.setAttributeNS(null,"cy",I[1]),y.setAttributeNS(null,"r",K),y.setAttributeNS(null,"fx",x[0]),y.setAttributeNS(null,"fy",x[1]),y.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const F of b){const S=this.svgFactory.createElement("svg:stop");S.setAttributeNS(null,"offset",F[0]),S.setAttributeNS(null,"stop-color",F[1]),y.append(S)}return this.defs.append(y),`url(#${r})`;case"Mesh":return(0,v.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,r){this.current.dashArray=t,this.current.dashPhase=r}constructPath(t,r){const b=this.current;let y=b.x,F=b.y,S=[],x=0;for(const I of t)switch(0|I){case v.OPS.rectangle:y=r[x++],F=r[x++];const $=y+r[x++],K=F+r[x++];S.push("M",s(y),s(F),"L",s($),s(F),"L",s($),s(K),"L",s(y),s(K),"Z");break;case v.OPS.moveTo:y=r[x++],F=r[x++],S.push("M",s(y),s(F));break;case v.OPS.lineTo:y=r[x++],F=r[x++],S.push("L",s(y),s(F));break;case v.OPS.curveTo:y=r[x+4],F=r[x+5],S.push("C",s(r[x]),s(r[x+1]),s(r[x+2]),s(r[x+3]),s(y),s(F)),x+=6;break;case v.OPS.curveTo2:S.push("C",s(y),s(F),s(r[x]),s(r[x+1]),s(r[x+2]),s(r[x+3])),y=r[x+2],F=r[x+3],x+=4;break;case v.OPS.curveTo3:y=r[x+2],F=r[x+3],S.push("C",s(r[x]),s(r[x+1]),s(y),s(F),s(y),s(F)),x+=4;break;case v.OPS.closePath:S.push("Z")}S=S.join(" "),b.path&&t.length>0&&t[0]!==v.OPS.rectangle&&t[0]!==v.OPS.moveTo?S=b.path.getAttributeNS(null,"d")+S:(b.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(b.path)),b.path.setAttributeNS(null,"d",S),b.path.setAttributeNS(null,"fill","none"),b.element=b.path,b.setCurrentPoint(y,F)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const r="clippath"+i++,b=this.svgFactory.createElement("svg:clipPath");b.setAttributeNS(null,"id",r),b.setAttributeNS(null,"transform",n(this.transformMatrix));const y=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?y.setAttributeNS(null,"clip-rule","evenodd"):y.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,b.append(y),this.defs.append(b),t.activeClipUrl){t.clipGroup=null;for(const F of this.extraStack)F.clipGroup=null;b.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${r})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const r=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",r)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[r,b]of t)switch(r){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b);break;case"CA":this.setStrokeAlpha(b);break;case"ca":this.setFillAlpha(b);break;default:(0,v.warn)(`Unimplemented graphic state operator ${r}`)}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,r=1){const b=this.current;let y=b.dashArray;r!==1&&y.length>0&&(y=y.map(function(F){return r*F})),t.setAttributeNS(null,"stroke",b.strokeColor),t.setAttributeNS(null,"stroke-opacity",b.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",s(b.miterLimit)),t.setAttributeNS(null,"stroke-linecap",b.lineCap),t.setAttributeNS(null,"stroke-linejoin",b.lineJoin),t.setAttributeNS(null,"stroke-width",s(r*b.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",y.map(s).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",s(r*b.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const r=this.getObject(t);r?this.paintInlineImageXObject(r):(0,v.warn)(`Dependent image with object ID ${t} is not ready yet`)}paintInlineImageXObject(t,r){const b=t.width,y=t.height,F=L(t,this.forceDataSchema,!!r),S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x","0"),S.setAttributeNS(null,"y","0"),S.setAttributeNS(null,"width",s(b)),S.setAttributeNS(null,"height",s(y)),this.current.element=S,this.clip("nonzero");const x=this.svgFactory.createElement("svg:image");x.setAttributeNS(h,"xlink:href",F),x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y",s(-y)),x.setAttributeNS(null,"width",s(b)+"px"),x.setAttributeNS(null,"height",s(y)+"px"),x.setAttributeNS(null,"transform",`scale(${s(1/b)} ${s(-1/y)})`),r?r.append(x):this._ensureTransformGroup().append(x)}paintImageMaskXObject(t){const r=this.getObject(t.data,t);if(r.bitmap){(0,v.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const b=this.current,y=r.width,F=r.height,S=b.fillColor;b.maskId="mask"+e++;const x=this.svgFactory.createElement("svg:mask");x.setAttributeNS(null,"id",b.maskId);const I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",s(y)),I.setAttributeNS(null,"height",s(F)),I.setAttributeNS(null,"fill",S),I.setAttributeNS(null,"mask",`url(#${b.maskId})`),this.defs.append(x),this._ensureTransformGroup().append(I),this.paintInlineImageXObject(r,x)}paintFormXObjectBegin(t,r){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),r){const b=r[2]-r[0],y=r[3]-r[1],F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x",r[0]),F.setAttributeNS(null,"y",r[1]),F.setAttributeNS(null,"width",s(b)),F.setAttributeNS(null,"height",s(y)),this.current.element=F,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const r=this.svgFactory.create(t.width,t.height),b=this.svgFactory.createElement("svg:defs");r.append(b),this.defs=b;const y=this.svgFactory.createElement("svg:g");return y.setAttributeNS(null,"transform",n(t.transform)),r.append(y),this.svg=y,r}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",n(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFNodeStream=void 0;var _=H(1),v=H(32);const k=require$$2,q=require$$2,N=require$$2,A=require$$2,h=/^file:\/\/\/[a-zA-Z]:\//;p.PDFNodeStream=class{constructor(i){this.source=i,this.url=function(a){const t=A.parse(a);return t.protocol==="file:"||t.host?t:/^[a-z]:[/\\]/i.test(a)?A.parse(`file:///${a}`):(t.host||(t.protocol="file:"),t)}(i.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&i.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var i,e;return(e=(i=this._fullRequestReader)==null?void 0:i._loaded)!=null?e:0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new o(this):new L(this),this._fullRequestReader}getRangeReader(i,e){if(e<=this._progressiveDataLength)return null;const a=this.isFsUrl?new s(this,i,e):new m(this,i,e);return this._rangeRequestReaders.push(a),a}cancelAllRequests(i){var e;(e=this._fullRequestReader)==null||e.cancel(i);for(const a of this._rangeRequestReaders.slice(0))a.cancel(i)}};class u{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=i.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,_.createPromiseCapability)(),this._headersCapability=(0,_.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,_.createPromiseCapability)(),this.read()):(this._loaded+=i.length,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){this._readableStream?this._readableStream.destroy(i):this._error(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class d{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,_.createPromiseCapability)();const e=i.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,_.createPromiseCapability)(),this.read()):(this._loaded+=i.length,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){this._readableStream?this._readableStream.destroy(i):this._error(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function C(n,i){return{protocol:n.protocol,auth:n.auth,host:n.hostname,port:n.port,path:n.path,method:"GET",headers:i}}class L extends u{constructor(i){super(i);const e=a=>{if(a.statusCode===404){const y=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=y,this._headersCapability.reject(y);return}this._headersCapability.resolve(),this._setReadableStream(a);const t=y=>this._readableStream.headers[y.toLowerCase()],{allowRangeRequests:r,suggestedLength:b}=(0,v.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:i.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=b||this._contentLength,this._filename=(0,v.extractFilenameFromHeader)(t)};this._request=null,this._url.protocol==="http:"?this._request=q.request(C(this._url,i.httpHeaders),e):this._request=N.request(C(this._url,i.httpHeaders),e),this._request.on("error",a=>{this._storedError=a,this._headersCapability.reject(a)}),this._request.end()}}class m extends d{constructor(i,e,a){super(i),this._httpHeaders={};for(const r in i.httpHeaders){const b=i.httpHeaders[r];b!==void 0&&(this._httpHeaders[r]=b)}this._httpHeaders.Range=`bytes=${e}-${a-1}`;const t=r=>{if(r.statusCode!==404)this._setReadableStream(r);else{const b=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b}};this._request=null,this._url.protocol==="http:"?this._request=q.request(C(this._url,this._httpHeaders),t):this._request=N.request(C(this._url,this._httpHeaders),t),this._request.on("error",r=>{this._storedError=r}),this._request.end()}}class o extends u{constructor(i){super(i);let e=decodeURIComponent(this._url.path);h.test(this._url.href)&&(e=e.replace(/^\//,"")),k.lstat(e,(a,t)=>{a?(a.code==="ENOENT"&&(a=new _.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=a,this._headersCapability.reject(a)):(this._contentLength=t.size,this._setReadableStream(k.createReadStream(e)),this._headersCapability.resolve())})}}class s extends d{constructor(i,e,a){super(i);let t=decodeURIComponent(this._url.path);h.test(this._url.href)&&(t=t.replace(/^\//,"")),this._setReadableStream(k.createReadStream(t,{start:e,end:a-1}))}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.createResponseStatusError=function(N,A){return N===404||N===0&&A.startsWith("file:")?new _.MissingPDFException('Missing PDF "'+A+'".'):new _.UnexpectedResponseException(`Unexpected server response (${N}) while retrieving PDF "${A}".`,N)},p.extractFilenameFromHeader=function(N){const A=N("Content-Disposition");if(A){let h=(0,v.getFilenameFromContentDispositionHeader)(A);if(h.includes("%"))try{h=decodeURIComponent(h)}catch{}if((0,k.isPdfFile)(h))return h}return null},p.validateRangeRequestCapabilities=function({getResponseHeader:N,isHttp:A,rangeChunkSize:h,disableRange:u}){const d={allowRangeRequests:!1,suggestedLength:void 0},C=parseInt(N("Content-Length"),10);return!Number.isInteger(C)||(d.suggestedLength=C,C<=2*h)||u||!A||N("Accept-Ranges")!=="bytes"||(N("Content-Encoding")||"identity")!=="identity"||(d.allowRangeRequests=!0),d},p.validateResponseStatus=function(N){return N===200||N===206};var _=H(1),v=H(33),k=H(6)},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.getFilenameFromContentDispositionHeader=function(k){let q=!0,N=A("filename\\*","i").exec(k);if(N){N=N[1];let m=d(N);return m=unescape(m),m=C(m),m=L(m),u(m)}if(N=function(o){const s=[];let n;const i=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(n=i.exec(o))!==null;){let[,a,t,r]=n;if(a=parseInt(a,10),a in s){if(a===0)break}else s[a]=[t,r]}const e=[];for(let a=0;a<s.length&&a in s;++a){let[t,r]=s[a];r=d(r),t&&(r=unescape(r),a===0&&(r=C(r))),e.push(r)}return e.join("")}(k),N)return u(L(N));if(N=A("filename","i").exec(k),N){N=N[1];let m=d(N);return m=L(m),u(m)}function A(m,o){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',o)}function h(m,o){if(m){if(!/^[\x00-\xFF]+$/.test(o))return o;try{const s=new TextDecoder(m,{fatal:!0}),n=(0,_.stringToBytes)(o);o=s.decode(n),q=!1}catch{}}return o}function u(m){return q&&/[\x80-\xff]/.test(m)&&(m=h("utf-8",m),q&&(m=h("iso-8859-1",m))),m}function d(m){if(m.startsWith('"')){const o=m.slice(1).split('\\"');for(let s=0;s<o.length;++s){const n=o[s].indexOf('"');n!==-1&&(o[s]=o[s].slice(0,n),o.length=s+1),o[s]=o[s].replace(/\\(.)/g,"$1")}m=o.join('"')}return m}function C(m){const o=m.indexOf("'");return o===-1?m:h(m.slice(0,o),m.slice(o+1).replace(/^[^']*'/,""))}function L(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,s,n,i){if(n==="q"||n==="Q")return h(s,i=(i=i.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(e,a){return String.fromCharCode(parseInt(a,16))}));try{i=atob(i)}catch{}return h(s,i)})}return""};var _=H(1)},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFNetworkStream=void 0;var _=H(1),v=H(32);class k{constructor(h,u={}){this.url=h,this.isHttp=/^https?:/i.test(h),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(h,u,d){const C={begin:h,end:u};for(const L in d)C[L]=d[L];return this.request(C)}requestFull(h){return this.request(h)}request(h){const u=this.getXhr(),d=this.currXhrId++,C=this.pendingRequests[d]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const L in this.httpHeaders){const m=this.httpHeaders[L];m!==void 0&&u.setRequestHeader(L,m)}return this.isHttp&&"begin"in h&&"end"in h?(u.setRequestHeader("Range",`bytes=${h.begin}-${h.end-1}`),C.expectedStatus=206):C.expectedStatus=200,u.responseType="arraybuffer",h.onError&&(u.onerror=function(L){h.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,d),u.onprogress=this.onProgress.bind(this,d),C.onHeadersReceived=h.onHeadersReceived,C.onDone=h.onDone,C.onError=h.onError,C.onProgress=h.onProgress,u.send(null),d}onProgress(h,u){var C;const d=this.pendingRequests[h];d&&((C=d.onProgress)==null||C.call(d,u))}onStateChange(h,u){var o,s,n;const d=this.pendingRequests[h];if(!d)return;const C=d.xhr;if(C.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),C.readyState!==4||!(h in this.pendingRequests))return;if(delete this.pendingRequests[h],C.status===0&&this.isHttp){(o=d.onError)==null||o.call(d,C.status);return}const L=C.status||200;if(!(L===200&&d.expectedStatus===206)&&L!==d.expectedStatus){(s=d.onError)==null||s.call(d,C.status);return}const m=function(e){const a=e.response;return typeof a!="string"?a:(0,_.stringToBytes)(a).buffer}(C);if(L===206){const i=C.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(i);d.onDone({begin:parseInt(e[1],10),chunk:m})}else m?d.onDone({begin:0,chunk:m}):(n=d.onError)==null||n.call(d,C.status)}getRequestXhr(h){return this.pendingRequests[h].xhr}isPendingRequest(h){return h in this.pendingRequests}abortRequest(h){const u=this.pendingRequests[h].xhr;delete this.pendingRequests[h],u.abort()}}p.PDFNetworkStream=class{constructor(h){this._source=h,this._manager=new k(h.url,{httpHeaders:h.httpHeaders,withCredentials:h.withCredentials}),this._rangeChunkSize=h.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(h){const u=this._rangeRequestReaders.indexOf(h);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new q(this._manager,this._source),this._fullRequestReader}getRangeReader(h,u){const d=new N(this._manager,h,u);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(h){var u;(u=this._fullRequestReader)==null||u.cancel(h);for(const d of this._rangeRequestReaders.slice(0))d.cancel(h)}};class q{constructor(h,u){this._manager=h;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=h.requestFull(d),this._headersReceivedCapability=(0,_.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const h=this._fullRequestId,u=this._manager.getRequestXhr(h),d=m=>u.getResponseHeader(m),{allowRangeRequests:C,suggestedLength:L}=(0,v.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});C&&(this._isRangeSupported=!0),this._contentLength=L||this._contentLength,this._filename=(0,v.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(h),this._headersReceivedCapability.resolve()}_onDone(h){if(h&&(this._requests.length>0?this._requests.shift().resolve({value:h.chunk,done:!1}):this._cachedChunks.push(h.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(h){this._storedError=(0,v.createResponseStatusError)(h,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(h){var u;(u=this.onProgress)==null||u.call(this,{loaded:h.loaded,total:h.lengthComputable?h.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=(0,_.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0,this._headersReceivedCapability.reject(h);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(h,u,d){this._manager=h;const C={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._requestId=h.requestRange(u,d,C),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var h;(h=this.onClosed)==null||h.call(this,this)}_onDone(h){const u=h.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(h){this._storedError=(0,v.createResponseStatusError)(h,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(h){var u;this.isStreamingSupported||((u=this.onProgress)==null||u.call(this,{loaded:h.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const h=(0,_.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Y,p,H)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFFetchStream=void 0;var _=H(1),v=H(32);function k(h,u,d){return{method:"GET",headers:h,signal:d.signal,mode:"cors",credentials:u?"include":"same-origin",redirect:"follow"}}function q(h){const u=new Headers;for(const d in h){const C=h[d];C!==void 0&&u.append(d,C)}return u}p.PDFFetchStream=class{constructor(u){this.source=u,this.isHttp=/^https?:/i.test(u.url),this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u,d;return(d=(u=this._fullRequestReader)==null?void 0:u._loaded)!=null?d:0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new N(this),this._fullRequestReader}getRangeReader(u,d){if(d<=this._progressiveDataLength)return null;const C=new A(this,u,d);return this._rangeRequestReaders.push(C),C}cancelAllRequests(u){var d;(d=this._fullRequestReader)==null||d.cancel(u);for(const C of this._rangeRequestReaders.slice(0))C.cancel(u)}};class N{constructor(u){this._stream=u,this._reader=null,this._loaded=0,this._filename=null;const d=u.source;this._withCredentials=d.withCredentials||!1,this._contentLength=d.length,this._headersCapability=(0,_.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._rangeChunkSize=d.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!d.disableStream,this._isRangeSupported=!d.disableRange,this._headers=q(this._stream.httpHeaders);const C=d.url;fetch(C,k(this._headers,this._withCredentials,this._abortController)).then(L=>{if(!(0,v.validateResponseStatus)(L.status))throw(0,v.createResponseStatusError)(L.status,C);this._reader=L.body.getReader(),this._headersCapability.resolve();const m=n=>L.headers.get(n),{allowRangeRequests:o,suggestedLength:s}=(0,v.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=s||this._contentLength,this._filename=(0,v.extractFilenameFromHeader)(m),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new _.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;await this._headersCapability.promise;const{value:u,done:d}=await this._reader.read();return d?{value:u,done:d}:(this._loaded+=u.byteLength,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){var d;(d=this._reader)==null||d.cancel(u),this._abortController.abort()}}class A{constructor(u,d,C){this._stream=u,this._reader=null,this._loaded=0;const L=u.source;this._withCredentials=L.withCredentials||!1,this._readCapability=(0,_.createPromiseCapability)(),this._isStreamingSupported=!L.disableStream,this._abortController=new AbortController,this._headers=q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${d}-${C-1}`);const m=L.url;fetch(m,k(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,v.validateResponseStatus)(o.status))throw(0,v.createResponseStatusError)(o.status,m);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;await this._readCapability.promise;const{value:u,done:d}=await this._reader.read();return d?{value:u,done:d}:(this._loaded+=u.byteLength,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){var d;(d=this._reader)==null||d.cancel(u),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Y){var p=__webpack_module_cache__[Y];if(p!==void 0)return p.exports;var H=__webpack_module_cache__[Y]={exports:{}};return __webpack_modules__[Y](H,H.exports,__w_pdfjs_require__),H.exports}var __webpack_exports__={};return(()=>{var Y=__webpack_exports__;Object.defineProperty(Y,"__esModule",{value:!0}),Object.defineProperty(Y,"AnnotationEditorLayer",{enumerable:!0,get:function(){return v.AnnotationEditorLayer}}),Object.defineProperty(Y,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return p.AnnotationEditorParamsType}}),Object.defineProperty(Y,"AnnotationEditorType",{enumerable:!0,get:function(){return p.AnnotationEditorType}}),Object.defineProperty(Y,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return k.AnnotationEditorUIManager}}),Object.defineProperty(Y,"AnnotationLayer",{enumerable:!0,get:function(){return q.AnnotationLayer}}),Object.defineProperty(Y,"AnnotationMode",{enumerable:!0,get:function(){return p.AnnotationMode}}),Object.defineProperty(Y,"CMapCompressionType",{enumerable:!0,get:function(){return p.CMapCompressionType}}),Object.defineProperty(Y,"GlobalWorkerOptions",{enumerable:!0,get:function(){return N.GlobalWorkerOptions}}),Object.defineProperty(Y,"InvalidPDFException",{enumerable:!0,get:function(){return p.InvalidPDFException}}),Object.defineProperty(Y,"MissingPDFException",{enumerable:!0,get:function(){return p.MissingPDFException}}),Object.defineProperty(Y,"OPS",{enumerable:!0,get:function(){return p.OPS}}),Object.defineProperty(Y,"PDFDataRangeTransport",{enumerable:!0,get:function(){return H.PDFDataRangeTransport}}),Object.defineProperty(Y,"PDFDateString",{enumerable:!0,get:function(){return _.PDFDateString}}),Object.defineProperty(Y,"PDFWorker",{enumerable:!0,get:function(){return H.PDFWorker}}),Object.defineProperty(Y,"PasswordResponses",{enumerable:!0,get:function(){return p.PasswordResponses}}),Object.defineProperty(Y,"PermissionFlag",{enumerable:!0,get:function(){return p.PermissionFlag}}),Object.defineProperty(Y,"PixelsPerInch",{enumerable:!0,get:function(){return _.PixelsPerInch}}),Object.defineProperty(Y,"RenderingCancelledException",{enumerable:!0,get:function(){return _.RenderingCancelledException}}),Object.defineProperty(Y,"SVGGraphics",{enumerable:!0,get:function(){return u.SVGGraphics}}),Object.defineProperty(Y,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return p.UNSUPPORTED_FEATURES}}),Object.defineProperty(Y,"UnexpectedResponseException",{enumerable:!0,get:function(){return p.UnexpectedResponseException}}),Object.defineProperty(Y,"Util",{enumerable:!0,get:function(){return p.Util}}),Object.defineProperty(Y,"VerbosityLevel",{enumerable:!0,get:function(){return p.VerbosityLevel}}),Object.defineProperty(Y,"XfaLayer",{enumerable:!0,get:function(){return d.XfaLayer}}),Object.defineProperty(Y,"build",{enumerable:!0,get:function(){return H.build}}),Object.defineProperty(Y,"createPromiseCapability",{enumerable:!0,get:function(){return p.createPromiseCapability}}),Object.defineProperty(Y,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return p.createValidAbsoluteUrl}}),Object.defineProperty(Y,"getDocument",{enumerable:!0,get:function(){return H.getDocument}}),Object.defineProperty(Y,"getFilenameFromUrl",{enumerable:!0,get:function(){return _.getFilenameFromUrl}}),Object.defineProperty(Y,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return _.getPdfFilenameFromUrl}}),Object.defineProperty(Y,"getXfaPageViewport",{enumerable:!0,get:function(){return _.getXfaPageViewport}}),Object.defineProperty(Y,"isPdfFile",{enumerable:!0,get:function(){return _.isPdfFile}}),Object.defineProperty(Y,"loadScript",{enumerable:!0,get:function(){return _.loadScript}}),Object.defineProperty(Y,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty(Y,"shadow",{enumerable:!0,get:function(){return p.shadow}}),Object.defineProperty(Y,"version",{enumerable:!0,get:function(){return H.version}});var p=__w_pdfjs_require__(1),H=__w_pdfjs_require__(2),_=__w_pdfjs_require__(6),v=__w_pdfjs_require__(21),k=__w_pdfjs_require__(5),q=__w_pdfjs_require__(26),N=__w_pdfjs_require__(14),A=__w_pdfjs_require__(12),h=__w_pdfjs_require__(29),u=__w_pdfjs_require__(30),d=__w_pdfjs_require__(28);if(A.isNodeJS){const{PDFNodeStream:C}=__w_pdfjs_require__(31);(0,H.setPDFNetworkStreamFactory)(L=>new C(L))}else{const{PDFNetworkStream:C}=__w_pdfjs_require__(34),{PDFFetchStream:L}=__w_pdfjs_require__(35);(0,H.setPDFNetworkStreamFactory)(m=>(0,_.isValidFetchUrl)(m.url)?new L(m):new C(m))}})(),__webpack_exports__})())})(pdf_min$1);const pdf_min=getDefaultExportFromCjs(pdf_min$1.exports),pdfjs=_mergeNamespaces({__proto__:null,default:pdf_min},[pdf_min$1.exports]);function WorkerWrapper(){return new Worker("/SIGNooo/assets/pdf.worker.32cb4b85.js")}const init=()=>{try{if(typeof window>"u"||!("Worker"in window))throw new Error("Web Workers not supported in this environment.");window.pdfjsWorker=WorkerWrapper,pdf_min$1.exports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdf_min$1.exports.version}/pdf.worker.js`}catch(Y){console.log(Y)}},Component={install:Y=>{init(),Y.config.globalProperties.$pdf=pdfjs}},_reset="",_base="",elMessage="",elMessageBox="",app=createApp(App);app.use(router).use(Component).mount("#app");export{_export_sfc as _,__vitePreload as a,logo as l,require$$2 as r};
